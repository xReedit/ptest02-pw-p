{"version":3,"file":"src_app_pages_encuesta_encuesta_module_ts.js","mappings":"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","sources":["./src/app/pages/encuesta/encuesta.module.ts","./src/app/pages/encuesta/encuesta.routing.ts","./src/app/pages/encuesta/encuesta/encuesta.component.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { EncuestaRoutingModule } from './encuesta.routing';\nimport { MaterialModule } from 'src/app/core/material/material.module';\nimport { ComponentesModule } from 'src/app/componentes/componentes.module';\nimport { EncuestaComponent } from './encuesta/encuesta.component';\n\n\n\n@NgModule({\n  declarations: [\n    EncuestaComponent\n  ],\n  imports: [\n    CommonModule,\n    EncuestaRoutingModule,\n    MaterialModule,\n    ComponentesModule\n  ]\n})\nexport class EncuestaModule { }\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { EncuestaComponent } from './encuesta/encuesta.component';\r\n\r\nconst routes: Routes = [{\r\n    path: '', component: EncuestaComponent,\r\n    data: { titulo: 'Inicio' },\r\n    children: [\r\n        {\r\n            path: '', redirectTo: 'inicio'\r\n        }\r\n    ]\r\n}];\r\n\r\n@NgModule({\r\n    imports: [RouterModule.forChild(routes)],\r\n    exports: [RouterModule]\r\n})\r\nexport class EncuestaRoutingModule { }\r\n","import { Component, OnInit, ViewChildren, QueryList, ElementRef } from '@angular/core';\r\nimport { InfoTockenService } from 'src/app/shared/services/info-token.service';\r\nimport { UsuarioTokenModel } from 'src/app/modelos/usuario.token.model';\r\nimport { CrudHttpService } from 'src/app/shared/services/crud-http.service';\r\nimport { NavigatorLinkService } from 'src/app/shared/services/navigator-link.service';\r\nimport { MipedidoService } from 'src/app/shared/services/mipedido.service';\r\n// import { throwMatDialogContentAlreadyAttachedError } from '@angular/material/dialog';\r\nimport { SocketService } from 'src/app/shared/services/socket.service';\r\nimport { ListenStatusService } from 'src/app/shared/services/listen-status.service';\r\nimport { EstablecimientoService } from 'src/app/shared/services/establecimiento.service';\r\nimport { DeliveryEstablecimiento } from 'src/app/modelos/delivery.establecimiento';\r\n\r\n@Component({\r\n  selector: 'app-encuesta',\r\n  templateUrl: './encuesta.component.html',\r\n  styleUrls: ['./encuesta.component.css']\r\n})\r\nexport class EncuestaComponent implements OnInit   {\r\n  nomSede = '';\r\n  ciudadSede = '';\r\n  infoToken: UsuarioTokenModel;\r\n  titulo_inicio: '';\r\n  titulo_fin: '';\r\n  listPreguntas: any;\r\n  listOption: any;\r\n  countFin = 4;\r\n\r\n  selectedTabEncuesta = 0;\r\n\r\n  private intervalConteo = null;\r\n  private isBtnPagoShow = false; // si el boton de pago ha sido visible entonces recarga la pagina de pago\r\n\r\n  private dataPost: any;\r\n  private ListRespuestas: any = [];\r\n  private xIdEncuesta = 0;\r\n  private countOption = 1; // inicio y fin\r\n\r\n  private infoSede: DeliveryEstablecimiento;\r\n\r\n  constructor(\r\n    private infoTokenService: InfoTockenService,\r\n    private crudService: CrudHttpService,\r\n    private navigatorService: NavigatorLinkService,\r\n    private socketService: SocketService,\r\n    private listenStatusService: ListenStatusService,\r\n    private establecimientoService: EstablecimientoService\r\n  ) { }\r\n\r\n  ngOnInit() {\r\n    this.infoToken = this.infoTokenService.getInfoUs();\r\n    // console.log(this.infoToken);\r\n    // this.nomSede = localStorage.getItem('sys::s').split('|');\r\n    this.infoSede = this.establecimientoService.get();\r\n    this.nomSede = this.infoSede.nombre;\r\n    this.ciudadSede = this.infoSede.ciudad;\r\n\r\n    this.dataPost = {\r\n      idsede: this.infoSede.idsede,\r\n      // idsede: this.infoToken.idsede,\r\n      // idcliente: this.infoTokenService.getInfoUs().idcliente\r\n    };\r\n\r\n    this.loadOpciones();\r\n\r\n    this.loadEncuesta();\r\n\r\n    // deshabilitar boton back navegator\r\n    this.navigatorService.disabledBack = true;\r\n    history.pushState(null, null, location.href);\r\n    window.onpopstate = function () {\r\n        history.go(1);\r\n    };\r\n\r\n    // escucha si bnPago show para reload\r\n    this.listenStatusService.isBtnPagoShow$.subscribe((res: boolean) => { this.isBtnPagoShow = res; });\r\n  }\r\n\r\n  private loadEncuesta(): void {\r\n\r\n    this.crudService.postFree(this.dataPost, 'encuesta', 'la-encuesta', false).subscribe( (res: any) => {\r\n      // console.log(res);\r\n      if ( res.success ) {\r\n        if ( res.data.length === 0 ) {\r\n          this.cerrarSession();\r\n          return;\r\n        }\r\n        const _data = res.data[0].preguntas;\r\n        this.xIdEncuesta = _data.idencuesta;\r\n        this.titulo_inicio = _data.inicio;\r\n        this.titulo_fin = _data.fin;\r\n        this.listPreguntas = _data.preguntas;\r\n\r\n        this.countOption += this.listPreguntas.length;\r\n      } else {\r\n        this.cerrarSession();\r\n      }\r\n    });\r\n  }\r\n\r\n  private loadOpciones(): void {\r\n    this.crudService.postFree(this.dataPost, 'encuesta', 'las-opciones', false).subscribe( (res: any) => {\r\n\r\n      if ( res.success ) {\r\n        this.listOption = res.data;\r\n      }\r\n\r\n\r\n\r\n    });\r\n  }\r\n\r\n  pasarTab(event: any = null, pregunta: any = null, txt_comentario: string = null) {\r\n\r\n\r\n    if ( !event ) { this.selectedTabEncuesta ++; return; } // inicio\r\n\r\n    const isComentario = pregunta.obligatorio === '1' ? true : false;\r\n\r\n    const rpt = {\r\n      idencuesta_pregunta: pregunta.idencuesta_pregunta,\r\n      idencuesta_respuesta: event.idencuesta_respuesta || 0,\r\n      iscomentario: isComentario,\r\n      comentario: txt_comentario || ''\r\n    };\r\n\r\n    this.ListRespuestas.push(rpt);\r\n\r\n\r\n\r\n    this.selectedTabEncuesta ++;\r\n\r\n    if ( isComentario ) {\r\n      this.guardarEncuesta();\r\n    }\r\n\r\n\r\n\r\n    if ( this.countOption === this.selectedTabEncuesta ) {\r\n\r\n      this.cuentaRegresiva();\r\n    }\r\n  }\r\n\r\n  private guardarEncuesta(): void {\r\n    const _dataSend = {item: this.ListRespuestas, i: this.xIdEncuesta };\r\n    this.crudService.postFree(_dataSend, 'encuesta', 'guardar', false).subscribe( (res: any) => {\r\n\r\n    });\r\n  }\r\n\r\n  private cuentaRegresiva() {\r\n    if ( this.countFin <= 0 ) {\r\n      this.intervalConteo = null;\r\n      this.cerrarSession();\r\n    } else {\r\n      this.conteoFinEncuesta();\r\n    }\r\n  }\r\n\r\n  private conteoFinEncuesta(): void {\r\n    this.intervalConteo =  setTimeout(() => {\r\n      this.countFin --;\r\n      this.cuentaRegresiva();\r\n    }, 1000);\r\n  }\r\n\r\n  private cerrarSession(): void {\r\n    this.navigatorService.cerrarSession(this.isBtnPagoShow);\r\n    // this.miPedidoService.cerrarSession();\r\n    this.infoTokenService.cerrarSession();\r\n\r\n    // para cargar nuevamente al ingresar\r\n    this.socketService.isSocketOpenReconect = true;\r\n    this.socketService.closeConnection();\r\n  }\r\n\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///","x_google_ignoreList":[]}