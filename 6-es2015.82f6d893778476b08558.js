(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"/sn2":function(e,t,i){"use strict";var s=i("iInd"),o=i("pLZG"),a=i("7o/Q");class n{constructor(e,t){this.bufferSize=e,this.startBufferEvery=t,this.subscriberClass=t&&e!==t?r:c}call(e,t){return t.subscribe(new this.subscriberClass(e,this.bufferSize,this.startBufferEvery))}}class c extends a.a{constructor(e,t){super(e),this.bufferSize=t,this.buffer=[]}_next(e){const t=this.buffer;t.push(e),t.length==this.bufferSize&&(this.destination.next(t),this.buffer=[])}_complete(){const e=this.buffer;e.length>0&&this.destination.next(e),super._complete()}}class r extends a.a{constructor(e,t,i){super(e),this.bufferSize=t,this.startBufferEvery=i,this.buffers=[],this.count=0}_next(e){const{bufferSize:t,startBufferEvery:i,buffers:s,count:o}=this;this.count++,o%i==0&&s.push([]);for(let a=s.length;a--;){const i=s[a];i.push(e),i.length===t&&(s.splice(a,1),this.destination.next(i))}}_complete(){const{buffers:e,destination:t}=this;for(;e.length>0;){let i=e.shift();i.length>0&&t.next(i)}super._complete()}}var d=i("7RJT"),l=i("zOUh"),m=i("eI2u"),h=i("8Y7J");i.d(t,"a",function(){return u});let u=(()=>{class e{constructor(e,t,i){this.router=e,this.infoTokenService=t,this.listenService=i,this.disabledBack=!1,this.resNavigatorSource=new d.BehaviorSubject([]),this.resNavigatorSourceObserve$=this.resNavigatorSource.asObservable(),this.pageActive="carta",this.resNavigator=[],this.historyNavigator=[],this.lastUrlHistory="",this.listenEventNavigator()}listenEventNavigator(){this.router.events.pipe(Object(o.a)(e=>e instanceof s.d),function(e,t=null){return function(e){return e.lift(new n(2,t))}}(0,1)).subscribe(e=>{if(null!=e&&"popstate"===e[1].navigationTrigger){if(this.disabledBack)return!1;const t=e[0].url.indexOf(";")?e[0].url.substr(1).split(";")[1].split("=")[1]:e[0].url;t.length>0&&(this.lastUrlHistory=t,this.managerGoBack(t,""))}})}setPageActive(e){this.pageActive=e,this.lastUrlHistory="carta"!==e?e:this.lastUrlHistory;const t=this.findPageActiveInHistory(e);this.addLink(t?t.url:e),this.resNavigator.pageActive=e,this.resNavigator.url=t?t.url:e,this.resNavigatorSource.next(this.resNavigator)}saveHistoryPageActive(e,t){this.historyNavigator[e]=[],this.historyNavigator[e].key=e,this.historyNavigator[e].url=t}findPageActiveInHistory(e){return Object.values(this.historyNavigator).filter(t=>t.key===e)[0]}addLink(e){this.router.navigate([".",{state:e}]),this.saveHistoryPageActive(this.pageActive,e)}cerrarSession(e=!1){this.infoTokenService.isDelivery()?this.router.navigate(["../zona-delivery"]):this.router.navigate(["../"]).then(()=>{e&&window.location.reload()})}managerGoBack(e,t){let i="";switch(console.log("managerGoBack",e),e){case"carta-i-secciones-items":i="carta",this.addLink("carta-i-secciones");break;case"carta-i-secciones":i="carta",this.addLink("carta-i-");break;case"carta-i-":i="carta-o-",this.addLink("carta-o-"),console.log("=========================== listo para salir"),this.listoParaSalir();break;case"mipedido-confirma":i="mipedido",this.addLink("mipedido");break;case"mipedido":i="carta",this.addLink("carta"),this.listoParaSalir();break;case"estado":case"carta":i="carta";break;case"lanzar-encuesta":i="lanzar-encuesta"}""!==i&&(this.pageActive=i,this.setPageActive(i))}_router(e){this.router.navigate([e])}disableGoBack(){this.disabledBack=!0,history.pushState(null,null,location.href),window.onpopstate=function(){history.go(1)}}listoParaSalir(){this.infoTokenService.isDelivery()&&this.listenService.setIsOutEstablecimientoDelivery(!0)}}return e.ngInjectableDef=h.Sb({factory:function(){return new e(h.Tb(s.l),h.Tb(l.a),h.Tb(m.a))},token:e,providedIn:"root"}),e})()},"6NNB":function(e,t,i){"use strict";i.d(t,"a",function(){return s});class s{constructor(){this.tipoconsumo=[]}}},Ie24:function(e,t,i){"use strict";i.d(t,"a",function(){return s});class s{constructor(){this.items=[]}}},JOr0:function(e,t,i){"use strict";i.d(t,"a",function(){return a});var s=i("qTE5"),o=i("8Y7J");let a=(()=>{class e{constructor(){this.keyStorage="sys::ed"}set(e){localStorage.setItem(this.keyStorage,btoa(JSON.stringify(e)))}get(){let e=new s.a;const t=localStorage.getItem(this.keyStorage);return t?JSON.parse(atob(t)):e}}return e.ngInjectableDef=o.Sb({factory:function(){return new e},token:e,providedIn:"root"}),e})()},OzqD:function(e,t,i){"use strict";i.d(t,"a",function(){return d});var s=i("A8zI"),o=i("eI2u"),a=i("+lji"),n=i("zOUh"),c=i("7RJT"),r=i("8Y7J");let d=(()=>{class e{constructor(e,t,i){this.listenStatusService=e,this.crudService=t,this.infoTokenService=i,this.estadoPedido=new s.a,this.keyStorage="sys::status",this.timeInterval=null,this.timeNow=new Date,this.hayPedidoPendiente=!1,this.timeRestanteAproxSource=new c.BehaviorSubject(0),this.timeRestanteAprox$=this.timeRestanteAproxSource.asObservable(),this.hayCuentaClienteSource=new c.BehaviorSubject(null),this.hayCuentaCliente$=this.hayCuentaClienteSource.asObservable(),this.deserializar(),this.dataPost={idsede:this.infoTokenService.getInfoUs().idsede,idcliente:this.infoTokenService.getInfoUs().idcliente}}deserializar(){let e=localStorage.getItem(this.keyStorage);this.estadoPedido=(e="{}"===e?null:e)?JSON.parse(e):new s.a}get(){this.deserializar(),this.getCuentaTotales()}getCuentaTotales(){let e=0;return this.crudService.postFree(this.dataPost,"pedido","lacuenta-cliente-totales",!1).subscribe(t=>{0!==t.data.length?(this.setImporte(e=t.data[0].importe||0),this.estadoPedido.hayPedidoCliente=!0,this.calcTimeAprox(),console.log("cuenta cliente totales",t),this.notifyChange()):this.estadoPedido.hayPedidoCliente=!1}),e}getCuenta(){this.crudService.postFree(this.dataPost,"pedido","lacuenta-cliente",!1).subscribe(e=>{if(0!==e.data.length)return this.estadoPedido.hayPedidoCliente=!0,this.calcTimeAprox(),console.log("cuenta cliente",e),this.hayCuentaClienteSource.next(e),this.notifyChange(),e;this.estadoPedido.hayPedidoCliente=!1})}getImporteCuenta(){return new Promise(e=>{this.crudService.postFree(this.dataPost,"pedido","lacuenta-cliente-totales",!1).subscribe(t=>{e(t.success?t.data[0].importe:0)})})}getObj(){return this.estadoPedido||this.deserializar(),this.estadoPedido}setEstado(e){this.deserializar(),this.estadoPedido.estado=e,this.notifyChange()}setImporte(e){this.deserializar(),this.estadoPedido.importe=e,this.notifyChange()}setHoraInitPedido(e){this.deserializar(),this.estadoPedido.horaInt=e,this.notifyChange()}setTimeAprox(e){this.deserializar(),this.estadoPedido.isTiempoAproxCumplido=e,this.notifyChange()}setHayPedidoPendiente(e){this.deserializar(),this.estadoPedido.hayPedidoClientePendiente=e,this.notifyChange()}setisPagada(e){this.deserializar(),this.estadoPedido.isPagada=e,this.notifyChange()}setisRegisterPago(e){this.deserializar(),this.estadoPedido.isRegisterOnePago=e,this.notifyChange()}calcTimeAprox(){this.crudService.postFree(this.dataPost,"pedido","calc-time-despacho",!1).subscribe(e=>{this.estadoPedido.estado=0,this.estadoPedido.numMinAprox=e.data[0].rpt,this.estadoPedido.isTiempoAproxCumplido=!1,this.notifyChange(),console.log("this.estadoPedido",this.estadoPedido),this.getTimeAprox()})}getTimeAprox(){return 0===this.estadoPedido.estado?this.timeInterval=setTimeout(()=>{let e=this.calTimeMin();e<=0?(this.estadoPedido.estado=1,this.notifyChange(),this.clearTimeout(),clearTimeout(this.timeInterval),e=0):this.getTimeAprox(),this.timeRestanteAproxSource.next(e)},2e3):this.clearTimeout(),0}calTimeMin(){let e=(new Date).getTime()-this.estadoPedido.horaInt;return e=Math.round(e%864e5%36e5/6e4),e=this.estadoPedido.numMinAprox-e,isNaN(e)?0:e}clearTimeout(){clearTimeout(this.timeInterval),this.timeInterval=null}notifyChange(){this.listenStatusService.setEstadoPedido(this.estadoPedido),localStorage.setItem(this.keyStorage,JSON.stringify(this.estadoPedido))}}return e.ngInjectableDef=r.Sb({factory:function(){return new e(r.Tb(o.a),r.Tb(a.a),r.Tb(n.a))},token:e,providedIn:"root"}),e})()},Te6q:function(e,t,i){"use strict";i.d(t,"a",function(){return s});class s{constructor(){this.precio_total=0,this.cantidad_seleccionada_x_tpc=0,this.cantidad_descontado=0,this.itemtiposconsumo=[],this.subitems_selected=[],this.subitems_view=[]}}},WF5t:function(e,t,i){"use strict";i.d(t,"a",function(){return n});var s=i("7RJT"),o=i("zOUh"),a=i("8Y7J");let n=(()=>{class e{constructor(e){this.infoToken=e,this.countdownTimerRef=null,this.init=0,this.valPorcentaje=0,this.isPlayTimer=!1,this.dateNow=new Date,this.countdownSource=new s.BehaviorSubject(0),this.countdown$=this.countdownSource.asObservable(),this.isTimeLimitSource=new s.BehaviorSubject(!1),this.isTimeLimitComplet$=this.isTimeLimitSource.asObservable(),this.isPorgressVisibleSource=new s.BehaviorSubject(!1),this.isPorgressVisible$=this.isPorgressVisibleSource.asObservable()}destroy(){this.clearTimeout()}playCountTimerLimit(){this.infoToken.isDelivery()||this.isPlayTimer||(this.isPlayTimer=!0,this.initCount())}resetCountTimerLimit(){this.infoToken.isDelivery()||(localStorage.getItem("sys::tcount")?(this.isPlayTimer=!0,this.initCount()):this.stopCountTimerLimit())}initCount(){this.infoToken.isDelivery()||(this.valPorcentaje=0,this.init=localStorage.getItem("sys::tcount")?parseInt(localStorage.getItem("sys::tcount"),0):0,this.isTimeLimitSource.next(!1),this.isPorgressVisibleSource.next(!0),this.progressCount())}progressCount(){let e=0;this.isPlayTimer&&(this.countdownTimerRef=setTimeout(()=>{this.init=this.setTimeDate(),this.valPorcentaje=Math.round(this.init/this.maxTime*100),localStorage.setItem("sys::tcount",this.init.toString()),this.init>this.maxTime?(this.init=this.maxTime,this.valPorcentaje=100,this.countdownSource.next(this.valPorcentaje),this.isTimeLimitSource.next(!0),this.stopCountTimerLimit()):(e!==this.valPorcentaje&&this.countdownSource.next(this.valPorcentaje),this.progressCount()),e=this.valPorcentaje},1e3))}setTimeDate(){const e=(new Date).getTime(),t=localStorage.getItem("sys::tnum")?parseInt(localStorage.getItem("sys::tnum"),0):e,i=Math.floor((e-t)/1e3);return localStorage.setItem("sys::tnum",t.toString()),i}stopCountTimerLimit(){this.isPlayTimer=!1,this.init=0,this.valPorcentaje=0,localStorage.removeItem("sys::tcount"),localStorage.removeItem("sys::tnum"),this.clearTimeout(),this.isPorgressVisibleSource.next(!1),this.isTimeLimitSource.next(!1)}clearTimeout(){this.countdownTimerRef&&(clearTimeout(this.countdownTimerRef),this.countdownTimerRef=null)}}return e.ngInjectableDef=a.Sb({factory:function(){return new e(a.Tb(o.a))},token:e,providedIn:"root"}),e})()},Z5h4:function(e,t,i){"use strict";i.d(t,"a",function(){return r}),i.d(t,"b",function(){return d});var s=i("8Y7J"),o=(i("r0V8"),i("SVse"),i("POq0")),a=(i("IP0z"),i("Xd0L")),n=(i("cUpR"),i("/HVE")),c=i("omvX"),r=(i("s7LF"),i("5GAg"),s.qb({encapsulation:2,styles:["@keyframes mat-checkbox-fade-in-background{0%{opacity:0}50%{opacity:1}}@keyframes mat-checkbox-fade-out-background{0%,50%{opacity:1}100%{opacity:0}}@keyframes mat-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:22.91026}50%{animation-timing-function:cubic-bezier(0,0,.2,.1)}100%{stroke-dashoffset:0}}@keyframes mat-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0,0,0,1)}100%{transform:scaleX(1)}}@keyframes mat-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(.4,0,1,1);stroke-dashoffset:0}to{stroke-dashoffset:-22.91026}}@keyframes mat-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0,0,.2,.1);opacity:1;transform:rotate(0)}to{opacity:0;transform:rotate(45deg)}}@keyframes mat-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(.14,0,0,1);opacity:0;transform:rotate(45deg)}to{opacity:1;transform:rotate(360deg)}}@keyframes mat-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0,0,.2,.1);opacity:0;transform:rotate(-45deg)}to{opacity:1;transform:rotate(0)}}@keyframes mat-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(.14,0,0,1);opacity:1;transform:rotate(0)}to{opacity:0;transform:rotate(315deg)}}@keyframes mat-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;opacity:1;transform:scaleX(1)}100%,32.8%{opacity:0;transform:scaleX(0)}}.mat-checkbox-background,.mat-checkbox-frame{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:2px;box-sizing:border-box;pointer-events:none}.mat-checkbox{transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);cursor:pointer;-webkit-tap-highlight-color:transparent}._mat-animation-noopable.mat-checkbox{transition:none;animation:none}.mat-checkbox .mat-ripple-element:not(.mat-checkbox-persistent-ripple){opacity:.16}.mat-checkbox-layout{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:inherit;align-items:baseline;vertical-align:middle;display:inline-flex;white-space:nowrap}.mat-checkbox-label{-webkit-user-select:auto;-moz-user-select:auto;-ms-user-select:auto;user-select:auto}.mat-checkbox-inner-container{display:inline-block;height:16px;line-height:0;margin:auto;margin-right:8px;order:0;position:relative;vertical-align:middle;white-space:nowrap;width:16px;flex-shrink:0}[dir=rtl] .mat-checkbox-inner-container{margin-left:8px;margin-right:auto}.mat-checkbox-inner-container-no-side-margin{margin-left:0;margin-right:0}.mat-checkbox-frame{background-color:transparent;transition:border-color 90ms cubic-bezier(0,0,.2,.1);border-width:2px;border-style:solid}._mat-animation-noopable .mat-checkbox-frame{transition:none}@media (-ms-high-contrast:active){.mat-checkbox.cdk-keyboard-focused .mat-checkbox-frame{border-style:dotted}}.mat-checkbox-background{align-items:center;display:inline-flex;justify-content:center;transition:background-color 90ms cubic-bezier(0,0,.2,.1),opacity 90ms cubic-bezier(0,0,.2,.1)}._mat-animation-noopable .mat-checkbox-background{transition:none}.mat-checkbox-persistent-ripple{width:100%;height:100%;transform:none}.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:.04}.mat-checkbox.cdk-keyboard-focused .mat-checkbox-persistent-ripple{opacity:.12}.mat-checkbox-persistent-ripple,.mat-checkbox.mat-checkbox-disabled .mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:0}@media (hover:none){.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{display:none}}.mat-checkbox-checkmark{top:0;left:0;right:0;bottom:0;position:absolute;width:100%}.mat-checkbox-checkmark-path{stroke-dashoffset:22.91026;stroke-dasharray:22.91026;stroke-width:2.13333px}.mat-checkbox-mixedmark{width:calc(100% - 6px);height:2px;opacity:0;transform:scaleX(0) rotate(0);border-radius:2px}@media (-ms-high-contrast:active){.mat-checkbox-mixedmark{height:0;border-top:solid 2px;margin-top:2px}}.mat-checkbox-label-before .mat-checkbox-inner-container{order:1;margin-left:8px;margin-right:auto}[dir=rtl] .mat-checkbox-label-before .mat-checkbox-inner-container{margin-left:auto;margin-right:8px}.mat-checkbox-checked .mat-checkbox-checkmark{opacity:1}.mat-checkbox-checked .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-checked .mat-checkbox-mixedmark{transform:scaleX(1) rotate(-45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark{opacity:0;transform:rotate(45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-indeterminate .mat-checkbox-mixedmark{opacity:1;transform:scaleX(1) rotate(0)}.mat-checkbox-unchecked .mat-checkbox-background{background-color:transparent}.mat-checkbox-disabled{cursor:default}.mat-checkbox-anim-unchecked-checked .mat-checkbox-background{animation:180ms linear 0s mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-checked .mat-checkbox-checkmark-path{animation:180ms linear 0s mat-checkbox-unchecked-checked-checkmark-path}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-background{animation:180ms linear 0s mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0s mat-checkbox-unchecked-indeterminate-mixedmark}.mat-checkbox-anim-checked-unchecked .mat-checkbox-background{animation:180ms linear 0s mat-checkbox-fade-out-background}.mat-checkbox-anim-checked-unchecked .mat-checkbox-checkmark-path{animation:90ms linear 0s mat-checkbox-checked-unchecked-checkmark-path}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-checkmark{animation:90ms linear 0s mat-checkbox-checked-indeterminate-checkmark}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0s mat-checkbox-checked-indeterminate-mixedmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-checkmark{animation:.5s linear 0s mat-checkbox-indeterminate-checked-checkmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-mixedmark{animation:.5s linear 0s mat-checkbox-indeterminate-checked-mixedmark}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-background{animation:180ms linear 0s mat-checkbox-fade-out-background}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-mixedmark{animation:.3s linear 0s mat-checkbox-indeterminate-unchecked-mixedmark}.mat-checkbox-input{bottom:0;left:50%}.mat-checkbox .mat-checkbox-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}"],data:{}}));function d(e){return s.Ob(2,[s.Kb(671088640,1,{_inputElement:0}),s.Kb(671088640,2,{ripple:0}),(e()(),s.sb(2,0,[["label",1]],null,16,"label",[["class","mat-checkbox-layout"]],[[1,"for",0]],null,null,null,null)),(e()(),s.sb(3,0,null,null,10,"div",[["class","mat-checkbox-inner-container"]],[[2,"mat-checkbox-inner-container-no-side-margin",null]],null,null,null,null)),(e()(),s.sb(4,0,[[1,0],["input",1]],null,0,"input",[["class","mat-checkbox-input cdk-visually-hidden"],["type","checkbox"]],[[8,"id",0],[8,"required",0],[8,"checked",0],[1,"value",0],[8,"disabled",0],[1,"name",0],[8,"tabIndex",0],[8,"indeterminate",0],[1,"aria-label",0],[1,"aria-labelledby",0],[1,"aria-checked",0]],[[null,"change"],[null,"click"]],function(e,t,i){var s=!0,o=e.component;return"change"===t&&(s=!1!==o._onInteractionEvent(i)&&s),"click"===t&&(s=!1!==o._onInputClick(i)&&s),s},null,null)),(e()(),s.sb(5,0,null,null,3,"div",[["class","mat-checkbox-ripple mat-ripple"],["matRipple",""]],[[2,"mat-ripple-unbounded",null]],null,null,null,null)),s.rb(6,212992,[[2,4]],0,a.f,[s.k,s.y,n.a,[2,a.d],[2,c.a]],{centered:[0,"centered"],radius:[1,"radius"],animation:[2,"animation"],disabled:[3,"disabled"],trigger:[4,"trigger"]},null),s.Hb(7,{enterDuration:0}),(e()(),s.sb(8,0,null,null,0,"div",[["class","mat-ripple-element mat-checkbox-persistent-ripple"]],null,null,null,null,null)),(e()(),s.sb(9,0,null,null,0,"div",[["class","mat-checkbox-frame"]],null,null,null,null,null)),(e()(),s.sb(10,0,null,null,3,"div",[["class","mat-checkbox-background"]],null,null,null,null,null)),(e()(),s.sb(11,0,null,null,1,":svg:svg",[[":xml:space","preserve"],["class","mat-checkbox-checkmark"],["focusable","false"],["version","1.1"],["viewBox","0 0 24 24"]],null,null,null,null,null)),(e()(),s.sb(12,0,null,null,0,":svg:path",[["class","mat-checkbox-checkmark-path"],["d","M4.1,12.7 9,17.6 20.3,6.3"],["fill","none"],["stroke","white"]],null,null,null,null,null)),(e()(),s.sb(13,0,null,null,0,"div",[["class","mat-checkbox-mixedmark"]],null,null,null,null,null)),(e()(),s.sb(14,0,[["checkboxLabel",1]],null,4,"span",[["class","mat-checkbox-label"]],null,[[null,"cdkObserveContent"]],function(e,t,i){var s=!0;return"cdkObserveContent"===t&&(s=!1!==e.component._onLabelTextChange()&&s),s},null,null)),s.rb(15,1196032,null,0,o.a,[o.b,s.k,s.y],null,{event:"cdkObserveContent"}),(e()(),s.sb(16,0,null,null,1,"span",[["style","display:none"]],null,null,null,null,null)),(e()(),s.Mb(-1,null,["\xa0"])),s.Db(null,0)],function(e,t){var i=t.component,o=e(t,7,0,150);e(t,6,0,!0,20,o,i._isRippleDisabled(),s.Eb(t,2))},function(e,t){var i=t.component;e(t,2,0,i.inputId),e(t,3,0,!s.Eb(t,14).textContent||!s.Eb(t,14).textContent.trim()),e(t,4,1,[i.inputId,i.required,i.checked,i.value,i.disabled,i.name,i.tabIndex,i.indeterminate,i.ariaLabel||null,i.ariaLabelledby,i._getAriaChecked()]),e(t,5,0,s.Eb(t,6).unbounded)})}},fbMX:function(e,t,i){"use strict";i.d(t,"a",function(){return o});var s=i("8Y7J");let o=(()=>{class e{constructor(){}set(e,t){localStorage.setItem(e,t)}get(e){return localStorage.getItem(e)}isExistKey(e){return!!localStorage.getItem(e)}clear(e){localStorage.removeItem(e)}}return e.ngInjectableDef=s.Sb({factory:function(){return new e},token:e,providedIn:"root"}),e})()},"nYx/":function(e,t,i){"use strict";i.d(t,"a",function(){return c});var s=i("zOUh"),o=i("+lji"),a=i("yFR0"),n=i("8Y7J");let c=(()=>{class e{constructor(e,t,i){this.infoTokenService=e,this.crudService=t,this.socketService=i,this.infoToken=this.infoTokenService.getInfoUs()}getSubtotales(){this.objTotales=JSON.parse(atob(localStorage.getItem("sys::st")))}registrarPago(e,t,i){this.getSubtotales();const s={idcliente:this.infoToken.idcliente,idorg:this.infoToken.idorg,idsede:this.infoToken.idsede,mesa:this.infoToken.numMesaLector,importe:e},o={idcliente:s.idcliente,idorg:s.idorg,idsede:s.idsede,mesa:s.mesa,importe:s.importe,objSubTotal:this.objTotales,objTransaction:t,objCliente:i,objOperacion:s};this.crudService.postFree(o,"transaction","registrar-pago",!1).subscribe(e=>{this.setIdRegistroPagoTransaction(e.data[0].idregistro_pago),this.socketService.emit("notificar-pago-pwa",o)})}getIpClient(){let e="";return this.crudService.getFree("https://api.ipify.org?format=jsonp&callback=?").subscribe(t=>{e=t.ip}),e}getDataTrasaction(){return this.loadDataTransaction(),this.responseTransaction.isSuccess=!(this.responseTransaction&&!this.responseTransaction.error),this.responseTransaction}setIdRegistroPagoTransaction(e){this.loadDataTransaction(),this.responseTransaction.idregistro_pago=e,this.upDataTransaction()}loadDataTransaction(){this.responseTransaction=JSON.parse(localStorage.getItem("sys::transaction-response"))}upDataTransaction(){localStorage.setItem("sys::transaction-response",JSON.stringify(this.responseTransaction))}removeLocalDataTransaction(){localStorage.removeItem("sys::transaction-response"),this.responseTransaction=null}}return e.ngInjectableDef=n.Sb({factory:function(){return new e(n.Tb(s.a),n.Tb(o.a),n.Tb(a.a))},token:e,providedIn:"root"}),e})()},nx09:function(e,t,i){"use strict";var s=i("7RJT"),o=i("Te6q"),a=i("6NNB"),n=i("Ie24"),c=i("fbMX"),r=i("yFR0"),d=i("WF5t"),l=i("/sn2"),m=i("wne+"),h=i("eI2u");class u{constructor(){this.isTpcLocal=!1,this.isTpcSoloLLevar=!1,this.isTpcSoloDelivery=!1,this.isTpcSoloOther=!1,this.isRequiereMesa=!1}}class p{}var b=i("JOr0"),g=i("8Y7J"),k=i("dFDH");i.d(t,"a",function(){return f});let f=(()=>{class e{constructor(e,t,i,c,r,d,l,m){this.storageService=e,this.socketService=t,this.timerLimitService=i,this.navigatorService=c,this._snackBar=r,this.utilesService=d,this.listenStatusService=l,this.establecimientoService=m,this.miPedidoSource=new s.BehaviorSubject(new a.a),this.miPedidoObserver$=this.miPedidoSource.asObservable(),this.countItemsSource=new s.BehaviorSubject(0),this.countItemsObserve$=this.countItemsSource.asObservable(),this.itemStockChangeSource=new s.BehaviorSubject(new o.a),this.itemStockChangeObserve$=this.itemStockChangeSource.asObservable(),this.isPreAvisoVisible=!1,this.listItemsPedido=[],this.miPedido=new a.a,this.mpObjSeccionSelected=new n.a,this.time=new Date}getObjCarta(){return this.objCarta}getObjCartaLibery(){return JSON.parse(JSON.stringify(this.objCarta))}setObjMiPedido(e){this.miPedido=e,this.miPedidoSource.next(this.miPedido)}resetObjMiPedido(){this.miPedido=new a.a,this.miPedidoSource.next(this.miPedido)}setObjCarta(e){this.objCarta={},this.objCarta={carta:null,bodega:null},this.objCarta.carta=e[0].carta,this.objCarta.bodega=e[0].bodega;const t=this.objCarta.bodega;t&&this.objCarta.carta.map(e=>{t.map(t=>{e.secciones.push(t)})}),console.log("objCartaCarta",this.objCarta)}getMiPedido(){return 0===this.miPedido.tipoconsumo.length&&this.storageService.isExistKey("sys::order::all")&&(this.miPedido=JSON.parse(atob(this.storageService.get("sys::order::all")))),this.miPedido}setobjItemTipoConsumoSelected(e){this.mpObjItemTipoConsumoSelected=e}setObjSeccionSeleced(e){this.mpObjSeccionSelected=new n.a,this.mpObjSeccionSelected.des=e.des,this.mpObjSeccionSelected.idimpresora=e.idimpresora,this.mpObjSeccionSelected.idseccion=e.idseccion,this.mpObjSeccionSelected.sec_orden=e.sec_orden,this.mpObjSeccionSelected.ver_stock_cero=e.ver_stock_cero}addItem2(e,t,i=0,s=null){let o=parseInt(t.cantidad.toString(),0);const a=0===i;if(o<=0&&a)return;let n=e.cantidad_seleccionada||0;if((n+=a?1:-1)<0)return;"ND"!==t.isporcion&&(n=n<0?0:n,o=(o+=a?-1:1)<0||n<0?0:o),e.cantidad_seleccionada=n=n<0?0:n;const c=JSON.parse(JSON.stringify(e)),r=this.findItemMiPedido(c,this.mpObjSeccionSelected,t,a);r.cantidad=o,t=s?this.findItemCarta(t):t,(t=this.findItemCarta(t)).sumar=a,t.subitems_selected=r.subitems_selected,t.subitems_view=r.subitems_view;const d=this.findItemListPedido(t);let l=1;d?(d.itemtiposconsumo||(d.itemtiposconsumo=this.mpObjItemTipoConsumoSelected),l=this.totalItemTpcSelected(d.itemtiposconsumo)||0,d.cantidad_seleccionada=l,d.subitems_selected=r.subitems_selected,d.subitems_view=r.subitems_view):this.listItemsPedido.push(t),t.cantidad_seleccionada=l,this.itemStockChangeSource.next(t),this.setLocalStorageHora(),this.setLocalStoragePedido(),this.socketService.emit("itemModificado",t),console.log("listItemsPedido",this.listItemsPedido),console.log("itemModificado en add",t),console.log("itemModificado en add",JSON.stringify(t)),this.listenStatusService.setHayPedidoPendiente(!0),this.playTimerLimit()}totalItemTpcSelected(e){return e.map(e=>e.cantidad_seleccionada||0).reduce((e,t)=>e+t,0)}addCantItemMiPedido(e,t){const i=t,s=i*parseFloat(e.precio_unitario);e.subitems_selected&&e.subitems_selected.map(e=>e.precio*e.cantidad_seleccionada).reduce((e,t)=>e+t,0),e.cantidad_seleccionada=i,e.precio_total=s,e.precio_print=s}addPrecioItemMiPedido(e){const t=e.subitems_view?e.subitems_view.map(e=>e.precio).reduce((e,t)=>e+t,0):0;let i=e.cantidad_seleccionada*parseFloat(e.precio_unitario);e.precio_total=i+=t,e.precio_print=i}addItemSubItemMiPedido(e,t,i){if(e.subitems){if(0===e.subitems.length)return;const t=new p;if(t.id="",t.des="",t.listDes=[],t.cantidad_seleccionada=0,t.precio=0,t.indicaciones="",t.subitems=[],e.subitems_selected&&e.subitems_selected.length>0){e.subitems_selected.map(e=>{t.id+=e.iditem_subitem.toString(),t.listDes.push(this.utilesService.primeraConMayusculas(e.des.toLowerCase())),t.cantidad_seleccionada=1,t.precio+=parseFloat(e.precio.toString()),t.subitems.push(e)}),t.des=t.listDes.join(", "),t.des+=void 0===e.indicaciones||""===e.indicaciones?"":", ("+e.indicaciones+")",e.indicaciones="",e.subitems_view=e.subitems_view?e.subitems_view:[];const s=e.subitems_view.filter(e=>e.id===t.id)[0];s?i?(s.indicaciones+=t.indicaciones,s.cantidad_seleccionada+=1,s.precio+=t.precio):this.restarCantSubItemView(e,s):i?e.subitems_view.push(t):this.restarCantSubItemView(e,null),this.addPrecioItemMiPedido(e)}}}restarCantSubItemView(e,t=null){if(t){const i=t.precio/t.cantidad_seleccionada;t.cantidad_seleccionada-=1,t.precio-=i,t.precio=t.precio<0?0:t.precio,t.cantidad_seleccionada<=0&&(e.subitems_view=e.subitems_view.filter(e=>e.cantidad_seleccionada>0))}else{const t=e.subitems_view[e.subitems_view.length-1],i=t.precio/t.cantidad_seleccionada;t.cantidad_seleccionada--,t.precio-=i,t.cantidad_seleccionada<=0&&(e.subitems_view=e.subitems_view.filter(e=>e.cantidad_seleccionada>0)),e.subitems_selected=t.subitems}}addItemInCarta(e){const t=this.findItemCarta(e);t?(console.log("update"),t.cantidad=t.cantidad):(console.log("add in carta"),this.objCarta.carta.map(t=>{t.secciones.filter(t=>t.idseccion===e.idseccion).map(t=>{t.items.push(e)})})),console.log("item new add in carta",this.objCarta.carta)}findItemFromArr(e,t){return e.filter(e=>e.iditem===t.iditem)[0]}findItemListPedido(e){return this.listItemsPedido.filter(t=>t.iditem===e.iditem)[0]}findItemCartaAndClearIndicaciones(){this.objCarta.carta.map(e=>{e.secciones.map(e=>{e.items.filter(e=>e.indicaciones).map(e=>e.indicaciones=""),e.items.filter(e=>e.subitems_selected).map(e=>e.subitems_selected=null),e.items.filter(e=>e.subitems_view).map(e=>e.subitems_view=null)})})}findItemCarta(e){let t;return this.objCarta.carta.map(i=>{i.secciones.map(i=>{const s=i.items.filter(t=>t.idcarta_lista===e.idcarta_lista)[0];if(s)return t=s})}),t}findItemCartaByIdCartaLista(e){let t;return this.objCarta.carta.map(i=>{i.secciones.map(i=>{const s=i.items.filter(t=>t.idcarta_lista.toString()===e.toString())[0];if(s)return t=s})}),t}findSubItemCartaById(e,t){const i=[];return this.objCarta.carta.map(s=>{s.secciones.map(s=>{s.items.filter(e=>e.iditem.toString()!==t).filter(e=>e.subitems).map(t=>{t.subitems.map(t=>{const s=t.opciones.filter(t=>t.idproducto.toString()+t.idporcion.toString()===e)[0];s&&i.push(s)})})})}),i}resetCantidadesTpcItemCarta(){this.objCarta&&this.objCarta.carta.map(e=>{e.secciones.map(e=>{e.items.map(e=>{e.indicaciones="",e.cantidad_seleccionada=0,e.itemtiposconsumo=null})})})}findItemSeccionCarta(e){let t;return this.objCarta.carta.map(i=>{const s=i.secciones.filter(t=>t.idseccion===e)[0];s&&(t=s)}),t}findOnlyItemMiPedido(e){let t;return this.miPedido.tipoconsumo.map(i=>{i.secciones.map(i=>{t=i.items.filter(t=>t.idcarta_lista===e.idcarta_lista)[0]})}),t}findItemMiPedido(e,t,i,s){let o,a=JSON.parse(JSON.stringify(i));const n=e.cantidad_seleccionada;a.itemtiposconsumo=[],this.addCantItemMiPedido(a,n);const c=this.miPedido.tipoconsumo.filter(t=>t.idtipo_consumo===e.idtipo_consumo)[0];if(c){const e=c.secciones.filter(e=>e.idseccion===t.idseccion)[0];if(e){const t=e.items.filter(e=>e.idcarta_lista===i.idcarta_lista)[0];t?(t.indicaciones=a.indicaciones,this.addCantItemMiPedido(t,n),o=a=t):(e.items.push(a),o=a),a.subitems=i.subitems,a.subitems_selected=i.subitems_selected,this.addItemSubItemMiPedido(a,i,s),this.setCountCantItemTpcAndSeccion(c,e)}else{o=a;const e=JSON.parse(JSON.stringify(t));e.items=[],e.items.push(a),c.secciones=c.secciones?c.secciones:[],c.secciones.push(e),this.addItemSubItemMiPedido(a,i,s),this.setCountCantItemTpcAndSeccion(c,e)}}else{a.subitems=i.subitems,a.subitems_selected=i.subitems_selected,this.addItemSubItemMiPedido(a,i,s);const n=JSON.parse(JSON.stringify(t));n.items=[],n.items.push(a),e.secciones=e.secciones?e.secciones:[],e.secciones.push(n),this.miPedido.tipoconsumo.push(e),this.setCountCantItemTpcAndSeccion(e,n),o=a}return this.clearObjMiPedido(),o}quitarTpcMiPedido(e){1===e.count_items_seccion&&(this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.filter(t=>!e))}quitarSeccionMiPedido(e){1===e.count_items&&this.miPedido.tipoconsumo.map(t=>{t.secciones.filter(t=>!e)})}findMiPedidoIsTPCLocal(){let e=!1;return this.miPedido.tipoconsumo.filter(e=>"LOCAL"===e.titulo).map(t=>{e=!!t.secciones.filter(e=>e.count_items>0)[0]}),e}findMiPedidoIsTPCDelivery(){let e=!1;return this.miPedido.tipoconsumo.filter(e=>"DELIVERY"===e.descripcion.toUpperCase()).map(t=>{e=!!t.secciones.filter(e=>e.count_items>0)[0]}),e}findMiPedidoIsTPCLLevar(){let e=!1;return this.miPedido.tipoconsumo.filter(e=>e.descripcion.toUpperCase().indexOf("LLEVAR")).map(t=>{e=!!t.secciones.filter(e=>e.count_items>0)[0]}),e}findEvaluateTPCMiPedido(){const e=new u;let t=0;return this.miPedido.tipoconsumo.filter(e=>e.count_items_seccion>0).map(i=>{"LOCAL"===i.titulo&&(e.isTpcLocal=!0,t++),i.descripcion.toUpperCase().indexOf("LLEVAR")>-1&&(e.isTpcSoloLLevar=!0,t++),i.descripcion.toUpperCase().indexOf("DELIVERY")>-1&&(e.isTpcSoloDelivery=!0),e.isRequiereMesa=!!e.isTpcLocal,e.isTpcSoloLLevar=!(1!==t||!e.isTpcSoloLLevar)}),e}findSeccionInMipedidoByPrint(e){let t;return this.miPedido.tipoconsumo.map(i=>{t=i.secciones.filter(t=>t.idimpresora===e)}),t}findIsHayItems(){return this.setCountTotalImtesPedido()>0}clearObjMiPedido(){if(this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.filter(e=>e.count_items_seccion>0),0===this.miPedido.tipoconsumo.length)return this.miPedido=new a.a,console.log("mi pedido clear",this.miPedido),void this.miPedidoSource.next(this.miPedido);this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.map(e=>(e.secciones=e.secciones.filter(e=>e.count_items>0),e)),this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.map(e=>(e.secciones=e.secciones.map(e=>(e.items=e.items.filter(e=>e.cantidad_seleccionada>0),e)),e)),console.log("mi pedido clear",this.miPedido),this.miPedidoSource.next(this.miPedido)}setCountCantItemTpcAndSeccion(e,t){const i=t.items.map(e=>e.cantidad_seleccionada).reduce((e,t)=>e+t,0);t.count_items=i;const s=e.secciones.map(e=>e.count_items).reduce((e,t)=>e+t,0);e.count_items_seccion=s,this.setCountTotalImtesPedido()}setCountTotalImtesPedido(){const e=this.miPedido.tipoconsumo.map(e=>e.count_items_seccion).reduce((e,t)=>e+t,0);return this.countItemsSource.next(e),e}setLocalStorageHora(){if(this.storageService.isExistKey("sys::h"))return;const e=`${this.time.getHours()}:${this.time.getMinutes()}:${this.time.getSeconds()}`;this.storageService.set("sys::h",e.toString())}setLocalStoragePedido(){this.storageService.set("sys::order",btoa(JSON.stringify(this.listItemsPedido))),this.storageService.set("sys::order::all",btoa(JSON.stringify(this.miPedido)))}clearPedidoIsLimitTime(){this.storageService.isExistKey("sys::order")&&(this.listItemsPedido=JSON.parse(atob(this.storageService.get("sys::order"))),this.miPedido=JSON.parse(atob(this.storageService.get("sys::order::all"))))}resetAllNewPedido(){this.socketService.emit("resetPedido",this.listItemsPedido),this.prepareNewPedido()}prepareNewPedido(){this.resetTpcCarta(),this.storageService.clear("sys::h"),this.storageService.clear("sys::order"),this.storageService.clear("sys::order::all"),this.storageService.clear("sys::tcount"),this.storageService.clear("sys::tnum"),this.miPedido=null,this.miPedido=new a.a,this.miPedidoSource.next(this.miPedido),this.countItemsSource.next(0),this.listenStatusService.setHayPedidoPendiente(!1),this.stopTimerLimit()}getOnlyCarta(){this.socketService.emit("getOnlyCarta",null)}resetTpcCarta(){try{this.listItemsPedido.map(e=>{if(e.indicaciones="",!e.itemtiposconsumo)return;e.itemtiposconsumo=null;const t=this.findItemCarta(e);t.indicaciones="",t.cantidad_seleccionada=0,t.itemtiposconsumo=null})}catch(e){console.log(e)}this.resetCantidadesTpcItemCarta(),this.listItemsPedido=[]}updatePedidoFromStrorage(){this.listenStatusService.setHayPedidoPendiente(!1),this.storageService.isExistKey("sys::order")&&(this.listenStatusService.setHayPedidoPendiente(!0),this.listItemsPedido=JSON.parse(atob(this.storageService.get("sys::order"))),this.miPedido=JSON.parse(atob(this.storageService.get("sys::order::all"))),this.setCountTotalImtesPedido(),this.miPedidoSource.next(this.miPedido),this.listItemsPedido.map(e=>{0===e.isalmacen&&this.objCarta.carta.map(t=>{t.secciones.map(t=>{const i=t.items.filter(t=>t.idcarta_lista===e.idcarta_lista)[0];i&&(i.cantidad_seleccionada=e.cantidad_seleccionada,i.itemtiposconsumo=e.itemtiposconsumo)})})}))}updatePedidoFromClear(){this.listItemsPedido&&(this.listItemsPedido.map(e=>{0===e.isalmacen&&this.objCarta.carta.map(t=>{t.secciones.map(t=>{const i=t.items.filter(t=>"ND"!==t.isporcion&&t.idcarta_lista===e.idcarta_lista)[0];i&&(i.cantidad=parseInt(i.cantidad.toString(),0)+e.cantidad_seleccionada)})})}),this.prepareNewPedido())}getEstadoStockItem(e){return e>10?"verde":e>5?"amarillo":"rojo"}validarReglasCarta(e){let t=0,i=0,s=0,o=0,a=0,n=0,c=0;this.miPedido.tipoconsumo.map(e=>{e.secciones.map(e=>{e.items.map(e=>e.precio_total_calc=null)})}),e.map(e=>{i=e.idseccion_detalle,s=this.countCantItemsFromSeccion(t=e.idseccion),o=this.countCantItemsFromSeccion(i),a=(a=s-o)<0?s:a,this.miPedido.tipoconsumo.map(e=>{e.secciones.filter(e=>e.idseccion.toString()===i.toString()).map(e=>{e.items.map((e,t)=>{const i=parseFloat(e.precio),r=e.cantidad_seleccionada;n=c=null!==e.precio_total_calc?e.precio_total_calc:e.precio_total,s>=o?n=0:a>0&&(n=(n=c-(n=a*i))<0?0:n,a=a-r<0?0:a-r),e.precio_total_calc=parseFloat(n.toString()),e.precio_print=parseFloat(n.toString()),e.cantidad_descontado=r})})})})}countCantItemsFromSeccion(e){let t=0;return this.miPedido.tipoconsumo.map(i=>{i.secciones.map(i=>{t+=i.items.filter(t=>t.idseccion.toString()===e.toString()).map(e=>e.cantidad_seleccionada).reduce((e,t)=>e+t,0)})}),t}countCantItemsFromTpcSeccion(e,t){let i=0;return this.miPedido.tipoconsumo.filter(t=>t.idtipo_consumo.toString()===e.toString()).map(e=>{e.secciones.map(e=>{i+=e.items.filter(e=>e.idseccion.toString()===t.toString()).map(e=>e.cantidad_seleccionada).reduce((e,t)=>e+t,0)})}),i}getArrSubTotales(e){const t=this.getSubTotalMiPedido();let i=t;const s=[];let o={id:0,descripcion:"SUB TOTAL",esImpuesto:0,visible:!0,quitar:!1,tachado:!1,visible_cpe:!0};o.importe=parseFloat(t.toString()).toFixed(2),s.push(o);const a=[];e.filter(e=>"p"===e.tipo).map(e=>{const s=e.monto/100,o=1===e.es_impuesto,n=0===e.activo,c=(t*s).toFixed(2),r={};r.id=e.tipo+e.id,r.descripcion=e.descripcion,r.esImpuesto=e.es_impuesto,r.visible=!0,r.quitar=!1,r.tachado=!1,r.visible_cpe=o,"I.G.V"===r.descripcion?r.importe=n?s:0:(r.importe=o?n?c:0:c,r.importe=parseFloat(r.importe.toString()).toFixed(2),i+=parseFloat(r.importe)),0!==r.importe&&a.push(r)});let n=0;const c=[],r=e.filter(e=>"a"===e.tipo),d=!!this.establecimientoService.get().idsede;let l=!1;if(r.map(e=>{const t={};if(e.descripcion.toUpperCase().indexOf("DELIVERY")>-1&&d?(l=!0,e.descripcion="Entrega",n=this.establecimientoService.get().c_servicio):n=parseFloat(e.monto),0===e.nivel){const t=this.countCantItemsFromTpcSeccion(e.idtipo_consumo,e.idseccion);if(0===t)return;n=t*parseFloat(e.monto)}t.id=e.tipo+e.id,t.descripcion=e.descripcion,t.esImpuesto=e.es_impuesto,t.visible=!0,t.quitar=!0,t.tachado=!1,t.visible_cpe=!1,t.importe=parseFloat(n.toString()).toFixed(2),i+=parseFloat(t.importe);const s=c.filter(e=>e.descripcion===t.descripcion)[0];s?s.importe+=parseFloat(t.importe):c.push(t)}),!l&&d){const e={id:-2,descripcion:"Entrega",esImpuesto:0,visible:!0,quitar:!1,tachado:!1,visible_cpe:!1};e.importe=parseFloat(this.establecimientoService.get().c_servicio.toString()).toFixed(2),i+=parseFloat(e.importe),c.push(e)}a.map(e=>s.push(e)),c.map(e=>s.push(e));const m=s.filter(e=>"SUB TOTAL"===e.descripcion)[0],h=s.filter(e=>"I.G.V"===e.descripcion)[0];let u=h?h.importe:0,p=m?m.importe:0;return u>0&&(p-=u=parseFloat((p*u).toString()).toFixed(2),h.importe=u,m.importe=p.toFixed(2)),(o={}).id=0,o.esImpuesto=0,o.descripcion="TOTAL",o.visible=!0,o.quitar=!1,o.tachado=!1,o.visible_cpe=!0,o.importe=parseFloat(i.toString()).toFixed(2),s.push(o),console.log("totales",s),s}getSubTotalMiPedido(){let e=0;return this.miPedido.tipoconsumo.map(t=>{t.secciones.map(t=>{e+=t.items.map(e=>e.precio_print).reduce((e,t)=>e+t,0)})}),e}getImporteTotalItemFromMiPedido(e){let t=0;return this.miPedido.tipoconsumo.map(i=>{i.secciones.map(i=>{t+=i.items.filter(t=>t.iditem===e.iditem).map(e=>e.precio_print).reduce((e,t)=>e+t,0)})}),t}playTimerLimit(){this.timerLimitService.playCountTimerLimit()}stopTimerLimit(){this.timerLimitService.resetCountTimerLimit()}restoreTimerLimit(){this.timerLimitService.resetCountTimerLimit()}listenChangeCantItem(){this.socketService.onItemModificado().subscribe(e=>{let t;null!=e.listItemPorcion?e.listItemPorcion.map(i=>{t=this.findItemCartaByIdCartaLista(i.idcarta_lista);const s=parseInt(i.cantidad,0);t.cantidad=s||parseInt(e.item.cantidad.toString(),0),this.setCantidadItemModificadoPwa(e.item,t,parseInt(i.cantidad,0),!0)}):(t=this.findItemCarta(e=e.item),this.setCantidadItemModificadoPwa(e,t)),console.log("socket list",this.listItemsPedido)}),this.socketService.onItemResetCant().subscribe(e=>{let t;null!=e.listItemPorcion?e.listItemPorcion.map(i=>{(t=this.findItemCartaByIdCartaLista(i.idcarta_lista)).cantidad=parseInt(i.cantidad,0),this.setCantidadItemModificadoPwa(e.item,t,parseInt(i.cantidad,0),!0),this.itemStockChangeSource.next(t)}):((t=this.findItemCarta(e=e.item)).cantidad=parseInt(e.cantidad.toString(),0),t.subitems=e.subitems,this.itemStockChangeSource.next(t))}),this.socketService.onNuevoItemAddInCarta().subscribe(e=>{console.log("onNuevoItemAddInCarta",e),this.addItemInCarta(e)}),this.socketService.onGetDatosSede().subscribe(e=>{this.objDatosSede=e[0],this.listenStatusService.setHayDatosSede(!0),localStorage.setItem("sys::s",this.objDatosSede.datossede[0].nombre+"|"+this.objDatosSede.datossede[0].ciudad),console.log("datos de la sede ps",this.objDatosSede),this.max_minute_order=e[0].datossede[0].pwa_time_limit,this.timerLimitService.maxTime=100*this.max_minute_order}),this.timerLimitService.countdown$.subscribe(e=>{switch(e){case 1:this.isPreAvisoVisible=!1;break;case 80:this.isPreAvisoVisible||(this.isPreAvisoVisible=!0,this._snackBar.open("Proximo a cumplir el tiempo de envio.","",{duration:2e3}));break;case 100:this._snackBar.open("Tiempo agotado, debe realizar un nuevo pedido.","",{duration:3e3})}}),this.timerLimitService.isTimeLimitComplet$.subscribe(e=>{!0===e&&(this.resetAllNewPedido(),this.navigatorService.setPageActive("carta"))})}setCantidadItemModificadoPwa(e,t,i=null,s=!1){e.subitems&&e.idcarta_lista===t.idcarta_lista&&e.subitems.map(i=>{i.opciones.map(i=>{t.subitems.map(t=>{const s=t.opciones.filter(e=>e.iditem_subitem===parseInt(i.iditem_subitem.toString(),0))[0];if(s&&"ND"!==s.cantidad){s.cantidad=i.cantidad;const t=s.idproducto.toString()+s.idporcion.toString();this.findSubItemCartaById(t,e.iditem.toString()).map(e=>{e.cantidad=i.cantidad})}})})}),s||(t.cantidad=i||parseInt(e.cantidad.toString(),0)),this.itemStockChangeSource.next(t)}cerrarSession(){this.socketService.closeConnection(),this.navigatorService.cerrarSession()}}return e.ngInjectableDef=g.Sb({factory:function(){return new e(g.Tb(c.a),g.Tb(r.a),g.Tb(d.a),g.Tb(l.a),g.Tb(k.b),g.Tb(m.a),g.Tb(h.a),g.Tb(b.a))},token:e,providedIn:"root"}),e})()},qTE5:function(e,t,i){"use strict";i.d(t,"a",function(){return s});class s{}},"wne+":function(e,t,i){"use strict";i.d(t,"a",function(){return o});var s=i("8Y7J");let o=(()=>{class e{constructor(){}primeraConMayusculas(e){return(e=e.toLowerCase()).charAt(0).toUpperCase()+e.slice(1)}reformatDate(e){const t=e.split("-");return t[2]+"/"+t[1]+"/"+t[0]}}return e.ngInjectableDef=s.Sb({factory:function(){return new e},token:e,providedIn:"root"}),e})()}}]);