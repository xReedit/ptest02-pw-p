(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"/sn2":function(t,e,i){"use strict";var o=i("ZYCi"),n=i("VnD/"),a=i("mrSG"),r=i("FFOo"),s=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?d:c}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),c=function(t){function e(e,i){var o=t.call(this,e)||this;return o.bufferSize=i,o.buffer=[],o}return a.__extends(e,t),e.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},e.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),t.prototype._complete.call(this)},e}(r.a),d=function(t){function e(e,i,o){var n=t.call(this,e)||this;return n.bufferSize=i,n.startBufferEvery=o,n.buffers=[],n.count=0,n}return a.__extends(e,t),e.prototype._next=function(t){var e=this.bufferSize,i=this.startBufferEvery,o=this.buffers,n=this.count;this.count++,n%i==0&&o.push([]);for(var a=o.length;a--;){var r=o[a];r.push(t),r.length===e&&(o.splice(a,1),this.destination.next(r))}},e.prototype._complete=function(){for(var e=this.buffers,i=this.destination;e.length>0;){var o=e.shift();o.length>0&&i.next(o)}t.prototype._complete.call(this)},e}(r.a),u=i("7RJT"),m=i("zOUh"),l=i("eI2u"),p=i("CcnG");i.d(e,"a",function(){return h});var h=function(){function t(t,e,i){this.router=t,this.infoTokenService=e,this.listenService=i,this.disabledBack=!1,this.resNavigatorSource=new u.BehaviorSubject([]),this.resNavigatorSourceObserve$=this.resNavigatorSource.asObservable(),this.pageActive="carta",this.resNavigator=[],this.historyNavigator=[],this.lastUrlHistory="",this.listenEventNavigator()}return t.prototype.listenEventNavigator=function(){var t,e=this;this.router.events.pipe(Object(n.a)(function(t){return t instanceof o.d}),(t=1,void 0===t&&(t=null),function(e){return e.lift(new s(2,t))})).subscribe(function(t){if(null!=t&&"popstate"===t[1].navigationTrigger){if(e.disabledBack)return!1;var i=t[0].url.indexOf(";")?t[0].url.substr(1).split(";")[1].split("=")[1]:t[0].url;i.length>0&&(e.lastUrlHistory=i,e.managerGoBack(i,""))}})},t.prototype.setPageActive=function(t){this.pageActive=t,this.lastUrlHistory="carta"!==t?t:this.lastUrlHistory;var e=this.findPageActiveInHistory(t);this.addLink(e?e.url:t),this.resNavigator.pageActive=t,this.resNavigator.url=e?e.url:t,this.resNavigatorSource.next(this.resNavigator)},t.prototype.saveHistoryPageActive=function(t,e){this.historyNavigator[t]=[],this.historyNavigator[t].key=t,this.historyNavigator[t].url=e},t.prototype.findPageActiveInHistory=function(t){return Object.values(this.historyNavigator).filter(function(e){return e.key===t})[0]},t.prototype.addLink=function(t){this.router.navigate([".",{state:t}]),this.saveHistoryPageActive(this.pageActive,t)},t.prototype.cerrarSession=function(t){void 0===t&&(t=!1),this.infoTokenService.isDelivery()?this.router.navigate(["../zona-delivery"]):this.router.navigate(["../"]).then(function(){t&&window.location.reload()})},t.prototype.managerGoBack=function(t,e){var i="";switch(console.log("managerGoBack",t),t){case"carta-i-secciones-items":i="carta",this.addLink("carta-i-secciones");break;case"carta-i-secciones":i="carta",this.addLink("carta-i-");break;case"carta-i-":i="carta-o-",this.addLink("carta-o-"),console.log("=========================== listo para salir"),this.listoParaSalir();break;case"mipedido-confirma":i="mipedido",this.addLink("mipedido");break;case"mipedido":i="carta",this.addLink("carta"),this.listoParaSalir();break;case"estado":case"carta":i="carta";break;case"lanzar-encuesta":i="lanzar-encuesta"}""!==i&&(this.pageActive=i,this.setPageActive(i))},t.prototype._router=function(t){this.router.navigate([t])},t.prototype.disableGoBack=function(){this.disabledBack=!0,history.pushState(null,null,location.href),window.onpopstate=function(){history.go(1)}},t.prototype.listoParaSalir=function(){this.infoTokenService.isDelivery()&&this.listenService.setIsOutEstablecimientoDelivery(!0)},t.ngInjectableDef=p.Ub({factory:function(){return new t(p.Vb(o.l),p.Vb(m.a),p.Vb(l.a))},token:t,providedIn:"root"}),t}()},"6NNB":function(t,e,i){"use strict";i.d(e,"a",function(){return o});var o=function(){return function(){this.tipoconsumo=[]}}()},Ie24:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var o=function(){return function(){this.items=[]}}()},JOr0:function(t,e,i){"use strict";i.d(e,"a",function(){return a});var o=i("qTE5"),n=i("CcnG"),a=function(){function t(){this.keyStorage="sys::ed"}return t.prototype.set=function(t){localStorage.setItem(this.keyStorage,btoa(JSON.stringify(t)))},t.prototype.get=function(){var t=new o.a,e=localStorage.getItem(this.keyStorage);return e?JSON.parse(atob(e)):t},t.ngInjectableDef=n.Ub({factory:function(){return new t},token:t,providedIn:"root"}),t}()},OzqD:function(t,e,i){"use strict";i.d(e,"a",function(){return d});var o=i("A8zI"),n=i("eI2u"),a=i("+lji"),r=i("zOUh"),s=i("7RJT"),c=i("CcnG"),d=function(){function t(t,e,i){this.listenStatusService=t,this.crudService=e,this.infoTokenService=i,this.estadoPedido=new o.a,this.keyStorage="sys::status",this.timeInterval=null,this.timeNow=new Date,this.hayPedidoPendiente=!1,this.timeRestanteAproxSource=new s.BehaviorSubject(0),this.timeRestanteAprox$=this.timeRestanteAproxSource.asObservable(),this.hayCuentaClienteSource=new s.BehaviorSubject(null),this.hayCuentaCliente$=this.hayCuentaClienteSource.asObservable(),this.deserializar(),this.dataPost={idsede:this.infoTokenService.getInfoUs().idsede,idcliente:this.infoTokenService.getInfoUs().idcliente}}return t.prototype.deserializar=function(){var t=localStorage.getItem(this.keyStorage);this.estadoPedido=(t="{}"===t?null:t)?JSON.parse(t):new o.a},t.prototype.get=function(){this.deserializar(),this.getCuentaTotales()},t.prototype.getCuentaTotales=function(){var t=this,e=0;return this.crudService.postFree(this.dataPost,"pedido","lacuenta-cliente-totales",!1).subscribe(function(i){0!==i.data.length?(t.setImporte(e=i.data[0].importe||0),t.estadoPedido.hayPedidoCliente=!0,t.calcTimeAprox(),console.log("cuenta cliente totales",i),t.notifyChange()):t.estadoPedido.hayPedidoCliente=!1}),e},t.prototype.getCuenta=function(){var t=this;this.crudService.postFree(this.dataPost,"pedido","lacuenta-cliente",!1).subscribe(function(e){if(0!==e.data.length)return t.estadoPedido.hayPedidoCliente=!0,t.calcTimeAprox(),console.log("cuenta cliente",e),t.hayCuentaClienteSource.next(e),t.notifyChange(),e;t.estadoPedido.hayPedidoCliente=!1})},t.prototype.getImporteCuenta=function(){var t=this;return new Promise(function(e){t.crudService.postFree(t.dataPost,"pedido","lacuenta-cliente-totales",!1).subscribe(function(t){e(t.success?t.data[0].importe:0)})})},t.prototype.getObj=function(){return this.estadoPedido||this.deserializar(),this.estadoPedido},t.prototype.setEstado=function(t){this.deserializar(),this.estadoPedido.estado=t,this.notifyChange()},t.prototype.setImporte=function(t){this.deserializar(),this.estadoPedido.importe=t,this.notifyChange()},t.prototype.setHoraInitPedido=function(t){this.deserializar(),this.estadoPedido.horaInt=t,this.notifyChange()},t.prototype.setTimeAprox=function(t){this.deserializar(),this.estadoPedido.isTiempoAproxCumplido=t,this.notifyChange()},t.prototype.setHayPedidoPendiente=function(t){this.deserializar(),this.estadoPedido.hayPedidoClientePendiente=t,this.notifyChange()},t.prototype.setisPagada=function(t){this.deserializar(),this.estadoPedido.isPagada=t,this.notifyChange()},t.prototype.setisRegisterPago=function(t){this.deserializar(),this.estadoPedido.isRegisterOnePago=t,this.notifyChange()},t.prototype.calcTimeAprox=function(){var t=this;this.crudService.postFree(this.dataPost,"pedido","calc-time-despacho",!1).subscribe(function(e){t.estadoPedido.estado=0,t.estadoPedido.numMinAprox=e.data[0].rpt,t.estadoPedido.isTiempoAproxCumplido=!1,t.notifyChange(),console.log("this.estadoPedido",t.estadoPedido),t.getTimeAprox()})},t.prototype.getTimeAprox=function(){var t=this;return 0===this.estadoPedido.estado?this.timeInterval=setTimeout(function(){var e=t.calTimeMin();e<=0?(t.estadoPedido.estado=1,t.notifyChange(),t.clearTimeout(),clearTimeout(t.timeInterval),e=0):t.getTimeAprox(),t.timeRestanteAproxSource.next(e)},2e3):this.clearTimeout(),0},t.prototype.calTimeMin=function(){var t=(new Date).getTime()-this.estadoPedido.horaInt;return t=Math.round(t%864e5%36e5/6e4),t=this.estadoPedido.numMinAprox-t,isNaN(t)?0:t},t.prototype.clearTimeout=function(){clearTimeout(this.timeInterval),this.timeInterval=null},t.prototype.notifyChange=function(){this.listenStatusService.setEstadoPedido(this.estadoPedido),localStorage.setItem(this.keyStorage,JSON.stringify(this.estadoPedido))},t.ngInjectableDef=c.Ub({factory:function(){return new t(c.Vb(n.a),c.Vb(a.a),c.Vb(r.a))},token:t,providedIn:"root"}),t}()},Te6q:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var o=function(){return function(){this.precio_total=0,this.cantidad_seleccionada_x_tpc=0,this.cantidad_descontado=0,this.itemtiposconsumo=[],this.subitems_selected=[],this.subitems_view=[]}}()},WF5t:function(t,e,i){"use strict";i.d(e,"a",function(){return r});var o=i("7RJT"),n=i("zOUh"),a=i("CcnG"),r=function(){function t(t){this.infoToken=t,this.countdownTimerRef=null,this.init=0,this.valPorcentaje=0,this.isPlayTimer=!1,this.dateNow=new Date,this.countdownSource=new o.BehaviorSubject(0),this.countdown$=this.countdownSource.asObservable(),this.isTimeLimitSource=new o.BehaviorSubject(!1),this.isTimeLimitComplet$=this.isTimeLimitSource.asObservable(),this.isPorgressVisibleSource=new o.BehaviorSubject(!1),this.isPorgressVisible$=this.isPorgressVisibleSource.asObservable()}return t.prototype.destroy=function(){this.clearTimeout()},t.prototype.playCountTimerLimit=function(){this.infoToken.isDelivery()||this.isPlayTimer||(this.isPlayTimer=!0,this.initCount())},t.prototype.resetCountTimerLimit=function(){this.infoToken.isDelivery()||(localStorage.getItem("sys::tcount")?(this.isPlayTimer=!0,this.initCount()):this.stopCountTimerLimit())},t.prototype.initCount=function(){this.infoToken.isDelivery()||(this.valPorcentaje=0,this.init=localStorage.getItem("sys::tcount")?parseInt(localStorage.getItem("sys::tcount"),0):0,this.isTimeLimitSource.next(!1),this.isPorgressVisibleSource.next(!0),this.progressCount())},t.prototype.progressCount=function(){var t=this,e=0;this.isPlayTimer&&(this.countdownTimerRef=setTimeout(function(){t.init=t.setTimeDate(),t.valPorcentaje=Math.round(t.init/t.maxTime*100),localStorage.setItem("sys::tcount",t.init.toString()),t.init>t.maxTime?(t.init=t.maxTime,t.valPorcentaje=100,t.countdownSource.next(t.valPorcentaje),t.isTimeLimitSource.next(!0),t.stopCountTimerLimit()):(e!==t.valPorcentaje&&t.countdownSource.next(t.valPorcentaje),t.progressCount()),e=t.valPorcentaje},1e3))},t.prototype.setTimeDate=function(){var t=(new Date).getTime(),e=localStorage.getItem("sys::tnum")?parseInt(localStorage.getItem("sys::tnum"),0):t,i=Math.floor((t-e)/1e3);return localStorage.setItem("sys::tnum",e.toString()),i},t.prototype.stopCountTimerLimit=function(){this.isPlayTimer=!1,this.init=0,this.valPorcentaje=0,localStorage.removeItem("sys::tcount"),localStorage.removeItem("sys::tnum"),this.clearTimeout(),this.isPorgressVisibleSource.next(!1),this.isTimeLimitSource.next(!1)},t.prototype.clearTimeout=function(){this.countdownTimerRef&&(clearTimeout(this.countdownTimerRef),this.countdownTimerRef=null)},t.ngInjectableDef=a.Ub({factory:function(){return new t(a.Vb(n.a))},token:t,providedIn:"root"}),t}()},Z5h4:function(t,e,i){"use strict";i.d(e,"a",function(){return c}),i.d(e,"b",function(){return d});var o=i("CcnG"),n=(i("de3e"),i("Ip0R"),i("M2Lx")),a=(i("Fzqc"),i("Wf4p")),r=(i("ZYjt"),i("dWZg")),s=i("wFw1"),c=(i("gIcY"),i("lLAP"),o.sb({encapsulation:2,styles:["@keyframes mat-checkbox-fade-in-background{0%{opacity:0}50%{opacity:1}}@keyframes mat-checkbox-fade-out-background{0%,50%{opacity:1}100%{opacity:0}}@keyframes mat-checkbox-unchecked-checked-checkmark-path{0%,50%{stroke-dashoffset:22.91026}50%{animation-timing-function:cubic-bezier(0,0,.2,.1)}100%{stroke-dashoffset:0}}@keyframes mat-checkbox-unchecked-indeterminate-mixedmark{0%,68.2%{transform:scaleX(0)}68.2%{animation-timing-function:cubic-bezier(0,0,0,1)}100%{transform:scaleX(1)}}@keyframes mat-checkbox-checked-unchecked-checkmark-path{from{animation-timing-function:cubic-bezier(.4,0,1,1);stroke-dashoffset:0}to{stroke-dashoffset:-22.91026}}@keyframes mat-checkbox-checked-indeterminate-checkmark{from{animation-timing-function:cubic-bezier(0,0,.2,.1);opacity:1;transform:rotate(0)}to{opacity:0;transform:rotate(45deg)}}@keyframes mat-checkbox-indeterminate-checked-checkmark{from{animation-timing-function:cubic-bezier(.14,0,0,1);opacity:0;transform:rotate(45deg)}to{opacity:1;transform:rotate(360deg)}}@keyframes mat-checkbox-checked-indeterminate-mixedmark{from{animation-timing-function:cubic-bezier(0,0,.2,.1);opacity:0;transform:rotate(-45deg)}to{opacity:1;transform:rotate(0)}}@keyframes mat-checkbox-indeterminate-checked-mixedmark{from{animation-timing-function:cubic-bezier(.14,0,0,1);opacity:1;transform:rotate(0)}to{opacity:0;transform:rotate(315deg)}}@keyframes mat-checkbox-indeterminate-unchecked-mixedmark{0%{animation-timing-function:linear;opacity:1;transform:scaleX(1)}100%,32.8%{opacity:0;transform:scaleX(0)}}.mat-checkbox-background,.mat-checkbox-frame{top:0;left:0;right:0;bottom:0;position:absolute;border-radius:2px;box-sizing:border-box;pointer-events:none}.mat-checkbox{transition:background .4s cubic-bezier(.25,.8,.25,1),box-shadow 280ms cubic-bezier(.4,0,.2,1);cursor:pointer;-webkit-tap-highlight-color:transparent}._mat-animation-noopable.mat-checkbox{transition:none;animation:none}.mat-checkbox .mat-ripple-element:not(.mat-checkbox-persistent-ripple){opacity:.16}.mat-checkbox-layout{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:inherit;align-items:baseline;vertical-align:middle;display:inline-flex;white-space:nowrap}.mat-checkbox-label{-webkit-user-select:auto;-moz-user-select:auto;-ms-user-select:auto;user-select:auto}.mat-checkbox-inner-container{display:inline-block;height:16px;line-height:0;margin:auto;margin-right:8px;order:0;position:relative;vertical-align:middle;white-space:nowrap;width:16px;flex-shrink:0}[dir=rtl] .mat-checkbox-inner-container{margin-left:8px;margin-right:auto}.mat-checkbox-inner-container-no-side-margin{margin-left:0;margin-right:0}.mat-checkbox-frame{background-color:transparent;transition:border-color 90ms cubic-bezier(0,0,.2,.1);border-width:2px;border-style:solid}._mat-animation-noopable .mat-checkbox-frame{transition:none}@media (-ms-high-contrast:active){.mat-checkbox.cdk-keyboard-focused .mat-checkbox-frame{border-style:dotted}}.mat-checkbox-background{align-items:center;display:inline-flex;justify-content:center;transition:background-color 90ms cubic-bezier(0,0,.2,.1),opacity 90ms cubic-bezier(0,0,.2,.1)}._mat-animation-noopable .mat-checkbox-background{transition:none}.mat-checkbox-persistent-ripple{width:100%;height:100%;transform:none}.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:.04}.mat-checkbox.cdk-keyboard-focused .mat-checkbox-persistent-ripple{opacity:.12}.mat-checkbox-persistent-ripple,.mat-checkbox.mat-checkbox-disabled .mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{opacity:0}@media (hover:none){.mat-checkbox-inner-container:hover .mat-checkbox-persistent-ripple{display:none}}.mat-checkbox-checkmark{top:0;left:0;right:0;bottom:0;position:absolute;width:100%}.mat-checkbox-checkmark-path{stroke-dashoffset:22.91026;stroke-dasharray:22.91026;stroke-width:2.13333px}.mat-checkbox-mixedmark{width:calc(100% - 6px);height:2px;opacity:0;transform:scaleX(0) rotate(0);border-radius:2px}@media (-ms-high-contrast:active){.mat-checkbox-mixedmark{height:0;border-top:solid 2px;margin-top:2px}}.mat-checkbox-label-before .mat-checkbox-inner-container{order:1;margin-left:8px;margin-right:auto}[dir=rtl] .mat-checkbox-label-before .mat-checkbox-inner-container{margin-left:auto;margin-right:8px}.mat-checkbox-checked .mat-checkbox-checkmark{opacity:1}.mat-checkbox-checked .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-checked .mat-checkbox-mixedmark{transform:scaleX(1) rotate(-45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark{opacity:0;transform:rotate(45deg)}.mat-checkbox-indeterminate .mat-checkbox-checkmark-path{stroke-dashoffset:0}.mat-checkbox-indeterminate .mat-checkbox-mixedmark{opacity:1;transform:scaleX(1) rotate(0)}.mat-checkbox-unchecked .mat-checkbox-background{background-color:transparent}.mat-checkbox-disabled{cursor:default}.mat-checkbox-anim-unchecked-checked .mat-checkbox-background{animation:180ms linear 0s mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-checked .mat-checkbox-checkmark-path{animation:180ms linear 0s mat-checkbox-unchecked-checked-checkmark-path}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-background{animation:180ms linear 0s mat-checkbox-fade-in-background}.mat-checkbox-anim-unchecked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0s mat-checkbox-unchecked-indeterminate-mixedmark}.mat-checkbox-anim-checked-unchecked .mat-checkbox-background{animation:180ms linear 0s mat-checkbox-fade-out-background}.mat-checkbox-anim-checked-unchecked .mat-checkbox-checkmark-path{animation:90ms linear 0s mat-checkbox-checked-unchecked-checkmark-path}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-checkmark{animation:90ms linear 0s mat-checkbox-checked-indeterminate-checkmark}.mat-checkbox-anim-checked-indeterminate .mat-checkbox-mixedmark{animation:90ms linear 0s mat-checkbox-checked-indeterminate-mixedmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-checkmark{animation:.5s linear 0s mat-checkbox-indeterminate-checked-checkmark}.mat-checkbox-anim-indeterminate-checked .mat-checkbox-mixedmark{animation:.5s linear 0s mat-checkbox-indeterminate-checked-mixedmark}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-background{animation:180ms linear 0s mat-checkbox-fade-out-background}.mat-checkbox-anim-indeterminate-unchecked .mat-checkbox-mixedmark{animation:.3s linear 0s mat-checkbox-indeterminate-unchecked-mixedmark}.mat-checkbox-input{bottom:0;left:50%}.mat-checkbox .mat-checkbox-ripple{position:absolute;left:calc(50% - 20px);top:calc(50% - 20px);height:40px;width:40px;z-index:1;pointer-events:none}"],data:{}}));function d(t){return o.Qb(2,[o.Mb(671088640,1,{_inputElement:0}),o.Mb(671088640,2,{ripple:0}),(t()(),o.ub(2,0,[["label",1]],null,16,"label",[["class","mat-checkbox-layout"]],[[1,"for",0]],null,null,null,null)),(t()(),o.ub(3,0,null,null,10,"div",[["class","mat-checkbox-inner-container"]],[[2,"mat-checkbox-inner-container-no-side-margin",null]],null,null,null,null)),(t()(),o.ub(4,0,[[1,0],["input",1]],null,0,"input",[["class","mat-checkbox-input cdk-visually-hidden"],["type","checkbox"]],[[8,"id",0],[8,"required",0],[8,"checked",0],[1,"value",0],[8,"disabled",0],[1,"name",0],[8,"tabIndex",0],[8,"indeterminate",0],[1,"aria-label",0],[1,"aria-labelledby",0],[1,"aria-checked",0]],[[null,"change"],[null,"click"]],function(t,e,i){var o=!0,n=t.component;return"change"===e&&(o=!1!==n._onInteractionEvent(i)&&o),"click"===e&&(o=!1!==n._onInputClick(i)&&o),o},null,null)),(t()(),o.ub(5,0,null,null,3,"div",[["class","mat-checkbox-ripple mat-ripple"],["matRipple",""]],[[2,"mat-ripple-unbounded",null]],null,null,null,null)),o.tb(6,212992,[[2,4]],0,a.f,[o.k,o.A,r.a,[2,a.d],[2,s.a]],{centered:[0,"centered"],radius:[1,"radius"],animation:[2,"animation"],disabled:[3,"disabled"],trigger:[4,"trigger"]},null),o.Jb(7,{enterDuration:0}),(t()(),o.ub(8,0,null,null,0,"div",[["class","mat-ripple-element mat-checkbox-persistent-ripple"]],null,null,null,null,null)),(t()(),o.ub(9,0,null,null,0,"div",[["class","mat-checkbox-frame"]],null,null,null,null,null)),(t()(),o.ub(10,0,null,null,3,"div",[["class","mat-checkbox-background"]],null,null,null,null,null)),(t()(),o.ub(11,0,null,null,1,":svg:svg",[[":xml:space","preserve"],["class","mat-checkbox-checkmark"],["focusable","false"],["version","1.1"],["viewBox","0 0 24 24"]],null,null,null,null,null)),(t()(),o.ub(12,0,null,null,0,":svg:path",[["class","mat-checkbox-checkmark-path"],["d","M4.1,12.7 9,17.6 20.3,6.3"],["fill","none"],["stroke","white"]],null,null,null,null,null)),(t()(),o.ub(13,0,null,null,0,"div",[["class","mat-checkbox-mixedmark"]],null,null,null,null,null)),(t()(),o.ub(14,0,[["checkboxLabel",1]],null,4,"span",[["class","mat-checkbox-label"]],null,[[null,"cdkObserveContent"]],function(t,e,i){var o=!0;return"cdkObserveContent"===e&&(o=!1!==t.component._onLabelTextChange()&&o),o},null,null)),o.tb(15,1196032,null,0,n.a,[n.b,o.k,o.A],null,{event:"cdkObserveContent"}),(t()(),o.ub(16,0,null,null,1,"span",[["style","display:none"]],null,null,null,null,null)),(t()(),o.Ob(-1,null,["\xa0"])),o.Fb(null,0)],function(t,e){var i=e.component,n=t(e,7,0,150);t(e,6,0,!0,20,n,i._isRippleDisabled(),o.Gb(e,2))},function(t,e){var i=e.component;t(e,2,0,i.inputId),t(e,3,0,!o.Gb(e,14).textContent||!o.Gb(e,14).textContent.trim()),t(e,4,1,[i.inputId,i.required,i.checked,i.value,i.disabled,i.name,i.tabIndex,i.indeterminate,i.ariaLabel||null,i.ariaLabelledby,i._getAriaChecked()]),t(e,5,0,o.Gb(e,6).unbounded)})}},fbMX:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var o=i("CcnG"),n=function(){function t(){}return t.prototype.set=function(t,e){localStorage.setItem(t,e)},t.prototype.get=function(t){return localStorage.getItem(t)},t.prototype.isExistKey=function(t){return!!localStorage.getItem(t)},t.prototype.clear=function(t){localStorage.removeItem(t)},t.ngInjectableDef=o.Ub({factory:function(){return new t},token:t,providedIn:"root"}),t}()},"nYx/":function(t,e,i){"use strict";i.d(e,"a",function(){return s});var o=i("zOUh"),n=i("+lji"),a=i("yFR0"),r=i("CcnG"),s=function(){function t(t,e,i){this.infoTokenService=t,this.crudService=e,this.socketService=i,this.infoToken=this.infoTokenService.getInfoUs()}return t.prototype.getSubtotales=function(){this.objTotales=JSON.parse(atob(localStorage.getItem("sys::st")))},t.prototype.registrarPago=function(t,e,i){var o=this;this.getSubtotales();var n={idcliente:this.infoToken.idcliente,idorg:this.infoToken.idorg,idsede:this.infoToken.idsede,mesa:this.infoToken.numMesaLector,importe:t},a={idcliente:n.idcliente,idorg:n.idorg,idsede:n.idsede,mesa:n.mesa,importe:n.importe,objSubTotal:this.objTotales,objTransaction:e,objCliente:i,objOperacion:n};this.crudService.postFree(a,"transaction","registrar-pago",!1).subscribe(function(t){o.setIdRegistroPagoTransaction(t.data[0].idregistro_pago),o.socketService.emit("notificar-pago-pwa",a)})},t.prototype.getIpClient=function(){var t="";return this.crudService.getFree("https://api.ipify.org?format=jsonp&callback=?").subscribe(function(e){t=e.ip}),t},t.prototype.getDataTrasaction=function(){return this.loadDataTransaction(),this.responseTransaction.isSuccess=!(this.responseTransaction&&!this.responseTransaction.error),this.responseTransaction},t.prototype.setIdRegistroPagoTransaction=function(t){this.loadDataTransaction(),this.responseTransaction.idregistro_pago=t,this.upDataTransaction()},t.prototype.loadDataTransaction=function(){this.responseTransaction=JSON.parse(localStorage.getItem("sys::transaction-response"))},t.prototype.upDataTransaction=function(){localStorage.setItem("sys::transaction-response",JSON.stringify(this.responseTransaction))},t.prototype.removeLocalDataTransaction=function(){localStorage.removeItem("sys::transaction-response"),this.responseTransaction=null},t.ngInjectableDef=r.Ub({factory:function(){return new t(r.Vb(o.a),r.Vb(n.a),r.Vb(a.a))},token:t,providedIn:"root"}),t}()},nx09:function(t,e,i){"use strict";var o=i("7RJT"),n=i("Te6q"),a=i("6NNB"),r=i("Ie24"),s=i("fbMX"),c=i("yFR0"),d=i("WF5t"),u=i("/sn2"),m=i("wne+"),l=i("eI2u"),p=function(){return function(){this.isTpcLocal=!1,this.isTpcSoloLLevar=!1,this.isTpcSoloDelivery=!1,this.isTpcSoloOther=!1,this.isRequiereMesa=!1}}(),h=function(){return function(){}}(),f=i("JOr0"),b=i("CcnG"),v=i("vARd");i.d(e,"a",function(){return g});var g=function(){function t(t,e,i,s,c,d,u,m){this.storageService=t,this.socketService=e,this.timerLimitService=i,this.navigatorService=s,this._snackBar=c,this.utilesService=d,this.listenStatusService=u,this.establecimientoService=m,this.miPedidoSource=new o.BehaviorSubject(new a.a),this.miPedidoObserver$=this.miPedidoSource.asObservable(),this.countItemsSource=new o.BehaviorSubject(0),this.countItemsObserve$=this.countItemsSource.asObservable(),this.itemStockChangeSource=new o.BehaviorSubject(new n.a),this.itemStockChangeObserve$=this.itemStockChangeSource.asObservable(),this.isPreAvisoVisible=!1,this.listItemsPedido=[],this.miPedido=new a.a,this.mpObjSeccionSelected=new r.a,this.time=new Date}return t.prototype.getObjCarta=function(){return this.objCarta},t.prototype.getObjCartaLibery=function(){return JSON.parse(JSON.stringify(this.objCarta))},t.prototype.setObjMiPedido=function(t){this.miPedido=t,this.miPedidoSource.next(this.miPedido)},t.prototype.resetObjMiPedido=function(){this.miPedido=new a.a,this.miPedidoSource.next(this.miPedido)},t.prototype.setObjCarta=function(t){this.objCarta={},this.objCarta={carta:null,bodega:null},this.objCarta.carta=t[0].carta,this.objCarta.bodega=t[0].bodega;var e=this.objCarta.bodega;e&&this.objCarta.carta.map(function(t){e.map(function(e){t.secciones.push(e)})}),console.log("objCartaCarta",this.objCarta)},t.prototype.getMiPedido=function(){return 0===this.miPedido.tipoconsumo.length&&this.storageService.isExistKey("sys::order::all")&&(this.miPedido=JSON.parse(atob(this.storageService.get("sys::order::all")))),this.miPedido},t.prototype.setobjItemTipoConsumoSelected=function(t){this.mpObjItemTipoConsumoSelected=t},t.prototype.setObjSeccionSeleced=function(t){this.mpObjSeccionSelected=new r.a,this.mpObjSeccionSelected.des=t.des,this.mpObjSeccionSelected.idimpresora=t.idimpresora,this.mpObjSeccionSelected.idseccion=t.idseccion,this.mpObjSeccionSelected.sec_orden=t.sec_orden,this.mpObjSeccionSelected.ver_stock_cero=t.ver_stock_cero},t.prototype.addItem2=function(t,e,i,o){void 0===i&&(i=0),void 0===o&&(o=null);var n=parseInt(e.cantidad.toString(),0),a=0===i;if(!(n<=0&&a)){var r=t.cantidad_seleccionada||0;if(!((r+=a?1:-1)<0)){"ND"!==e.isporcion&&(r=r<0?0:r,n=(n+=a?-1:1)<0||r<0?0:n),t.cantidad_seleccionada=r=r<0?0:r;var s=JSON.parse(JSON.stringify(t)),c=this.findItemMiPedido(s,this.mpObjSeccionSelected,e,a);c.cantidad=n,e=o?this.findItemCarta(e):e,(e=this.findItemCarta(e)).sumar=a,e.subitems_selected=c.subitems_selected,e.subitems_view=c.subitems_view;var d=this.findItemListPedido(e),u=1;d?(d.itemtiposconsumo||(d.itemtiposconsumo=this.mpObjItemTipoConsumoSelected),u=this.totalItemTpcSelected(d.itemtiposconsumo)||0,d.cantidad_seleccionada=u,d.subitems_selected=c.subitems_selected,d.subitems_view=c.subitems_view):this.listItemsPedido.push(e),e.cantidad_seleccionada=u,this.itemStockChangeSource.next(e),this.setLocalStorageHora(),this.setLocalStoragePedido(),this.socketService.emit("itemModificado",e),console.log("listItemsPedido",this.listItemsPedido),console.log("itemModificado en add",e),console.log("itemModificado en add",JSON.stringify(e)),this.listenStatusService.setHayPedidoPendiente(!0),this.playTimerLimit()}}},t.prototype.totalItemTpcSelected=function(t){return t.map(function(t){return t.cantidad_seleccionada||0}).reduce(function(t,e){return t+e},0)},t.prototype.addCantItemMiPedido=function(t,e){var i=e,o=i*parseFloat(t.precio_unitario);t.subitems_selected&&t.subitems_selected.map(function(t){return t.precio*t.cantidad_seleccionada}).reduce(function(t,e){return t+e},0),t.cantidad_seleccionada=i,t.precio_total=o,t.precio_print=o},t.prototype.addPrecioItemMiPedido=function(t){var e=t.subitems_view?t.subitems_view.map(function(t){return t.precio}).reduce(function(t,e){return t+e},0):0,i=t.cantidad_seleccionada*parseFloat(t.precio_unitario);t.precio_total=i+=e,t.precio_print=i},t.prototype.addItemSubItemMiPedido=function(t,e,i){var o=this;if(t.subitems){if(0===t.subitems.length)return;var n=new h;if(n.id="",n.des="",n.listDes=[],n.cantidad_seleccionada=0,n.precio=0,n.indicaciones="",n.subitems=[],t.subitems_selected&&t.subitems_selected.length>0){t.subitems_selected.map(function(t){n.id+=t.iditem_subitem.toString(),n.listDes.push(o.utilesService.primeraConMayusculas(t.des.toLowerCase())),n.cantidad_seleccionada=1,n.precio+=parseFloat(t.precio.toString()),n.subitems.push(t)}),n.des=n.listDes.join(", "),n.des+=void 0===t.indicaciones||""===t.indicaciones?"":", ("+t.indicaciones+")",t.indicaciones="",t.subitems_view=t.subitems_view?t.subitems_view:[];var a=t.subitems_view.filter(function(t){return t.id===n.id})[0];a?i?(a.indicaciones+=n.indicaciones,a.cantidad_seleccionada+=1,a.precio+=n.precio):this.restarCantSubItemView(t,a):i?t.subitems_view.push(n):this.restarCantSubItemView(t,null),this.addPrecioItemMiPedido(t)}}},t.prototype.restarCantSubItemView=function(t,e){if(void 0===e&&(e=null),e){var i=e.precio/e.cantidad_seleccionada;e.cantidad_seleccionada-=1,e.precio-=i,e.precio=e.precio<0?0:e.precio,e.cantidad_seleccionada<=0&&(t.subitems_view=t.subitems_view.filter(function(t){return t.cantidad_seleccionada>0}))}else{var o=t.subitems_view[t.subitems_view.length-1];i=o.precio/o.cantidad_seleccionada,o.cantidad_seleccionada--,o.precio-=i,o.cantidad_seleccionada<=0&&(t.subitems_view=t.subitems_view.filter(function(t){return t.cantidad_seleccionada>0})),t.subitems_selected=o.subitems}},t.prototype.addItemInCarta=function(t){var e=this.findItemCarta(t);e?(console.log("update"),e.cantidad=e.cantidad):(console.log("add in carta"),this.objCarta.carta.map(function(e){e.secciones.filter(function(e){return e.idseccion===t.idseccion}).map(function(e){e.items.push(t)})})),console.log("item new add in carta",this.objCarta.carta)},t.prototype.findItemFromArr=function(t,e){return t.filter(function(t){return t.iditem===e.iditem})[0]},t.prototype.findItemListPedido=function(t){return this.listItemsPedido.filter(function(e){return e.iditem===t.iditem})[0]},t.prototype.findItemCartaAndClearIndicaciones=function(){this.objCarta.carta.map(function(t){t.secciones.map(function(t){t.items.filter(function(t){return t.indicaciones}).map(function(t){return t.indicaciones=""}),t.items.filter(function(t){return t.subitems_selected}).map(function(t){return t.subitems_selected=null}),t.items.filter(function(t){return t.subitems_view}).map(function(t){return t.subitems_view=null})})})},t.prototype.findItemCarta=function(t){var e;return this.objCarta.carta.map(function(i){i.secciones.map(function(i){var o=i.items.filter(function(e){return e.idcarta_lista===t.idcarta_lista})[0];if(o)return e=o})}),e},t.prototype.findItemCartaByIdCartaLista=function(t){var e;return this.objCarta.carta.map(function(i){i.secciones.map(function(i){var o=i.items.filter(function(e){return e.idcarta_lista.toString()===t.toString()})[0];if(o)return e=o})}),e},t.prototype.findSubItemCartaById=function(t,e){var i=[];return this.objCarta.carta.map(function(o){o.secciones.map(function(o){o.items.filter(function(t){return t.iditem.toString()!==e}).filter(function(t){return t.subitems}).map(function(e){e.subitems.map(function(e){var o=e.opciones.filter(function(e){return e.idproducto.toString()+e.idporcion.toString()===t})[0];o&&i.push(o)})})})}),i},t.prototype.resetCantidadesTpcItemCarta=function(){this.objCarta&&this.objCarta.carta.map(function(t){t.secciones.map(function(t){t.items.map(function(t){t.indicaciones="",t.cantidad_seleccionada=0,t.itemtiposconsumo=null})})})},t.prototype.findItemSeccionCarta=function(t){var e;return this.objCarta.carta.map(function(i){var o=i.secciones.filter(function(e){return e.idseccion===t})[0];o&&(e=o)}),e},t.prototype.findOnlyItemMiPedido=function(t){var e;return this.miPedido.tipoconsumo.map(function(i){i.secciones.map(function(i){e=i.items.filter(function(e){return e.idcarta_lista===t.idcarta_lista})[0]})}),e},t.prototype.findItemMiPedido=function(t,e,i,o){var n,a=JSON.parse(JSON.stringify(i)),r=t.cantidad_seleccionada;a.itemtiposconsumo=[],this.addCantItemMiPedido(a,r);var s=this.miPedido.tipoconsumo.filter(function(e){return e.idtipo_consumo===t.idtipo_consumo})[0];if(s){var c=s.secciones.filter(function(t){return t.idseccion===e.idseccion})[0];if(c){var d=c.items.filter(function(t){return t.idcarta_lista===i.idcarta_lista})[0];d?(d.indicaciones=a.indicaciones,this.addCantItemMiPedido(d,r),n=a=d):(c.items.push(a),n=a),a.subitems=i.subitems,a.subitems_selected=i.subitems_selected,this.addItemSubItemMiPedido(a,i,o),this.setCountCantItemTpcAndSeccion(s,c)}else n=a,(u=JSON.parse(JSON.stringify(e))).items=[],u.items.push(a),s.secciones=s.secciones?s.secciones:[],s.secciones.push(u),this.addItemSubItemMiPedido(a,i,o),this.setCountCantItemTpcAndSeccion(s,u)}else{var u;a.subitems=i.subitems,a.subitems_selected=i.subitems_selected,this.addItemSubItemMiPedido(a,i,o),(u=JSON.parse(JSON.stringify(e))).items=[],u.items.push(a),t.secciones=t.secciones?t.secciones:[],t.secciones.push(u),this.miPedido.tipoconsumo.push(t),this.setCountCantItemTpcAndSeccion(t,u),n=a}return this.clearObjMiPedido(),n},t.prototype.quitarTpcMiPedido=function(t){1===t.count_items_seccion&&(this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.filter(function(e){return!t}))},t.prototype.quitarSeccionMiPedido=function(t){1===t.count_items&&this.miPedido.tipoconsumo.map(function(e){e.secciones.filter(function(e){return!t})})},t.prototype.findMiPedidoIsTPCLocal=function(){var t=!1;return this.miPedido.tipoconsumo.filter(function(t){return"LOCAL"===t.titulo}).map(function(e){t=!!e.secciones.filter(function(t){return t.count_items>0})[0]}),t},t.prototype.findMiPedidoIsTPCDelivery=function(){var t=!1;return this.miPedido.tipoconsumo.filter(function(t){return"DELIVERY"===t.descripcion.toUpperCase()}).map(function(e){t=!!e.secciones.filter(function(t){return t.count_items>0})[0]}),t},t.prototype.findMiPedidoIsTPCLLevar=function(){var t=!1;return this.miPedido.tipoconsumo.filter(function(t){return t.descripcion.toUpperCase().indexOf("LLEVAR")}).map(function(e){t=!!e.secciones.filter(function(t){return t.count_items>0})[0]}),t},t.prototype.findEvaluateTPCMiPedido=function(){var t=new p,e=0;return this.miPedido.tipoconsumo.filter(function(t){return t.count_items_seccion>0}).map(function(i){"LOCAL"===i.titulo&&(t.isTpcLocal=!0,e++),i.descripcion.toUpperCase().indexOf("LLEVAR")>-1&&(t.isTpcSoloLLevar=!0,e++),i.descripcion.toUpperCase().indexOf("DELIVERY")>-1&&(t.isTpcSoloDelivery=!0),t.isRequiereMesa=!!t.isTpcLocal,t.isTpcSoloLLevar=!(1!==e||!t.isTpcSoloLLevar)}),t},t.prototype.findSeccionInMipedidoByPrint=function(t){var e;return this.miPedido.tipoconsumo.map(function(i){e=i.secciones.filter(function(e){return e.idimpresora===t})}),e},t.prototype.findIsHayItems=function(){return this.setCountTotalImtesPedido()>0},t.prototype.clearObjMiPedido=function(){if(this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.filter(function(t){return t.count_items_seccion>0}),0===this.miPedido.tipoconsumo.length)return this.miPedido=new a.a,console.log("mi pedido clear",this.miPedido),void this.miPedidoSource.next(this.miPedido);this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.map(function(t){return t.secciones=t.secciones.filter(function(t){return t.count_items>0}),t}),this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.map(function(t){return t.secciones=t.secciones.map(function(t){return t.items=t.items.filter(function(t){return t.cantidad_seleccionada>0}),t}),t}),console.log("mi pedido clear",this.miPedido),this.miPedidoSource.next(this.miPedido)},t.prototype.setCountCantItemTpcAndSeccion=function(t,e){var i=e.items.map(function(t){return t.cantidad_seleccionada}).reduce(function(t,e){return t+e},0);e.count_items=i;var o=t.secciones.map(function(t){return t.count_items}).reduce(function(t,e){return t+e},0);t.count_items_seccion=o,this.setCountTotalImtesPedido()},t.prototype.setCountTotalImtesPedido=function(){var t=this.miPedido.tipoconsumo.map(function(t){return t.count_items_seccion}).reduce(function(t,e){return t+e},0);return this.countItemsSource.next(t),t},t.prototype.setLocalStorageHora=function(){if(!this.storageService.isExistKey("sys::h")){var t=this.time.getHours()+":"+this.time.getMinutes()+":"+this.time.getSeconds();this.storageService.set("sys::h",t.toString())}},t.prototype.setLocalStoragePedido=function(){this.storageService.set("sys::order",btoa(JSON.stringify(this.listItemsPedido))),this.storageService.set("sys::order::all",btoa(JSON.stringify(this.miPedido)))},t.prototype.clearPedidoIsLimitTime=function(){this.storageService.isExistKey("sys::order")&&(this.listItemsPedido=JSON.parse(atob(this.storageService.get("sys::order"))),this.miPedido=JSON.parse(atob(this.storageService.get("sys::order::all"))))},t.prototype.resetAllNewPedido=function(){this.socketService.emit("resetPedido",this.listItemsPedido),this.prepareNewPedido()},t.prototype.prepareNewPedido=function(){this.resetTpcCarta(),this.storageService.clear("sys::h"),this.storageService.clear("sys::order"),this.storageService.clear("sys::order::all"),this.storageService.clear("sys::tcount"),this.storageService.clear("sys::tnum"),this.miPedido=null,this.miPedido=new a.a,this.miPedidoSource.next(this.miPedido),this.countItemsSource.next(0),this.listenStatusService.setHayPedidoPendiente(!1),this.stopTimerLimit()},t.prototype.getOnlyCarta=function(){this.socketService.emit("getOnlyCarta",null)},t.prototype.resetTpcCarta=function(){var t=this;try{this.listItemsPedido.map(function(e){if(e.indicaciones="",e.itemtiposconsumo){e.itemtiposconsumo=null;var i=t.findItemCarta(e);i.indicaciones="",i.cantidad_seleccionada=0,i.itemtiposconsumo=null}})}catch(e){console.log(e)}this.resetCantidadesTpcItemCarta(),this.listItemsPedido=[]},t.prototype.updatePedidoFromStrorage=function(){var t=this;this.listenStatusService.setHayPedidoPendiente(!1),this.storageService.isExistKey("sys::order")&&(this.listenStatusService.setHayPedidoPendiente(!0),this.listItemsPedido=JSON.parse(atob(this.storageService.get("sys::order"))),this.miPedido=JSON.parse(atob(this.storageService.get("sys::order::all"))),this.setCountTotalImtesPedido(),this.miPedidoSource.next(this.miPedido),this.listItemsPedido.map(function(e){0===e.isalmacen&&t.objCarta.carta.map(function(t){t.secciones.map(function(t){var i=t.items.filter(function(t){return t.idcarta_lista===e.idcarta_lista})[0];i&&(i.cantidad_seleccionada=e.cantidad_seleccionada,i.itemtiposconsumo=e.itemtiposconsumo)})})}))},t.prototype.updatePedidoFromClear=function(){var t=this;this.listItemsPedido&&(this.listItemsPedido.map(function(e){0===e.isalmacen&&t.objCarta.carta.map(function(t){t.secciones.map(function(t){var i=t.items.filter(function(t){return"ND"!==t.isporcion&&t.idcarta_lista===e.idcarta_lista})[0];i&&(i.cantidad=parseInt(i.cantidad.toString(),0)+e.cantidad_seleccionada)})})}),this.prepareNewPedido())},t.prototype.getEstadoStockItem=function(t){return t>10?"verde":t>5?"amarillo":"rojo"},t.prototype.validarReglasCarta=function(t){var e=this,i=0,o=0,n=0,a=0,r=0,s=0;this.miPedido.tipoconsumo.map(function(t){t.secciones.map(function(t){t.items.map(function(t){return t.precio_total_calc=null})})}),t.map(function(t){i=t.idseccion_detalle,o=e.countCantItemsFromSeccion(t.idseccion),n=e.countCantItemsFromSeccion(i),a=(a=o-n)<0?o:a,e.miPedido.tipoconsumo.map(function(t){t.secciones.filter(function(t){return t.idseccion.toString()===i.toString()}).map(function(t){t.items.map(function(t,e){var i=parseFloat(t.precio),c=t.cantidad_seleccionada;r=s=null!==t.precio_total_calc?t.precio_total_calc:t.precio_total,o>=n?r=0:a>0&&(r=(r=s-(r=a*i))<0?0:r,a=a-c<0?0:a-c),t.precio_total_calc=parseFloat(r.toString()),t.precio_print=parseFloat(r.toString()),t.cantidad_descontado=c})})})})},t.prototype.countCantItemsFromSeccion=function(t){var e=0;return this.miPedido.tipoconsumo.map(function(i){i.secciones.map(function(i){e+=i.items.filter(function(e){return e.idseccion.toString()===t.toString()}).map(function(t){return t.cantidad_seleccionada}).reduce(function(t,e){return t+e},0)})}),e},t.prototype.countCantItemsFromTpcSeccion=function(t,e){var i=0;return this.miPedido.tipoconsumo.filter(function(e){return e.idtipo_consumo.toString()===t.toString()}).map(function(t){t.secciones.map(function(t){i+=t.items.filter(function(t){return t.idseccion.toString()===e.toString()}).map(function(t){return t.cantidad_seleccionada}).reduce(function(t,e){return t+e},0)})}),i},t.prototype.getArrSubTotales=function(t){var e=this,i=this.getSubTotalMiPedido(),o=i,n=[],a={id:0,descripcion:"SUB TOTAL",esImpuesto:0,visible:!0,quitar:!1,tachado:!1,visible_cpe:!0};a.importe=parseFloat(i.toString()).toFixed(2),n.push(a);var r=[];t.filter(function(t){return"p"===t.tipo}).map(function(t){var e=t.monto/100,n=1===t.es_impuesto,a=0===t.activo,s=(i*e).toFixed(2),c={};c.id=t.tipo+t.id,c.descripcion=t.descripcion,c.esImpuesto=t.es_impuesto,c.visible=!0,c.quitar=!1,c.tachado=!1,c.visible_cpe=n,"I.G.V"===c.descripcion?c.importe=a?e:0:(c.importe=n?a?s:0:s,c.importe=parseFloat(c.importe.toString()).toFixed(2),o+=parseFloat(c.importe)),0!==c.importe&&r.push(c)});var s=0,c=[],d=t.filter(function(t){return"a"===t.tipo}),u=!!this.establecimientoService.get().idsede,m=!1;if(d.map(function(t){var i={};if(t.descripcion.toUpperCase().indexOf("DELIVERY")>-1&&u?(m=!0,t.descripcion="Entrega",s=e.establecimientoService.get().c_servicio):s=parseFloat(t.monto),0===t.nivel){var n=e.countCantItemsFromTpcSeccion(t.idtipo_consumo,t.idseccion);if(0===n)return;s=n*parseFloat(t.monto)}i.id=t.tipo+t.id,i.descripcion=t.descripcion,i.esImpuesto=t.es_impuesto,i.visible=!0,i.quitar=!0,i.tachado=!1,i.visible_cpe=!1,i.importe=parseFloat(s.toString()).toFixed(2),o+=parseFloat(i.importe);var a=c.filter(function(t){return t.descripcion===i.descripcion})[0];a?a.importe+=parseFloat(i.importe):c.push(i)}),!m&&u){var l={id:-2,descripcion:"Entrega",esImpuesto:0,visible:!0,quitar:!1,tachado:!1,visible_cpe:!1};l.importe=parseFloat(this.establecimientoService.get().c_servicio.toString()).toFixed(2),o+=parseFloat(l.importe),c.push(l)}r.map(function(t){return n.push(t)}),c.map(function(t){return n.push(t)});var p=n.filter(function(t){return"SUB TOTAL"===t.descripcion})[0],h=n.filter(function(t){return"I.G.V"===t.descripcion})[0],f=h?h.importe:0,b=p?p.importe:0;return f>0&&(b-=f=parseFloat((b*f).toString()).toFixed(2),h.importe=f,p.importe=b.toFixed(2)),(a={}).id=0,a.esImpuesto=0,a.descripcion="TOTAL",a.visible=!0,a.quitar=!1,a.tachado=!1,a.visible_cpe=!0,a.importe=parseFloat(o.toString()).toFixed(2),n.push(a),console.log("totales",n),n},t.prototype.getSubTotalMiPedido=function(){var t=0;return this.miPedido.tipoconsumo.map(function(e){e.secciones.map(function(e){t+=e.items.map(function(t){return t.precio_print}).reduce(function(t,e){return t+e},0)})}),t},t.prototype.getImporteTotalItemFromMiPedido=function(t){var e=0;return this.miPedido.tipoconsumo.map(function(i){i.secciones.map(function(i){e+=i.items.filter(function(e){return e.iditem===t.iditem}).map(function(t){return t.precio_print}).reduce(function(t,e){return t+e},0)})}),e},t.prototype.playTimerLimit=function(){this.timerLimitService.playCountTimerLimit()},t.prototype.stopTimerLimit=function(){this.timerLimitService.resetCountTimerLimit()},t.prototype.restoreTimerLimit=function(){this.timerLimitService.resetCountTimerLimit()},t.prototype.listenChangeCantItem=function(){var t=this;this.socketService.onItemModificado().subscribe(function(e){var i;null!=e.listItemPorcion?e.listItemPorcion.map(function(o){i=t.findItemCartaByIdCartaLista(o.idcarta_lista);var n=parseInt(o.cantidad,0);i.cantidad=n||parseInt(e.item.cantidad.toString(),0),t.setCantidadItemModificadoPwa(e.item,i,parseInt(o.cantidad,0),!0)}):(i=t.findItemCarta(e=e.item),t.setCantidadItemModificadoPwa(e,i)),console.log("socket list",t.listItemsPedido)}),this.socketService.onItemResetCant().subscribe(function(e){var i;null!=e.listItemPorcion?e.listItemPorcion.map(function(o){(i=t.findItemCartaByIdCartaLista(o.idcarta_lista)).cantidad=parseInt(o.cantidad,0),t.setCantidadItemModificadoPwa(e.item,i,parseInt(o.cantidad,0),!0),t.itemStockChangeSource.next(i)}):((i=t.findItemCarta(e=e.item)).cantidad=parseInt(e.cantidad.toString(),0),i.subitems=e.subitems,t.itemStockChangeSource.next(i))}),this.socketService.onNuevoItemAddInCarta().subscribe(function(e){console.log("onNuevoItemAddInCarta",e),t.addItemInCarta(e)}),this.socketService.onGetDatosSede().subscribe(function(e){t.objDatosSede=e[0],t.listenStatusService.setHayDatosSede(!0),localStorage.setItem("sys::s",t.objDatosSede.datossede[0].nombre+"|"+t.objDatosSede.datossede[0].ciudad),console.log("datos de la sede ps",t.objDatosSede),t.max_minute_order=e[0].datossede[0].pwa_time_limit,t.timerLimitService.maxTime=100*t.max_minute_order}),this.timerLimitService.countdown$.subscribe(function(e){switch(e){case 1:t.isPreAvisoVisible=!1;break;case 80:t.isPreAvisoVisible||(t.isPreAvisoVisible=!0,t._snackBar.open("Proximo a cumplir el tiempo de envio.","",{duration:2e3}));break;case 100:t._snackBar.open("Tiempo agotado, debe realizar un nuevo pedido.","",{duration:3e3})}}),this.timerLimitService.isTimeLimitComplet$.subscribe(function(e){!0===e&&(t.resetAllNewPedido(),t.navigatorService.setPageActive("carta"))})},t.prototype.setCantidadItemModificadoPwa=function(t,e,i,o){var n=this;void 0===i&&(i=null),void 0===o&&(o=!1),t.subitems&&t.idcarta_lista===e.idcarta_lista&&t.subitems.map(function(i){i.opciones.map(function(i){e.subitems.map(function(e){var o=e.opciones.filter(function(t){return t.iditem_subitem===parseInt(i.iditem_subitem.toString(),0)})[0];if(o&&"ND"!==o.cantidad){o.cantidad=i.cantidad;var a=o.idproducto.toString()+o.idporcion.toString();n.findSubItemCartaById(a,t.iditem.toString()).map(function(t){t.cantidad=i.cantidad})}})})}),o||(e.cantidad=i||parseInt(t.cantidad.toString(),0)),this.itemStockChangeSource.next(e)},t.prototype.cerrarSession=function(){this.socketService.closeConnection(),this.navigatorService.cerrarSession()},t.ngInjectableDef=b.Ub({factory:function(){return new t(b.Vb(s.a),b.Vb(c.a),b.Vb(d.a),b.Vb(u.a),b.Vb(v.b),b.Vb(m.a),b.Vb(l.a),b.Vb(f.a))},token:t,providedIn:"root"}),t}()},qTE5:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var o=function(){return function(){}}()},"wne+":function(t,e,i){"use strict";i.d(e,"a",function(){return n});var o=i("CcnG"),n=function(){function t(){}return t.prototype.primeraConMayusculas=function(t){return(t=t.toLowerCase()).charAt(0).toUpperCase()+t.slice(1)},t.prototype.reformatDate=function(t){var e=t.split("-");return e[2]+"/"+e[1]+"/"+e[0]},t.ngInjectableDef=o.Ub({factory:function(){return new t},token:t,providedIn:"root"}),t}()}}]);