(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"/sn2":function(t,e,i){"use strict";var o=i("ZYCi"),n=i("VnD/"),r=i("mrSG"),s=i("FFOo"),a=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?u:c}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),c=function(t){function e(e,i){var o=t.call(this,e)||this;return o.bufferSize=i,o.buffer=[],o}return r.__extends(e,t),e.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},e.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),t.prototype._complete.call(this)},e}(s.a),u=function(t){function e(e,i,o){var n=t.call(this,e)||this;return n.bufferSize=i,n.startBufferEvery=o,n.buffers=[],n.count=0,n}return r.__extends(e,t),e.prototype._next=function(t){var e=this.bufferSize,i=this.startBufferEvery,o=this.buffers,n=this.count;this.count++,n%i==0&&o.push([]);for(var r=o.length;r--;){var s=o[r];s.push(t),s.length===e&&(o.splice(r,1),this.destination.next(s))}},e.prototype._complete=function(){for(var e=this.buffers,i=this.destination;e.length>0;){var o=e.shift();o.length>0&&i.next(o)}t.prototype._complete.call(this)},e}(s.a),d=i("7RJT"),m=i("zOUh"),l=i("eI2u"),p=i("CcnG");i.d(e,"a",function(){return f});var f=function(){function t(t,e,i){this.router=t,this.infoTokenService=e,this.listenService=i,this.disabledBack=!1,this.resNavigatorSource=new d.BehaviorSubject([]),this.resNavigatorSourceObserve$=this.resNavigatorSource.asObservable(),this.pageActive="carta",this.resNavigator=[],this.historyNavigator=[],this.lastUrlHistory="",this.listenEventNavigator()}return t.prototype.listenEventNavigator=function(){var t,e=this;this.router.events.pipe(Object(n.a)(function(t){return t instanceof o.d}),(t=1,void 0===t&&(t=null),function(e){return e.lift(new a(2,t))})).subscribe(function(t){if(null!=t&&"popstate"===t[1].navigationTrigger){if(e.disabledBack)return!1;var i=t[0].url.indexOf(";")?t[0].url.substr(1).split(";")[1].split("=")[1]:t[0].url;i.length>0&&(e.lastUrlHistory=i,e.managerGoBack(i,""))}})},t.prototype.setPageActive=function(t){this.pageActive=t,this.lastUrlHistory="carta"!==t?t:this.lastUrlHistory;var e=this.findPageActiveInHistory(t);this.addLink(e?e.url:t),this.resNavigator.pageActive=t,this.resNavigator.url=e?e.url:t,this.resNavigatorSource.next(this.resNavigator)},t.prototype.saveHistoryPageActive=function(t,e){this.historyNavigator[t]=[],this.historyNavigator[t].key=t,this.historyNavigator[t].url=e},t.prototype.findPageActiveInHistory=function(t){return Object.values(this.historyNavigator).filter(function(e){return e.key===t})[0]},t.prototype.addLink=function(t){this.router.navigate([".",{state:t}]),this.saveHistoryPageActive(this.pageActive,t)},t.prototype.cerrarSession=function(t){void 0===t&&(t=!1),this.infoTokenService.isDelivery()?this.router.navigate(["../zona-delivery"]):this.router.navigate(["../"]).then(function(){t&&window.location.reload()})},t.prototype.managerGoBack=function(t,e){var i="";switch(console.log("managerGoBack",t),t){case"carta-i-secciones-items":i="carta",this.addLink("carta-i-secciones");break;case"carta-i-secciones":i="carta",this.addLink("carta-i-");break;case"carta-i-":i="carta-o-",this.addLink("carta-o-"),console.log("=========================== listo para salir"),this.listoParaSalir();break;case"mipedido-confirma":i="mipedido",this.addLink("mipedido");break;case"mipedido":i="carta",this.addLink("carta"),this.listoParaSalir();break;case"estado":case"carta":i="carta";break;case"lanzar-encuesta":i="lanzar-encuesta"}""!==i&&(this.pageActive=i,this.setPageActive(i))},t.prototype._router=function(t){this.router.navigate([t])},t.prototype.disableGoBack=function(){this.disabledBack=!0,history.pushState(null,null,location.href),window.onpopstate=function(){history.go(1)}},t.prototype.listoParaSalir=function(){this.infoTokenService.isDelivery()&&this.listenService.setIsOutEstablecimientoDelivery(!0)},t.ngInjectableDef=p.Ub({factory:function(){return new t(p.Vb(o.l),p.Vb(m.a),p.Vb(l.a))},token:t,providedIn:"root"}),t}()},"6NNB":function(t,e,i){"use strict";i.d(e,"a",function(){return o});var o=function(){return function(){this.tipoconsumo=[]}}()},Ie24:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var o=function(){return function(){this.items=[]}}()},JOr0:function(t,e,i){"use strict";i.d(e,"a",function(){return r});var o=i("qTE5"),n=i("CcnG"),r=function(){function t(){this.keyStorage="sys::ed"}return t.prototype.set=function(t){localStorage.setItem(this.keyStorage,btoa(JSON.stringify(t)))},t.prototype.get=function(){var t=new o.a,e=localStorage.getItem(this.keyStorage);return e?JSON.parse(atob(e)):t},t.ngInjectableDef=n.Ub({factory:function(){return new t},token:t,providedIn:"root"}),t}()},MBfO:function(t,e,i){"use strict";i.d(e,"a",function(){return r}),i.d(e,"b",function(){return s});var o=i("CcnG"),n=(i("Z+uX"),i("Ip0R")),r=(i("Fzqc"),i("Wf4p"),i("ZYjt"),i("wFw1"),o.sb({encapsulation:2,styles:[".mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-background{display:none}}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}@media (-ms-high-contrast:active){.mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:'';display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2s infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2s infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2s infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2s infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after{animation:none;transition:none}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(.5,0,.70173,.49582);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(.30244,.38135,.55,.95635);transform:translateX(83.67142%)}100%{transform:translateX(200.61106%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(.08)}36.65%{animation-timing-function:cubic-bezier(.33473,.12482,.78584,1);transform:scaleX(.08)}69.15%{animation-timing-function:cubic-bezier(.06,.11,.6,1);transform:scaleX(.66148)}100%{transform:scaleX(.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(.15,0,.51506,.40969);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(.31033,.28406,.8,.73371);transform:translateX(37.65191%)}48.35%{animation-timing-function:cubic-bezier(.4,.62704,.6,.90203);transform:translateX(84.38617%)}100%{transform:translateX(160.27778%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(.15,0,.51506,.40969);transform:scaleX(.08)}19.15%{animation-timing-function:cubic-bezier(.31033,.28406,.8,.73371);transform:scaleX(.4571)}44.15%{animation-timing-function:cubic-bezier(.4,.62704,.6,.90203);transform:scaleX(.72796)}100%{transform:scaleX(.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}"],data:{}}));function s(t){return o.Qb(2,[o.Mb(671088640,1,{_primaryValueBar:0}),(t()(),o.ub(1,0,null,null,4,":svg:svg",[["class","mat-progress-bar-background mat-progress-bar-element"],["focusable","false"],["height","4"],["width","100%"]],null,null,null,null,null)),(t()(),o.ub(2,0,null,null,2,":svg:defs",[],null,null,null,null,null)),(t()(),o.ub(3,0,null,null,1,":svg:pattern",[["height","4"],["patternUnits","userSpaceOnUse"],["width","8"],["x","4"],["y","0"]],[[8,"id",0]],null,null,null,null)),(t()(),o.ub(4,0,null,null,0,":svg:circle",[["cx","2"],["cy","2"],["r","2"]],null,null,null,null,null)),(t()(),o.ub(5,0,null,null,0,":svg:rect",[["height","100%"],["width","100%"]],[[1,"fill",0]],null,null,null,null)),(t()(),o.ub(6,0,null,null,2,"div",[["class","mat-progress-bar-buffer mat-progress-bar-element"]],null,null,null,null,null)),o.Lb(512,null,n.B,n.C,[o.k,o.u,o.F]),o.tb(8,278528,null,0,n.q,[n.B],{ngStyle:[0,"ngStyle"]},null),(t()(),o.ub(9,0,[[1,0],["primaryValueBar",1]],null,2,"div",[["class","mat-progress-bar-primary mat-progress-bar-fill mat-progress-bar-element"]],null,null,null,null,null)),o.Lb(512,null,n.B,n.C,[o.k,o.u,o.F]),o.tb(11,278528,null,0,n.q,[n.B],{ngStyle:[0,"ngStyle"]},null),(t()(),o.ub(12,0,null,null,0,"div",[["class","mat-progress-bar-secondary mat-progress-bar-fill mat-progress-bar-element"]],null,null,null,null,null))],function(t,e){var i=e.component;t(e,8,0,i._bufferTransform()),t(e,11,0,i._primaryTransform())},function(t,e){var i=e.component;t(e,3,0,i.progressbarId),t(e,5,0,i._rectangleFillValue)})}},OzqD:function(t,e,i){"use strict";i.d(e,"a",function(){return u});var o=i("A8zI"),n=i("eI2u"),r=i("+lji"),s=i("zOUh"),a=i("7RJT"),c=i("CcnG"),u=function(){function t(t,e,i){this.listenStatusService=t,this.crudService=e,this.infoTokenService=i,this.estadoPedido=new o.a,this.keyStorage="sys::status",this.timeInterval=null,this.timeNow=new Date,this.hayPedidoPendiente=!1,this.timeRestanteAproxSource=new a.BehaviorSubject(0),this.timeRestanteAprox$=this.timeRestanteAproxSource.asObservable(),this.hayCuentaClienteSource=new a.BehaviorSubject(null),this.hayCuentaCliente$=this.hayCuentaClienteSource.asObservable(),this.deserializar(),this.dataPost={idsede:this.infoTokenService.getInfoUs().idsede,idcliente:this.infoTokenService.getInfoUs().idcliente}}return t.prototype.deserializar=function(){var t=localStorage.getItem(this.keyStorage);this.estadoPedido=(t="{}"===t?null:t)?JSON.parse(t):new o.a},t.prototype.get=function(){this.deserializar(),this.getCuentaTotales()},t.prototype.getCuentaTotales=function(){var t=this,e=0;return this.crudService.postFree(this.dataPost,"pedido","lacuenta-cliente-totales",!1).subscribe(function(i){0!==i.data.length?(t.setImporte(e=i.data[0].importe||0),t.estadoPedido.hayPedidoCliente=!0,t.calcTimeAprox(),console.log("cuenta cliente totales",i),t.notifyChange()):t.estadoPedido.hayPedidoCliente=!1}),e},t.prototype.getCuenta=function(){var t=this;this.crudService.postFree(this.dataPost,"pedido","lacuenta-cliente",!1).subscribe(function(e){if(0!==e.data.length)return t.estadoPedido.hayPedidoCliente=!0,t.calcTimeAprox(),console.log("cuenta cliente",e),t.hayCuentaClienteSource.next(e),t.notifyChange(),e;t.estadoPedido.hayPedidoCliente=!1})},t.prototype.getImporteCuenta=function(){var t=this;return new Promise(function(e){t.crudService.postFree(t.dataPost,"pedido","lacuenta-cliente-totales",!1).subscribe(function(t){e(t.success?t.data[0].importe:0)})})},t.prototype.getObj=function(){return this.estadoPedido||this.deserializar(),this.estadoPedido},t.prototype.setEstado=function(t){this.deserializar(),this.estadoPedido.estado=t,this.notifyChange()},t.prototype.setImporte=function(t){this.deserializar(),this.estadoPedido.importe=t,this.notifyChange()},t.prototype.setHoraInitPedido=function(t){this.deserializar(),this.estadoPedido.horaInt=t,this.notifyChange()},t.prototype.setTimeAprox=function(t){this.deserializar(),this.estadoPedido.isTiempoAproxCumplido=t,this.notifyChange()},t.prototype.setHayPedidoPendiente=function(t){this.deserializar(),this.estadoPedido.hayPedidoClientePendiente=t,this.notifyChange()},t.prototype.setisPagada=function(t){this.deserializar(),this.estadoPedido.isPagada=t,this.notifyChange()},t.prototype.setisRegisterPago=function(t){this.deserializar(),this.estadoPedido.isRegisterOnePago=t,this.notifyChange()},t.prototype.calcTimeAprox=function(){var t=this;this.crudService.postFree(this.dataPost,"pedido","calc-time-despacho",!1).subscribe(function(e){t.estadoPedido.estado=0,t.estadoPedido.numMinAprox=e.data[0].rpt,t.estadoPedido.isTiempoAproxCumplido=!1,t.notifyChange(),console.log("this.estadoPedido",t.estadoPedido),t.getTimeAprox()})},t.prototype.getTimeAprox=function(){var t=this;return 0===this.estadoPedido.estado?this.timeInterval=setTimeout(function(){var e=t.calTimeMin();e<=0?(t.estadoPedido.estado=1,t.notifyChange(),t.clearTimeout(),clearTimeout(t.timeInterval),e=0):t.getTimeAprox(),t.timeRestanteAproxSource.next(e)},2e3):this.clearTimeout(),0},t.prototype.calTimeMin=function(){var t=(new Date).getTime()-this.estadoPedido.horaInt;return t=Math.round(t%864e5%36e5/6e4),t=this.estadoPedido.numMinAprox-t,isNaN(t)?0:t},t.prototype.clearTimeout=function(){clearTimeout(this.timeInterval),this.timeInterval=null},t.prototype.notifyChange=function(){this.listenStatusService.setEstadoPedido(this.estadoPedido),localStorage.setItem(this.keyStorage,JSON.stringify(this.estadoPedido))},t.ngInjectableDef=c.Ub({factory:function(){return new t(c.Vb(n.a),c.Vb(r.a),c.Vb(s.a))},token:t,providedIn:"root"}),t}()},Te6q:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var o=function(){return function(){this.precio_total=0,this.cantidad_seleccionada_x_tpc=0,this.cantidad_descontado=0,this.itemtiposconsumo=[],this.subitems_selected=[],this.subitems_view=[]}}()},WF5t:function(t,e,i){"use strict";i.d(e,"a",function(){return s});var o=i("7RJT"),n=i("zOUh"),r=i("CcnG"),s=function(){function t(t){this.infoToken=t,this.countdownTimerRef=null,this.init=0,this.valPorcentaje=0,this.isPlayTimer=!1,this.dateNow=new Date,this.countdownSource=new o.BehaviorSubject(0),this.countdown$=this.countdownSource.asObservable(),this.isTimeLimitSource=new o.BehaviorSubject(!1),this.isTimeLimitComplet$=this.isTimeLimitSource.asObservable(),this.isPorgressVisibleSource=new o.BehaviorSubject(!1),this.isPorgressVisible$=this.isPorgressVisibleSource.asObservable()}return t.prototype.destroy=function(){this.clearTimeout()},t.prototype.playCountTimerLimit=function(){this.infoToken.isDelivery()||this.isPlayTimer||(this.isPlayTimer=!0,this.initCount())},t.prototype.resetCountTimerLimit=function(){this.infoToken.isDelivery()||(localStorage.getItem("sys::tcount")?(this.isPlayTimer=!0,this.initCount()):this.stopCountTimerLimit())},t.prototype.initCount=function(){this.infoToken.isDelivery()||(this.valPorcentaje=0,this.init=localStorage.getItem("sys::tcount")?parseInt(localStorage.getItem("sys::tcount"),0):0,this.isTimeLimitSource.next(!1),this.isPorgressVisibleSource.next(!0),this.progressCount())},t.prototype.progressCount=function(){var t=this,e=0;this.isPlayTimer&&(this.countdownTimerRef=setTimeout(function(){t.init=t.setTimeDate(),t.valPorcentaje=Math.round(t.init/t.maxTime*100),localStorage.setItem("sys::tcount",t.init.toString()),t.init>t.maxTime?(t.init=t.maxTime,t.valPorcentaje=100,t.countdownSource.next(t.valPorcentaje),t.isTimeLimitSource.next(!0),t.stopCountTimerLimit()):(e!==t.valPorcentaje&&t.countdownSource.next(t.valPorcentaje),t.progressCount()),e=t.valPorcentaje},1e3))},t.prototype.setTimeDate=function(){var t=(new Date).getTime(),e=localStorage.getItem("sys::tnum")?parseInt(localStorage.getItem("sys::tnum"),0):t,i=Math.floor((t-e)/1e3);return localStorage.setItem("sys::tnum",e.toString()),i},t.prototype.stopCountTimerLimit=function(){this.isPlayTimer=!1,this.init=0,this.valPorcentaje=0,localStorage.removeItem("sys::tcount"),localStorage.removeItem("sys::tnum"),this.clearTimeout(),this.isPorgressVisibleSource.next(!1),this.isTimeLimitSource.next(!1)},t.prototype.clearTimeout=function(){this.countdownTimerRef&&(clearTimeout(this.countdownTimerRef),this.countdownTimerRef=null)},t.ngInjectableDef=r.Ub({factory:function(){return new t(r.Vb(n.a))},token:t,providedIn:"root"}),t}()},fbMX:function(t,e,i){"use strict";i.d(e,"a",function(){return n});var o=i("CcnG"),n=function(){function t(){}return t.prototype.set=function(t,e){localStorage.setItem(t,e)},t.prototype.get=function(t){return localStorage.getItem(t)},t.prototype.isExistKey=function(t){return!!localStorage.getItem(t)},t.prototype.clear=function(t){localStorage.removeItem(t)},t.ngInjectableDef=o.Ub({factory:function(){return new t},token:t,providedIn:"root"}),t}()},"nYx/":function(t,e,i){"use strict";i.d(e,"a",function(){return a});var o=i("zOUh"),n=i("+lji"),r=i("yFR0"),s=i("CcnG"),a=function(){function t(t,e,i){this.infoTokenService=t,this.crudService=e,this.socketService=i,this.infoToken=this.infoTokenService.getInfoUs()}return t.prototype.getSubtotales=function(){this.objTotales=JSON.parse(atob(localStorage.getItem("sys::st")))},t.prototype.registrarPago=function(t,e,i){var o=this;this.getSubtotales();var n={idcliente:this.infoToken.idcliente,idorg:this.infoToken.idorg,idsede:this.infoToken.idsede,mesa:this.infoToken.numMesaLector,importe:t},r={idcliente:n.idcliente,idorg:n.idorg,idsede:n.idsede,mesa:n.mesa,importe:n.importe,objSubTotal:this.objTotales,objTransaction:e,objCliente:i,objOperacion:n};this.crudService.postFree(r,"transaction","registrar-pago",!1).subscribe(function(t){o.setIdRegistroPagoTransaction(t.data[0].idregistro_pago),o.socketService.emit("notificar-pago-pwa",r)})},t.prototype.getIpClient=function(){var t="";return this.crudService.getFree("https://api.ipify.org?format=jsonp&callback=?").subscribe(function(e){t=e.ip}),t},t.prototype.getDataTrasaction=function(){return this.loadDataTransaction(),this.responseTransaction.isSuccess=!(this.responseTransaction&&!this.responseTransaction.error),this.responseTransaction},t.prototype.setIdRegistroPagoTransaction=function(t){this.loadDataTransaction(),this.responseTransaction.idregistro_pago=t,this.upDataTransaction()},t.prototype.loadDataTransaction=function(){this.responseTransaction=JSON.parse(localStorage.getItem("sys::transaction-response"))},t.prototype.upDataTransaction=function(){localStorage.setItem("sys::transaction-response",JSON.stringify(this.responseTransaction))},t.prototype.removeLocalDataTransaction=function(){localStorage.removeItem("sys::transaction-response"),this.responseTransaction=null},t.ngInjectableDef=s.Ub({factory:function(){return new t(s.Vb(o.a),s.Vb(n.a),s.Vb(r.a))},token:t,providedIn:"root"}),t}()},nx09:function(t,e,i){"use strict";var o=i("7RJT"),n=i("Te6q"),r=i("6NNB"),s=i("Ie24"),a=i("fbMX"),c=i("yFR0"),u=i("WF5t"),d=i("/sn2"),m=i("wne+"),l=i("eI2u"),p=function(){return function(){this.isTpcLocal=!1,this.isTpcSoloLLevar=!1,this.isTpcSoloDelivery=!1,this.isTpcSoloOther=!1,this.isRequiereMesa=!1}}(),f=function(){return function(){}}(),h=i("JOr0"),b=i("CcnG"),g=i("vARd");i.d(e,"a",function(){return v});var v=function(){function t(t,e,i,a,c,u,d,m){this.storageService=t,this.socketService=e,this.timerLimitService=i,this.navigatorService=a,this._snackBar=c,this.utilesService=u,this.listenStatusService=d,this.establecimientoService=m,this.miPedidoSource=new o.BehaviorSubject(new r.a),this.miPedidoObserver$=this.miPedidoSource.asObservable(),this.countItemsSource=new o.BehaviorSubject(0),this.countItemsObserve$=this.countItemsSource.asObservable(),this.itemStockChangeSource=new o.BehaviorSubject(new n.a),this.itemStockChangeObserve$=this.itemStockChangeSource.asObservable(),this.isPreAvisoVisible=!1,this.listItemsPedido=[],this.miPedido=new r.a,this.mpObjSeccionSelected=new s.a,this.time=new Date}return t.prototype.getObjCarta=function(){return this.objCarta},t.prototype.getObjCartaLibery=function(){return JSON.parse(JSON.stringify(this.objCarta))},t.prototype.setObjMiPedido=function(t){this.miPedido=t,this.miPedidoSource.next(this.miPedido)},t.prototype.resetObjMiPedido=function(){this.miPedido=new r.a,this.miPedidoSource.next(this.miPedido)},t.prototype.setObjCarta=function(t){this.objCarta={},this.objCarta={carta:null,bodega:null},this.objCarta.carta=t[0].carta,this.objCarta.bodega=t[0].bodega;var e=this.objCarta.bodega;e&&this.objCarta.carta.map(function(t){e.map(function(e){t.secciones.push(e)})}),console.log("objCartaCarta",this.objCarta)},t.prototype.getMiPedido=function(){return 0===this.miPedido.tipoconsumo.length&&this.storageService.isExistKey("sys::order::all")&&(this.miPedido=JSON.parse(atob(this.storageService.get("sys::order::all")))),this.miPedido},t.prototype.setobjItemTipoConsumoSelected=function(t){this.mpObjItemTipoConsumoSelected=t},t.prototype.setObjSeccionSeleced=function(t){this.mpObjSeccionSelected=new s.a,this.mpObjSeccionSelected.des=t.des,this.mpObjSeccionSelected.idimpresora=t.idimpresora,this.mpObjSeccionSelected.idseccion=t.idseccion,this.mpObjSeccionSelected.sec_orden=t.sec_orden,this.mpObjSeccionSelected.ver_stock_cero=t.ver_stock_cero},t.prototype.addItem2=function(t,e,i,o){void 0===i&&(i=0),void 0===o&&(o=null);var n=parseInt(e.cantidad.toString(),0),r=0===i;if(!(n<=0&&r)){var s=t.cantidad_seleccionada||0;if(!((s+=r?1:-1)<0)){"ND"!==e.isporcion&&(s=s<0?0:s,n=(n+=r?-1:1)<0||s<0?0:n),t.cantidad_seleccionada=s=s<0?0:s;var a=JSON.parse(JSON.stringify(t)),c=this.findItemMiPedido(a,this.mpObjSeccionSelected,e,r);c.cantidad=n,e=o?this.findItemCarta(e):e,(e=this.findItemCarta(e)).sumar=r,e.subitems_selected=c.subitems_selected,e.subitems_view=c.subitems_view;var u=this.findItemListPedido(e),d=1;u?(u.itemtiposconsumo||(u.itemtiposconsumo=this.mpObjItemTipoConsumoSelected),d=this.totalItemTpcSelected(u.itemtiposconsumo)||0,u.cantidad_seleccionada=d,u.subitems_selected=c.subitems_selected,u.subitems_view=c.subitems_view):this.listItemsPedido.push(e),e.cantidad_seleccionada=d,this.itemStockChangeSource.next(e),this.setLocalStorageHora(),this.setLocalStoragePedido(),this.socketService.emit("itemModificado",e),console.log("listItemsPedido",this.listItemsPedido),console.log("itemModificado en add",e),console.log("itemModificado en add",JSON.stringify(e)),this.listenStatusService.setHayPedidoPendiente(!0),this.playTimerLimit()}}},t.prototype.totalItemTpcSelected=function(t){return t.map(function(t){return t.cantidad_seleccionada||0}).reduce(function(t,e){return t+e},0)},t.prototype.addCantItemMiPedido=function(t,e){var i=e,o=i*parseFloat(t.precio_unitario);t.subitems_selected&&t.subitems_selected.map(function(t){return t.precio*t.cantidad_seleccionada}).reduce(function(t,e){return t+e},0),t.cantidad_seleccionada=i,t.precio_total=o,t.precio_print=o},t.prototype.addPrecioItemMiPedido=function(t){var e=t.subitems_view?t.subitems_view.map(function(t){return t.precio}).reduce(function(t,e){return t+e},0):0,i=t.cantidad_seleccionada*parseFloat(t.precio_unitario);t.precio_total=i+=e,t.precio_print=i},t.prototype.addItemSubItemMiPedido=function(t,e,i){var o=this;if(t.subitems){if(0===t.subitems.length)return;var n=new f;if(n.id="",n.des="",n.listDes=[],n.cantidad_seleccionada=0,n.precio=0,n.indicaciones="",n.subitems=[],t.subitems_selected&&t.subitems_selected.length>0){t.subitems_selected.map(function(t){n.id+=t.iditem_subitem.toString(),n.listDes.push(o.utilesService.primeraConMayusculas(t.des.toLowerCase())),n.cantidad_seleccionada=1,n.precio+=parseFloat(t.precio.toString()),n.subitems.push(t)}),n.des=n.listDes.join(", "),n.des+=void 0===t.indicaciones||""===t.indicaciones?"":", ("+t.indicaciones+")",t.indicaciones="",t.subitems_view=t.subitems_view?t.subitems_view:[];var r=t.subitems_view.filter(function(t){return t.id===n.id})[0];r?i?(r.indicaciones+=n.indicaciones,r.cantidad_seleccionada+=1,r.precio+=n.precio):this.restarCantSubItemView(t,r):i?t.subitems_view.push(n):this.restarCantSubItemView(t,null),this.addPrecioItemMiPedido(t)}}},t.prototype.restarCantSubItemView=function(t,e){if(void 0===e&&(e=null),e){var i=e.precio/e.cantidad_seleccionada;e.cantidad_seleccionada-=1,e.precio-=i,e.precio=e.precio<0?0:e.precio,e.cantidad_seleccionada<=0&&(t.subitems_view=t.subitems_view.filter(function(t){return t.cantidad_seleccionada>0}))}else{var o=t.subitems_view[t.subitems_view.length-1];i=o.precio/o.cantidad_seleccionada,o.cantidad_seleccionada--,o.precio-=i,o.cantidad_seleccionada<=0&&(t.subitems_view=t.subitems_view.filter(function(t){return t.cantidad_seleccionada>0})),t.subitems_selected=o.subitems}},t.prototype.addItemInCarta=function(t){var e=this.findItemCarta(t);e?(console.log("update"),e.cantidad=e.cantidad):(console.log("add in carta"),this.objCarta.carta.map(function(e){e.secciones.filter(function(e){return e.idseccion===t.idseccion}).map(function(e){e.items.push(t)})})),console.log("item new add in carta",this.objCarta.carta)},t.prototype.findItemFromArr=function(t,e){return t.filter(function(t){return t.iditem===e.iditem})[0]},t.prototype.findItemListPedido=function(t){return this.listItemsPedido.filter(function(e){return e.iditem===t.iditem})[0]},t.prototype.findItemCartaAndClearIndicaciones=function(){this.objCarta.carta.map(function(t){t.secciones.map(function(t){t.items.filter(function(t){return t.indicaciones}).map(function(t){return t.indicaciones=""}),t.items.filter(function(t){return t.subitems_selected}).map(function(t){return t.subitems_selected=null}),t.items.filter(function(t){return t.subitems_view}).map(function(t){return t.subitems_view=null})})})},t.prototype.findItemCarta=function(t){var e;return this.objCarta.carta.map(function(i){i.secciones.map(function(i){var o=i.items.filter(function(e){return e.idcarta_lista===t.idcarta_lista})[0];if(o)return e=o})}),e},t.prototype.findItemCartaByIdCartaLista=function(t){var e;return this.objCarta.carta.map(function(i){i.secciones.map(function(i){var o=i.items.filter(function(e){return e.idcarta_lista.toString()===t.toString()})[0];if(o)return e=o})}),e},t.prototype.findSubItemCartaById=function(t,e){var i=[];return this.objCarta.carta.map(function(o){o.secciones.map(function(o){o.items.filter(function(t){return t.iditem.toString()!==e}).filter(function(t){return t.subitems}).map(function(e){e.subitems.map(function(e){var o=e.opciones.filter(function(e){return e.idproducto.toString()+e.idporcion.toString()===t})[0];o&&i.push(o)})})})}),i},t.prototype.resetCantidadesTpcItemCarta=function(){this.objCarta&&this.objCarta.carta.map(function(t){t.secciones.map(function(t){t.items.map(function(t){t.indicaciones="",t.cantidad_seleccionada=0,t.itemtiposconsumo=null})})})},t.prototype.findItemSeccionCarta=function(t){var e;return this.objCarta.carta.map(function(i){var o=i.secciones.filter(function(e){return e.idseccion===t})[0];o&&(e=o)}),e},t.prototype.findOnlyItemMiPedido=function(t){var e;return this.miPedido.tipoconsumo.map(function(i){i.secciones.map(function(i){e=i.items.filter(function(e){return e.idcarta_lista===t.idcarta_lista})[0]})}),e},t.prototype.findItemMiPedido=function(t,e,i,o){var n,r=JSON.parse(JSON.stringify(i)),s=t.cantidad_seleccionada;r.itemtiposconsumo=[],this.addCantItemMiPedido(r,s);var a=this.miPedido.tipoconsumo.filter(function(e){return e.idtipo_consumo===t.idtipo_consumo})[0];if(a){var c=a.secciones.filter(function(t){return t.idseccion===e.idseccion})[0];if(c){var u=c.items.filter(function(t){return t.idcarta_lista===i.idcarta_lista})[0];u?(u.indicaciones=r.indicaciones,this.addCantItemMiPedido(u,s),n=r=u):(c.items.push(r),n=r),r.subitems=i.subitems,r.subitems_selected=i.subitems_selected,this.addItemSubItemMiPedido(r,i,o),this.setCountCantItemTpcAndSeccion(a,c)}else n=r,(d=JSON.parse(JSON.stringify(e))).items=[],d.items.push(r),a.secciones=a.secciones?a.secciones:[],a.secciones.push(d),this.addItemSubItemMiPedido(r,i,o),this.setCountCantItemTpcAndSeccion(a,d)}else{var d;r.subitems=i.subitems,r.subitems_selected=i.subitems_selected,this.addItemSubItemMiPedido(r,i,o),(d=JSON.parse(JSON.stringify(e))).items=[],d.items.push(r),t.secciones=t.secciones?t.secciones:[],t.secciones.push(d),this.miPedido.tipoconsumo.push(t),this.setCountCantItemTpcAndSeccion(t,d),n=r}return this.clearObjMiPedido(),n},t.prototype.quitarTpcMiPedido=function(t){1===t.count_items_seccion&&(this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.filter(function(e){return!t}))},t.prototype.quitarSeccionMiPedido=function(t){1===t.count_items&&this.miPedido.tipoconsumo.map(function(e){e.secciones.filter(function(e){return!t})})},t.prototype.findMiPedidoIsTPCLocal=function(){var t=!1;return this.miPedido.tipoconsumo.filter(function(t){return"LOCAL"===t.titulo}).map(function(e){t=!!e.secciones.filter(function(t){return t.count_items>0})[0]}),t},t.prototype.findMiPedidoIsTPCDelivery=function(){var t=!1;return this.miPedido.tipoconsumo.filter(function(t){return"DELIVERY"===t.descripcion.toUpperCase()}).map(function(e){t=!!e.secciones.filter(function(t){return t.count_items>0})[0]}),t},t.prototype.findMiPedidoIsTPCLLevar=function(){var t=!1;return this.miPedido.tipoconsumo.filter(function(t){return t.descripcion.toUpperCase().indexOf("LLEVAR")}).map(function(e){t=!!e.secciones.filter(function(t){return t.count_items>0})[0]}),t},t.prototype.findEvaluateTPCMiPedido=function(){var t=new p,e=0;return this.miPedido.tipoconsumo.filter(function(t){return t.count_items_seccion>0}).map(function(i){"LOCAL"===i.titulo&&(t.isTpcLocal=!0,e++),i.descripcion.toUpperCase().indexOf("LLEVAR")>-1&&(t.isTpcSoloLLevar=!0,e++),i.descripcion.toUpperCase().indexOf("DELIVERY")>-1&&(t.isTpcSoloDelivery=!0),t.isRequiereMesa=!!t.isTpcLocal,t.isTpcSoloLLevar=!(1!==e||!t.isTpcSoloLLevar)}),t},t.prototype.findSeccionInMipedidoByPrint=function(t){var e;return this.miPedido.tipoconsumo.map(function(i){e=i.secciones.filter(function(e){return e.idimpresora===t})}),e},t.prototype.findIsHayItems=function(){return this.setCountTotalImtesPedido()>0},t.prototype.clearObjMiPedido=function(){if(this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.filter(function(t){return t.count_items_seccion>0}),0===this.miPedido.tipoconsumo.length)return this.miPedido=new r.a,console.log("mi pedido clear",this.miPedido),void this.miPedidoSource.next(this.miPedido);this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.map(function(t){return t.secciones=t.secciones.filter(function(t){return t.count_items>0}),t}),this.miPedido.tipoconsumo=this.miPedido.tipoconsumo.map(function(t){return t.secciones=t.secciones.map(function(t){return t.items=t.items.filter(function(t){return t.cantidad_seleccionada>0}),t}),t}),console.log("mi pedido clear",this.miPedido),this.miPedidoSource.next(this.miPedido)},t.prototype.setCountCantItemTpcAndSeccion=function(t,e){var i=e.items.map(function(t){return t.cantidad_seleccionada}).reduce(function(t,e){return t+e},0);e.count_items=i;var o=t.secciones.map(function(t){return t.count_items}).reduce(function(t,e){return t+e},0);t.count_items_seccion=o,this.setCountTotalImtesPedido()},t.prototype.setCountTotalImtesPedido=function(){var t=this.miPedido.tipoconsumo.map(function(t){return t.count_items_seccion}).reduce(function(t,e){return t+e},0);return this.countItemsSource.next(t),t},t.prototype.setLocalStorageHora=function(){if(!this.storageService.isExistKey("sys::h")){var t=this.time.getHours()+":"+this.time.getMinutes()+":"+this.time.getSeconds();this.storageService.set("sys::h",t.toString())}},t.prototype.setLocalStoragePedido=function(){this.storageService.set("sys::order",btoa(JSON.stringify(this.listItemsPedido))),this.storageService.set("sys::order::all",btoa(JSON.stringify(this.miPedido)))},t.prototype.clearPedidoIsLimitTime=function(){this.storageService.isExistKey("sys::order")&&(this.listItemsPedido=JSON.parse(atob(this.storageService.get("sys::order"))),this.miPedido=JSON.parse(atob(this.storageService.get("sys::order::all"))))},t.prototype.resetAllNewPedido=function(){this.socketService.emit("resetPedido",this.listItemsPedido),this.prepareNewPedido()},t.prototype.prepareNewPedido=function(){this.resetTpcCarta(),this.storageService.clear("sys::h"),this.storageService.clear("sys::order"),this.storageService.clear("sys::order::all"),this.storageService.clear("sys::tcount"),this.storageService.clear("sys::tnum"),this.miPedido=null,this.miPedido=new r.a,this.miPedidoSource.next(this.miPedido),this.countItemsSource.next(0),this.listenStatusService.setHayPedidoPendiente(!1),this.stopTimerLimit()},t.prototype.getOnlyCarta=function(){this.socketService.emit("getOnlyCarta",null)},t.prototype.resetTpcCarta=function(){var t=this;try{this.listItemsPedido.map(function(e){if(e.indicaciones="",e.itemtiposconsumo){e.itemtiposconsumo=null;var i=t.findItemCarta(e);i.indicaciones="",i.cantidad_seleccionada=0,i.itemtiposconsumo=null}})}catch(e){console.log(e)}this.resetCantidadesTpcItemCarta(),this.listItemsPedido=[]},t.prototype.updatePedidoFromStrorage=function(){var t=this;this.listenStatusService.setHayPedidoPendiente(!1),this.storageService.isExistKey("sys::order")&&(this.listenStatusService.setHayPedidoPendiente(!0),this.listItemsPedido=JSON.parse(atob(this.storageService.get("sys::order"))),this.miPedido=JSON.parse(atob(this.storageService.get("sys::order::all"))),this.setCountTotalImtesPedido(),this.miPedidoSource.next(this.miPedido),this.listItemsPedido.map(function(e){0===e.isalmacen&&t.objCarta.carta.map(function(t){t.secciones.map(function(t){var i=t.items.filter(function(t){return t.idcarta_lista===e.idcarta_lista})[0];i&&(i.cantidad_seleccionada=e.cantidad_seleccionada,i.itemtiposconsumo=e.itemtiposconsumo)})})}))},t.prototype.updatePedidoFromClear=function(){var t=this;this.listItemsPedido&&(this.listItemsPedido.map(function(e){0===e.isalmacen&&t.objCarta.carta.map(function(t){t.secciones.map(function(t){var i=t.items.filter(function(t){return"ND"!==t.isporcion&&t.idcarta_lista===e.idcarta_lista})[0];i&&(i.cantidad=parseInt(i.cantidad.toString(),0)+e.cantidad_seleccionada)})})}),this.prepareNewPedido())},t.prototype.getEstadoStockItem=function(t){return t>10?"verde":t>5?"amarillo":"rojo"},t.prototype.validarReglasCarta=function(t){var e=this,i=0,o=0,n=0,r=0,s=0,a=0;this.miPedido.tipoconsumo.map(function(t){t.secciones.map(function(t){t.items.map(function(t){return t.precio_total_calc=null})})}),t.map(function(t){i=t.idseccion_detalle,o=e.countCantItemsFromSeccion(t.idseccion),n=e.countCantItemsFromSeccion(i),r=(r=o-n)<0?o:r,e.miPedido.tipoconsumo.map(function(t){t.secciones.filter(function(t){return t.idseccion.toString()===i.toString()}).map(function(t){t.items.map(function(t,e){var i=parseFloat(t.precio),c=t.cantidad_seleccionada;s=a=null!==t.precio_total_calc?t.precio_total_calc:t.precio_total,o>=n?s=0:r>0&&(s=(s=a-(s=r*i))<0?0:s,r=r-c<0?0:r-c),t.precio_total_calc=parseFloat(s.toString()),t.precio_print=parseFloat(s.toString()),t.cantidad_descontado=c})})})})},t.prototype.countCantItemsFromSeccion=function(t){var e=0;return this.miPedido.tipoconsumo.map(function(i){i.secciones.map(function(i){e+=i.items.filter(function(e){return e.idseccion.toString()===t.toString()}).map(function(t){return t.cantidad_seleccionada}).reduce(function(t,e){return t+e},0)})}),e},t.prototype.countCantItemsFromTpcSeccion=function(t,e){var i=0;return this.miPedido.tipoconsumo.filter(function(e){return e.idtipo_consumo.toString()===t.toString()}).map(function(t){t.secciones.map(function(t){i+=t.items.filter(function(t){return t.idseccion.toString()===e.toString()}).map(function(t){return t.cantidad_seleccionada}).reduce(function(t,e){return t+e},0)})}),i},t.prototype.getArrSubTotales=function(t){var e=this,i=this.getSubTotalMiPedido(),o=i,n=[],r={id:0,descripcion:"SUB TOTAL",esImpuesto:0,visible:!0,quitar:!1,tachado:!1,visible_cpe:!0};r.importe=parseFloat(i.toString()).toFixed(2),n.push(r);var s=[];t.filter(function(t){return"p"===t.tipo}).map(function(t){var e=t.monto/100,n=1===t.es_impuesto,r=0===t.activo,a=(i*e).toFixed(2),c={};c.id=t.tipo+t.id,c.descripcion=t.descripcion,c.esImpuesto=t.es_impuesto,c.visible=!0,c.quitar=!1,c.tachado=!1,c.visible_cpe=n,"I.G.V"===c.descripcion?c.importe=r?e:0:(c.importe=n?r?a:0:a,c.importe=parseFloat(c.importe.toString()).toFixed(2),o+=parseFloat(c.importe)),0!==c.importe&&s.push(c)});var a=0,c=[],u=t.filter(function(t){return"a"===t.tipo}),d=!!this.establecimientoService.get().idsede,m=!1;if(u.map(function(t){var i={};if(t.descripcion.toUpperCase().indexOf("DELIVERY")>-1&&d?(m=!0,t.descripcion="Entrega",a=e.establecimientoService.get().c_servicio):a=parseFloat(t.monto),0===t.nivel){var n=e.countCantItemsFromTpcSeccion(t.idtipo_consumo,t.idseccion);if(0===n)return;a=n*parseFloat(t.monto)}i.id=t.tipo+t.id,i.descripcion=t.descripcion,i.esImpuesto=t.es_impuesto,i.visible=!0,i.quitar=!0,i.tachado=!1,i.visible_cpe=!1,i.importe=parseFloat(a.toString()).toFixed(2),o+=parseFloat(i.importe);var r=c.filter(function(t){return t.descripcion===i.descripcion})[0];r?r.importe+=parseFloat(i.importe):c.push(i)}),!m&&d){var l={id:-2,descripcion:"Entrega",esImpuesto:0,visible:!0,quitar:!1,tachado:!1,visible_cpe:!1};l.importe=parseFloat(this.establecimientoService.get().c_servicio.toString()).toFixed(2),o+=parseFloat(l.importe),c.push(l)}s.map(function(t){return n.push(t)}),c.map(function(t){return n.push(t)});var p=n.filter(function(t){return"SUB TOTAL"===t.descripcion})[0],f=n.filter(function(t){return"I.G.V"===t.descripcion})[0],h=f?f.importe:0,b=p?p.importe:0;return h>0&&(b-=h=parseFloat((b*h).toString()).toFixed(2),f.importe=h,p.importe=b.toFixed(2)),(r={}).id=0,r.esImpuesto=0,r.descripcion="TOTAL",r.visible=!0,r.quitar=!1,r.tachado=!1,r.visible_cpe=!0,r.importe=parseFloat(o.toString()).toFixed(2),n.push(r),console.log("totales",n),n},t.prototype.getSubTotalMiPedido=function(){var t=0;return this.miPedido.tipoconsumo.map(function(e){e.secciones.map(function(e){t+=e.items.map(function(t){return t.precio_print}).reduce(function(t,e){return t+e},0)})}),t},t.prototype.getImporteTotalItemFromMiPedido=function(t){var e=0;return this.miPedido.tipoconsumo.map(function(i){i.secciones.map(function(i){e+=i.items.filter(function(e){return e.iditem===t.iditem}).map(function(t){return t.precio_print}).reduce(function(t,e){return t+e},0)})}),e},t.prototype.playTimerLimit=function(){this.timerLimitService.playCountTimerLimit()},t.prototype.stopTimerLimit=function(){this.timerLimitService.resetCountTimerLimit()},t.prototype.restoreTimerLimit=function(){this.timerLimitService.resetCountTimerLimit()},t.prototype.listenChangeCantItem=function(){var t=this;this.socketService.onItemModificado().subscribe(function(e){var i;null!=e.listItemPorcion?e.listItemPorcion.map(function(o){i=t.findItemCartaByIdCartaLista(o.idcarta_lista);var n=parseInt(o.cantidad,0);i.cantidad=n||parseInt(e.item.cantidad.toString(),0),t.setCantidadItemModificadoPwa(e.item,i,parseInt(o.cantidad,0),!0)}):(i=t.findItemCarta(e=e.item),t.setCantidadItemModificadoPwa(e,i)),console.log("socket list",t.listItemsPedido)}),this.socketService.onItemResetCant().subscribe(function(e){var i;null!=e.listItemPorcion?e.listItemPorcion.map(function(o){(i=t.findItemCartaByIdCartaLista(o.idcarta_lista)).cantidad=parseInt(o.cantidad,0),t.setCantidadItemModificadoPwa(e.item,i,parseInt(o.cantidad,0),!0),t.itemStockChangeSource.next(i)}):((i=t.findItemCarta(e=e.item)).cantidad=parseInt(e.cantidad.toString(),0),i.subitems=e.subitems,t.itemStockChangeSource.next(i))}),this.socketService.onNuevoItemAddInCarta().subscribe(function(e){console.log("onNuevoItemAddInCarta",e),t.addItemInCarta(e)}),this.socketService.onGetDatosSede().subscribe(function(e){t.objDatosSede=e[0],t.listenStatusService.setHayDatosSede(!0),localStorage.setItem("sys::s",t.objDatosSede.datossede[0].nombre+"|"+t.objDatosSede.datossede[0].ciudad),console.log("datos de la sede ps",t.objDatosSede),t.max_minute_order=e[0].datossede[0].pwa_time_limit,t.timerLimitService.maxTime=100*t.max_minute_order}),this.timerLimitService.countdown$.subscribe(function(e){switch(e){case 1:t.isPreAvisoVisible=!1;break;case 80:t.isPreAvisoVisible||(t.isPreAvisoVisible=!0,t._snackBar.open("Proximo a cumplir el tiempo de envio.","",{duration:2e3}));break;case 100:t._snackBar.open("Tiempo agotado, debe realizar un nuevo pedido.","",{duration:3e3})}}),this.timerLimitService.isTimeLimitComplet$.subscribe(function(e){!0===e&&(t.resetAllNewPedido(),t.navigatorService.setPageActive("carta"))})},t.prototype.setCantidadItemModificadoPwa=function(t,e,i,o){var n=this;void 0===i&&(i=null),void 0===o&&(o=!1),t.subitems&&t.idcarta_lista===e.idcarta_lista&&t.subitems.map(function(i){i.opciones.map(function(i){e.subitems.map(function(e){var o=e.opciones.filter(function(t){return t.iditem_subitem===parseInt(i.iditem_subitem.toString(),0)})[0];if(o&&"ND"!==o.cantidad){o.cantidad=i.cantidad;var r=o.idproducto.toString()+o.idporcion.toString();n.findSubItemCartaById(r,t.iditem.toString()).map(function(t){t.cantidad=i.cantidad})}})})}),o||(e.cantidad=i||parseInt(t.cantidad.toString(),0)),this.itemStockChangeSource.next(e)},t.prototype.cerrarSession=function(){this.socketService.closeConnection(),this.navigatorService.cerrarSession()},t.ngInjectableDef=b.Ub({factory:function(){return new t(b.Vb(a.a),b.Vb(c.a),b.Vb(u.a),b.Vb(d.a),b.Vb(g.b),b.Vb(m.a),b.Vb(l.a),b.Vb(h.a))},token:t,providedIn:"root"}),t}()},qTE5:function(t,e,i){"use strict";i.d(e,"a",function(){return o});var o=function(){return function(){}}()},"wne+":function(t,e,i){"use strict";i.d(e,"a",function(){return n});var o=i("CcnG"),n=function(){function t(){}return t.prototype.primeraConMayusculas=function(t){return(t=t.toLowerCase()).charAt(0).toUpperCase()+t.slice(1)},t.prototype.reformatDate=function(t){var e=t.split("-");return e[2]+"/"+e[1]+"/"+e[0]},t.ngInjectableDef=o.Ub({factory:function(){return new t},token:t,providedIn:"root"}),t}()}}]);