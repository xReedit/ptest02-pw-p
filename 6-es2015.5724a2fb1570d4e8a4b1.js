(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"/Qaf":function(i,e,t){"use strict";t.d(e,"a",(function(){return v}));var o=t("JOr0"),n=t("MWJo"),s=t("zOUh"),a=t("fXoL"),c=t("0IaG"),r=t("ofXK"),l=t("bTqV"),d=t("kmnG"),p=t("qFsG"),h=t("3Pt+"),b=t("Bzl0");function g(i,e){if(1&i){const i=a.Sb();a.Pb(0),a.Rb(1,"div",8),a.Rb(2,"p",9),a.Gc(3,"En formato 24 horas"),a.Qb(),a.Rb(4,"mat-form-field",10),a.Rb(5,"mat-label"),a.Gc(6,"Hora"),a.Qb(),a.Rb(7,"input",11),a.Zb("ngModelChange",(function(e){return a.xc(i),a.dc().hourNow=e}))("change",(function(){return a.xc(i),a.dc().timePersonalAutorizado()})),a.Qb(),a.Qb(),a.Rb(8,"mat-form-field",10),a.Rb(9,"mat-label"),a.Gc(10,"Minutos"),a.Qb(),a.Rb(11,"input",12),a.Zb("ngModelChange",(function(e){return a.xc(i),a.dc().minNow=e}))("change",(function(){return a.xc(i),a.dc().timePersonalAutorizado()})),a.Qb(),a.Qb(),a.Qb(),a.Ob()}if(2&i){const i=a.dc();a.zb(7),a.lc("ngModel",i.hourNow),a.zb(4),a.lc("ngModel",i.minNow)}}function m(i,e){if(1&i){const i=a.Sb();a.Pb(0),a.Rb(1,"div",13),a.Rb(2,"app-tiempo-programado",14),a.Zb("tiempoProgramado",(function(e){return a.xc(i),a.dc(2).selectedTime(e)})),a.Qb(),a.Qb(),a.Ob()}}function u(i,e){1&i&&(a.Rb(0,"div",15),a.Rb(1,"div",16),a.Mb(2,"img",17),a.Rb(3,"p"),a.Gc(4,"El comercio no permite pedidos programados."),a.Qb(),a.Qb(),a.Qb())}function f(i,e){if(1&i&&(a.Ec(0,m,3,0,"ng-container",4),a.Ec(1,u,5,0,"ng-template",null,5,a.Fc)),2&i){const i=a.uc(2),e=a.dc();a.lc("ngIf",e.isComercioAceptaPedidoProgramado)("ngIfElse",i)}}let v=(()=>{class i{constructor(i,e,t){this.dialogRef=i,this.establecimientoService=e,this.inforTokenService=t,this.isComercioAceptaPedidoProgramado=!1,this.isPersonalAutorizado=!1,this.rippleColor="rgb(255,238,88, 0.3)",this.isHoraValid=!0,this.dateNow=new Date}ngOnInit(){this.hourNow=this.dateNow.getHours(),this.minNow=this.dateNow.getMinutes(),this.infoEstablecimiento=this.establecimientoService.get(),this.isPersonalAutorizado=!this.inforTokenService.getInfoUs().isCliente,this.isComercioAceptaPedidoProgramado=1===this.infoEstablecimiento.pwa_delivery_habilitar_pedido_programado}selectedTime(i){this.tiempoEntregaSelected=i}timePersonalAutorizado(){this.isHoraValid=this.hourNow<=24&&this.minNow<=59;const i=this.hourNow+":"+this.minNow,e=this.dateNow.toLocaleDateString()+" "+i;this.tiempoEntregaSelected=new n.a,this.tiempoEntregaSelected.dia="Hoy",this.tiempoEntregaSelected.descripcion="Hoy",this.tiempoEntregaSelected.hora=i,this.tiempoEntregaSelected.value=i,this.tiempoEntregaSelected.date=e,this.tiempoEntregaSelected.idhora=0,this.tiempoEntregaSelected.iddia=0,this.tiempoEntregaSelected.modificado=!0,this.tiempoEntregaSelected.isUsuarioAutorizado=!0}cerrarDlg(){this.dialogRef.close(this.tiempoEntregaSelected)}}return i.\u0275fac=function(e){return new(e||i)(a.Lb(c.i),a.Lb(o.a),a.Lb(s.a))},i.\u0275cmp=a.Fb({type:i,selectors:[["app-dialog-tiempo-entrega"]],decls:14,vars:3,consts:[[1,"p-4","h-100"],[1,"fs-14","fw-600"],[1,"fa","fa-arrow-left","pr-2",3,"click"],[1,"div-content-dialog"],[4,"ngIf","ngIfElse"],["elseTemplate",""],[1,"xfooter-dialog","text-center","w-100"],["mat-flat-button","","color","primary",3,"disabled","click"],[1,"p-4"],[1,"fw-100"],[1,"w-50","text-center"],["matInput","","type","number","step","1","max","23","min","0","placeholder","Hora","name","hourNow",3,"ngModel","ngModelChange","change"],["matInput","","type","number","step","10","max","50","min","0","placeholder","minutos","name","minNow",3,"ngModel","ngModelChange","change"],[1,"w-100","text-center","p-2"],[3,"tiempoProgramado"],[1,"d-flex","align-items-center","h-100"],[1,"text-center"],["src","./assets/images/solicitar-atencion.png","alt","icon-programado"]],template:function(i,e){if(1&i&&(a.Rb(0,"div",0),a.Rb(1,"div"),a.Rb(2,"div"),a.Rb(3,"p",1),a.Rb(4,"i",2),a.Zb("click",(function(){return e.cerrarDlg()})),a.Qb(),a.Gc(5," Programar entrega:"),a.Qb(),a.Qb(),a.Qb(),a.Rb(6,"div",3),a.Ec(7,g,12,2,"ng-container",4),a.Ec(8,f,3,2,"ng-template",null,5,a.Fc),a.Qb(),a.Mb(10,"hr"),a.Rb(11,"div",6),a.Rb(12,"button",7),a.Zb("click",(function(){return e.cerrarDlg()})),a.Gc(13,"Listo."),a.Qb(),a.Qb(),a.Qb()),2&i){const i=a.uc(9);a.zb(7),a.lc("ngIf",e.isPersonalAutorizado)("ngIfElse",i),a.zb(5),a.lc("disabled",!e.isHoraValid)}},directives:[r.t,l.b,d.c,d.g,p.a,h.v,h.c,h.p,h.s,b.a],styles:[".div-content-dialog[_ngcontent-%COMP%]{-webkit-box-align:center;-webkit-align-items:center;align-items:center;height:-webkit-calc(100% - 95px);height:calc(100% - 95px);overflow:auto}"]}),i})()},"22RU":function(i,e,t){"use strict";t.d(e,"a",(function(){return a}));var o=t("+lji"),n=t("Q1FS"),s=t("fXoL");let a=(()=>{class i{constructor(i){this.crudService=i}loadDatosPlazaByCiudad(i){const e={ciudad:i};return new n.Observable(i=>{this.crudService.postFree(e,"delivery","get-sede-servicio-express",!1).subscribe(e=>{i.next(e.data[0])})})}getComisionAtm(i){const e={importe:i};return new n.Observable(i=>{this.crudService.postFree(e,"delivery","get-comsion-atm",!1).subscribe(e=>{i.next(e.data[0])})})}}return i.\u0275fac=function(e){return new(e||i)(s.Vb(o.a))},i.\u0275prov=s.Hb({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},Bzl0:function(i,e,t){"use strict";t.d(e,"a",(function(){return g}));var o=t("fXoL"),n=t("JOr0"),s=t("MWJo"),a=t("zOUh"),c=t("kmnG"),r=t("d3UM"),l=t("ofXK"),d=t("MutI"),p=t("FKr1");function h(i,e){if(1&i&&(o.Rb(0,"mat-option",5),o.Rb(1,"span",6),o.Gc(2),o.Qb(),o.Qb()),2&i){const i=e.$implicit;o.lc("value",i),o.zb(2),o.Ic(" ",i.descripcion," ")}}function b(i,e){if(1&i){const i=o.Sb();o.Rb(0,"mat-list-option",7),o.Zb("click",(function(){o.xc(i);const t=e.$implicit;return o.dc().selectHour(t)})),o.Rb(1,"span",8),o.Gc(2),o.Qb(),o.Qb()}if(2&i){const i=e.$implicit;o.lc("value",i)("selected",i.selected),o.zb(2),o.Ic(" ",i.descripcion," ")}}let g=(()=>{class i{constructor(i,e){this.establecimientoService=i,this.infoTokenService=e,this.tiempoProgramado=new o.n,this.listDia=[],this.listHora=[],this.tiempoEntregaSelected=new s.a,this.isTiempoProgramadoSoloDia=!1,this.dateHoy=new Date,this.dateNow=new Date}ngOnInit(){this.infoEstablecimiento=this.establecimientoService.get(),this.isTiempoProgramadoSoloDia=1===this.infoEstablecimiento.pwa_pedido_programado_solo_del_dia,this.getDia(),this.tiempoEntregaSelected=this.infoTokenService.infoUsToken.tiempoEntrega,this.findTimeList()}findTimeList(){var i;if(void 0!==(null===(i=this.tiempoEntregaSelected)||void 0===i?void 0:i.iddia)){this.selectedIni=this.listDia[0],this.seletecDay=this.selectedIni,this.listHora=this.selectedIni.hours,this.listDia.map(i=>{i.hours.map(i=>i.selected=!1)}),this.listHora.map(i=>i.selected=!1);const i=this.listHora.filter(i=>i.hora===this.tiempoEntregaSelected.idhora)[0];i&&(i.selected=!0)}}getDia(){const i=parseInt(this.infoEstablecimiento.hora_ini.split(":")[0],0),e=parseInt(this.infoEstablecimiento.hora_fin.split(":")[0],0),t=["Domingo","Lunes","Martes","Miercoles","Jueves","Viernes","Sabado"],o=(this.dateHoy.getDay(),this.dateHoy.getHours()),n=(this.dateHoy.getMinutes(),o<=e);this.listDia=[];let s=1;if(this.dateHoy.getDay(),n){const t=this.hourSow(o,i,e,!0);this.listDia.push({numDay:0,descripcion:"Hoy",date:this.dateNow.toLocaleDateString(),hours:t})}if(!this.isTiempoProgramadoSoloDia)for(;s<=3;){const n=this.hourSow(o,i,e,!1);let a=this.dateHoy.getDay()+1;a=a>6?a-7:a,this.dateHoy.setDate(this.dateHoy.getDate()+1);const c=this.dateHoy.toLocaleDateString(),r=1===s?"Ma\xf1ana":t[a]+" "+this.dateHoy.getDate();this.infoEstablecimiento.dias_atienden.indexOf(a.toString())>-1&&this.listDia.push({numDay:s,descripcion:r,date:c,hours:n}),s++}this.selectedIni=this.listDia[0],this.seletecDay=this.selectedIni,this.listHora=this.selectedIni.hours}hourSow(i,e,t,o=!1){const n=[];let s=!1,a={},c=o&&i>=e?i:e;for(;c<t;)i>=e&&o&&!s?(a={hora:8,descripcion:"Lo mas antes posible: "+this.infoEstablecimiento.tiempo_aprox_entrega,selected:!0},s=!0):a={hora:c,descripcion:c+":00 - "+c+":30",selected:!1},c++,n.push(a);return n}selectedDay(i){this.seletecDay=i.value,this.listHora=i.value.hours}selectHour(i){this.listDia.map(i=>{i.hours.map(i=>i.selected=!1)}),i.selected=!0,this.tiempoEntregaSelected=new s.a;const e=this.seletecDay.date+" "+i.descripcion.split(" - ")[0];this.tiempoEntregaSelected.dia=this.seletecDay.descripcion,this.tiempoEntregaSelected.descripcion=this.seletecDay.descripcion,this.tiempoEntregaSelected.hora=i.descripcion,this.tiempoEntregaSelected.value=i.descripcion,this.tiempoEntregaSelected.date=e,this.tiempoEntregaSelected.idhora=i.hora,this.tiempoEntregaSelected.iddia=this.seletecDay.numDay,this.tiempoEntregaSelected.modificado=!0,i.descripcion.indexOf("Lo mas antes posible")>-1&&(this.tiempoEntregaSelected.modificado=!1),this.tiempoProgramado.emit(this.tiempoEntregaSelected)}compareObjects(i,e){return i.descripcion===e.descripcion&&i.numDay===e.numDay}}return i.\u0275fac=function(e){return new(e||i)(o.Lb(n.a),o.Lb(a.a))},i.\u0275cmp=o.Fb({type:i,selectors:[["app-tiempo-programado"]],outputs:{tiempoProgramado:"tiempoProgramado"},decls:9,vars:3,consts:[[1,"w-100"],[3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],[1,"w-100","h-100"],["class","list-option-time",3,"value","selected","click",4,"ngFor","ngForOf"],[3,"value"],[1,"text-center","w-100"],[1,"list-option-time",3,"value","selected","click"],[1,"text-center","w-100","tfs-11"]],template:function(i,e){1&i&&(o.Rb(0,"div",0),o.Rb(1,"mat-form-field",0),o.Rb(2,"mat-label"),o.Gc(3,"D\xeda:"),o.Qb(),o.Rb(4,"mat-select",1),o.Zb("selectionChange",(function(i){return e.selectedDay(i)}))("valueChange",(function(i){return e.selectedIni=i})),o.Ec(5,h,3,2,"mat-option",2),o.Qb(),o.Qb(),o.Qb(),o.Rb(6,"div",3),o.Rb(7,"mat-selection-list"),o.Ec(8,b,3,3,"mat-list-option",4),o.Qb(),o.Qb()),2&i&&(o.zb(4),o.lc("value",e.selectedIni),o.zb(1),o.lc("ngForOf",e.listDia),o.zb(3),o.lc("ngForOf",e.listHora))},directives:[c.c,c.g,r.a,l.s,d.i,p.i,d.f],styles:[".div-list[_ngcontent-%COMP%]{max-height:80vh!important;overflow:auto}.tfs-11[_ngcontent-%COMP%]{font-size:12px!important}.mat-list-option[_ngcontent-%COMP%]{height:20px}"]}),i})()},DXvS:function(i,e,t){"use strict";t.d(e,"a",(function(){return Q}));var o=t("fXoL"),n=(t("qmRn"),t("2dOp")),s=t("MWJo"),a=t("zOUh"),c=t("0IaG"),r=t("wne+"),l=t("N6vS"),d=t("/Qaf"),p=t("Ln/Y"),h=t("e9Tq"),b=t("HWNa"),g=t("+lji"),m=t("22RU"),u=t("ofXK"),f=t("FKr1");function v(i,e){if(1&i&&(o.Rb(0,"p",11),o.Gc(1),o.Qb()),2&i){const i=o.dc(2);o.zb(1),o.Ic(" ",i.msjErrorDir," ")}}const D=function(i){return{"text-danger":i}};function S(i,e){if(1&i){const i=o.Sb();o.Rb(0,"div"),o.Rb(1,"p",2),o.Gc(2),o.Qb(),o.Rb(3,"div",3),o.Rb(4,"div",4),o.Zb("click",(function(){return o.xc(i),o.dc().openDialogDireccion(0)})),o.Rb(5,"p",5),o.Rb(6,"strong",6),o.Gc(7),o.Qb(),o.Mb(8,"br"),o.Gc(9),o.Qb(),o.Rb(10,"p",7),o.Gc(11),o.Qb(),o.Ec(12,v,2,1,"p",8),o.Qb(),o.Rb(13,"div"),o.Rb(14,"button",9),o.Zb("click",(function(){return o.xc(i),o.dc().openDialogDireccion(0)})),o.Rb(15,"span",10),o.Gc(16,"Cambiar"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Mb(17,"hr"),o.Qb()}if(2&i){const i=o.dc();o.zb(2),o.Hc(i.titleDirA),o.zb(2),o.lc("matRippleColor",i.rippleColor),o.zb(2),o.lc("ngClass",o.qc(7,D,""===i.direccionA.direccion)),o.zb(1),o.Hc(i.direccionA.titulo),o.zb(2),o.Ic(" ",i.direccionA.direccion,""),o.zb(2),o.Ic(" ",i.direccionA.referencia," "),o.zb(1),o.lc("ngIf",i.msjErrorDir.length>0)}}function C(i,e){if(1&i&&(o.Rb(0,"p",11),o.Gc(1),o.Qb()),2&i){const i=o.dc(2);o.zb(1),o.Ic(" ",i.msjErrorDir," ")}}function R(i,e){if(1&i){const i=o.Sb();o.Rb(0,"div"),o.Rb(1,"p",2),o.Gc(2),o.Qb(),o.Rb(3,"div",3),o.Rb(4,"div",4),o.Zb("click",(function(){return o.xc(i),o.dc().openDialogDireccion(1)})),o.Rb(5,"p",5),o.Rb(6,"strong",6),o.Gc(7),o.Qb(),o.Mb(8,"br"),o.Gc(9),o.Qb(),o.Rb(10,"p",7),o.Gc(11),o.Qb(),o.Ec(12,C,2,1,"p",8),o.Qb(),o.Rb(13,"div"),o.Rb(14,"button",9),o.Zb("click",(function(){return o.xc(i),o.dc().openDialogDireccion(1)})),o.Rb(15,"span",10),o.Gc(16,"Cambiar"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Mb(17,"hr"),o.Qb()}if(2&i){const i=o.dc();o.zb(2),o.Hc(i.titleDirB),o.zb(2),o.lc("matRippleColor",i.rippleColor),o.zb(2),o.lc("ngClass",o.qc(7,D,""===i.direccionB.direccion)),o.zb(1),o.Hc(i.direccionB.titulo),o.zb(2),o.Ic(" ",i.direccionB.direccion,""),o.zb(2),o.Ic(" ",i.direccionB.referencia," "),o.zb(1),o.lc("ngIf",i.msjErrorDir.length>0)}}function w(i,e){if(1&i){const i=o.Sb();o.Rb(0,"div"),o.Rb(1,"div",12),o.Zb("click",(function(){return o.xc(i),o.dc().openDialogTiempoEntrega()})),o.Rb(2,"div"),o.Rb(3,"p",2),o.Gc(4,"Cuando lo entregamos?"),o.Qb(),o.Rb(5,"p",13),o.Rb(6,"span",14),o.Gc(7),o.Rb(8,"strong"),o.Gc(9),o.ec(10,"titlecase"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Rb(11,"div"),o.Mb(12,"i",15),o.Qb(),o.Qb(),o.Mb(13,"hr"),o.Qb()}if(2&i){const i=o.dc();o.zb(1),o.lc("matRippleColor",i.rippleColor),o.zb(5),o.lc("ngClass",o.qc(6,D,!i.isTiempoEntregaValid)),o.zb(1),o.Ic(" ",i.tiempoEntregaSelected.descripcion,": "),o.zb(2),o.Ic("",o.fc(10,4,i.tiempoEntregaSelected.value)," ")}}function y(i,e){if(1&i){const i=o.Sb();o.Rb(0,"div"),o.Rb(1,"div",4),o.Zb("click",(function(){return o.xc(i),o.dc().openDialogMetodoPago()})),o.Rb(2,"div",3),o.Rb(3,"p",16),o.Gc(4,"Metodo de pago: "),o.Rb(5,"strong"),o.Gc(6),o.Qb(),o.Qb(),o.Rb(7,"button",17),o.Rb(8,"span",10),o.Gc(9,"Cambiar"),o.Qb(),o.Qb(),o.Qb(),o.Rb(10,"span",18),o.Gc(11,"Especifique un metodo de pago."),o.Qb(),o.Qb(),o.Mb(12,"hr"),o.Qb()}if(2&i){const i=o.dc();o.zb(1),o.lc("matRippleColor",i.rippleColor),o.zb(5),o.Hc(i.metodoPagoSelected.descripcion),o.zb(4),o.lc("hidden",i.metodoPagoSelected.idtipo_pago)}}function P(i,e){if(1&i){const i=o.Sb();o.Rb(0,"div"),o.Rb(1,"div",3),o.Rb(2,"div",4),o.Zb("click",(function(){return o.xc(i),o.dc().openDialogsendSMS()})),o.Rb(3,"span",19),o.Gc(4,"Es necesario el numero de su telefono"),o.Qb(),o.Rb(5,"p",16),o.Gc(6,"Telefono contacto: "),o.Rb(7,"strong"),o.Gc(8),o.Qb(),o.Qb(),o.Rb(9,"span",18),o.Gc(10,"A\xf1ade un n\xfamero de tel\xe9fono para que podamos contactarte e informarte de tu pedido."),o.Qb(),o.Qb(),o.Rb(11,"div"),o.Rb(12,"button",9),o.Zb("click",(function(){return o.xc(i),o.dc().openDialogsendSMS(1)})),o.Rb(13,"span",10),o.Gc(14,"Cambiar"),o.Qb(),o.Qb(),o.Qb(),o.Qb(),o.Qb()}if(2&i){const i=o.dc();o.zb(2),o.lc("matRippleColor",i.rippleColor),o.zb(1),o.lc("hidden",i.infoToken.telefono.length>=5),o.zb(5),o.Hc(i.infoToken.telefono),o.zb(1),o.lc("hidden",i.infoToken.telefono.length>=5)}}let Q=(()=>{class i{constructor(i,e,t,n,s,a,c,r,l){this.infoTokenService=i,this.dialogDireccion=e,this.dialogTelefono=t,this.dialogTiempoEntrega=n,this.dialog=s,this.utilService=a,this.calcDistanceService=c,this.crudService=r,this.plazaDelivery=l,this.frmResponse=new o.n,this.lasCiudad="",this.isTiempoEntregaValid=!0,this.msjErrorDir="",this.systemOS="",this.isFormValid=!1,this.isFormValidDos=!1,this.isCalculandoDistancia=!1,this.titleDirA="De d\xf3nde lo recogemos?",this.titleDirB="A d\xf3nde lo llevamos?"}ngOnInit(){this.systemOS=this.utilService.getOS(),this.msjErrorDir="",this.infoToken=this.infoTokenService.getInfoUs(),this.direccionClienteIni=new n.a,this.direccionClienteIni.titulo="Seleccione una direccion *",this.direccionClienteIni.direccion="",this.direccionClienteIni.referencia="",this.datosFormUno={},this.datosFormUno.descripcion_paquete="",this.datosFormUno.telefono=this.infoToken.telefono,this.direccionA=this.direccionClienteIni,this.direccionB=this.direccionClienteIni,this.tiempoEntregaSelected=new s.a,this.tiempoEntregaSelected.descripcion="Programa tu entrega",this.tiempoEntregaSelected.value="",this.tiempoEntregaSelected.modificado=!1,this.tiempoEntregaSelected.valid=!1,this.isTiempoEntregaValid=!1,this.titleDirA=this.opciones.tituloDirA,this.titleDirB=this.opciones.tituloDirB,this.opciones.metodoPago&&(this.metodoPagoSelected=this.infoTokenService.setIniMetodoPagoSegunFiltro(this.opciones.metodoPagoAceptaTarjeta))}openDialogDireccion(i){const e=new c.e;e.disableClose=!0,e.hasBackdrop=!0,e.panelClass=["my-dialog-orden-detalle","my-dialog-scrool"],e.data={isGuardar:!!this.infoTokenService.infoUsToken.idcliente,isFromComercio:!0},this.dialogDireccion.open(l.a,e).afterClosed().subscribe(e=>{e&&(this.msjErrorDir="",0===i?this.direccionA=e:this.direccionB=e,this.getDatosCiudadSeleted(),this.validFormDos())})}openDialogTiempoEntrega(){const i=new c.e;i.panelClass=["my-dialog-orden-detalle","my-dialog-scrool"],this.dialogTiempoEntrega.open(d.a,i).afterClosed().subscribe(i=>{i&&(this.infoTokenService.setTiempoEntrega(i),this.tiempoEntregaSelected=i,this.isTiempoEntregaValid=!0)})}openDialogMetodoPago(){const i=new c.e;i.width="380px",i.disableClose=!0,i.hasBackdrop=!0,i.panelClass=["my-dialog-orden-detalle","my-dialog-scrool"],i.data={importeTotalPagar:3},this.dialog.open(p.a,i).afterClosed().subscribe(i=>{this.metodoPagoSelected=i,this.validFormDos()})}openDialogsendSMS(){const i=new c.e;i.disableClose=!0,i.hasBackdrop=!0,i.panelClass=["my-dialog-orden-detalle","my-dialog-scrool"],i.data={idcliente:this.infoTokenService.infoUsToken.idcliente,numberphone:this.infoTokenService.infoUsToken.telefono?this.infoTokenService.infoUsToken.telefono:""},this.dialogTelefono.open(h.a,i).afterClosed().subscribe(i=>{i.verificado&&(this.infoToken.telefono=i.numberphone,this.infoTokenService.setTelefono(i.numberphone),this.datosFormUno.telefono=this.infoToken.telefono,this.validFormDos())})}validFormDos(){this.isFormValidDos=this.isFormValid,this.isFormValidDos=this.opciones.showDirreccionA?!!this.direccionA.ciudad:this.isFormValidDos,this.isFormValidDos=!this.opciones.showDirreccionB||!!this.direccionB.ciudad&&this.isFormValidDos,this.isFormValidDos=!this.opciones.metodoPago||!!this.metodoPagoSelected.idtipo_pago&&this.isFormValidDos,this.isFormValidDos=!this.opciones.telefono||this.datosFormUno.telefono.trim().length>=5&&this.isFormValidDos,this.frmResponse.emit({success:this.isFormValidDos,direccionA:this.direccionA,direccionB:this.direccionB,metodoPago:this.metodoPagoSelected,telefono:this.datosFormUno.telefono,ladingCostoServicio:this.isCalculandoDistancia,costosPlaza:this.laPlazaDelivery,cliente:this.infoToken,systemOS:this.systemOS})}getDatosCiudadSeleted(){this.isCalculandoDistancia=!0,this.isFormValid=!1,""===this.lasCiudad||this.lasCiudad!==this.direccionA.ciudad?this.plazaDelivery.loadDatosPlazaByCiudad(this.direccionA.ciudad).subscribe(i=>{this.laPlazaDelivery=i,this.lasCiudad=this.laPlazaDelivery.ciudad,this.laPlazaDelivery.latitude=this.laPlazaDelivery.centro.lat,this.laPlazaDelivery.longitude=this.laPlazaDelivery.centro.lon,this.calcularDistanciaEntregaComp()}):this.calcularDistanciaEntregaComp()}calcularDistanciaEntregaComp(){let i=!1;if(i=!!this.opciones.calDistanciaAB,i=!!this.opciones.calDistanciaCentro||i,i=!!this.opciones.calDistanciaFrom||i,!i)return this.isCalculandoDistancia=!1,this.isFormValid=!0,void this.validFormDos();const e=this.direccionA.ciudad;let t=this.direccionB.ciudad;if(this.opciones.calDistanciaCentro&&(this.direccionB.latitude=this.laPlazaDelivery.latitude,this.direccionB.longitude=this.laPlazaDelivery.longitude,t=this.laPlazaDelivery.ciudad),!e||!t)return this.isCalculandoDistancia=!1,this.isFormValid=!1,void this.validFormDos();if(e.toLocaleLowerCase()!==t.toLocaleLowerCase())return this.direccionA.codigo=null,this.msjErrorDir="Servicio no disponible en esta direcci\xf3n.",this.isCalculandoDistancia=!1,this.isFormValid=!1,void this.validFormDos();const o=this.laPlazaDelivery;o.latitude=this.direccionB.latitude,o.longitude=this.direccionB.longitude,this.isCalculandoDistancia=!0,this.calcDistanceService.calculateRoute(this.direccionA,o,!1),setTimeout(()=>{this.laPlazaDelivery=o,this.isCalculandoDistancia=!1,this.isCalculandoDistancia=!1,this.isFormValid=!0,this.validFormDos()},1600)}}return i.\u0275fac=function(e){return new(e||i)(o.Lb(a.a),o.Lb(c.b),o.Lb(c.b),o.Lb(c.b),o.Lb(c.b),o.Lb(r.a),o.Lb(b.a),o.Lb(g.a),o.Lb(m.a))},i.\u0275cmp=o.Fb({type:i,selectors:[["app-comp-get-datos-cliente"]],inputs:{opciones:"opciones"},outputs:{frmResponse:"frmResponse"},decls:6,vars:5,consts:[["id","div-2 animated fadeIn"],[4,"ngIf"],[1,"fs-16","pb-2"],[1,"d-flex","justify-content-between","align-items-center"],["matRipple","",1,"m-0",3,"matRippleColor","click"],[1,"fs-13"],[3,"ngClass"],[1,"fs-12","text-secondary","fw-600"],["class","text-danger fs-12 fw-100 m-0",4,"ngIf"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"fw-100","fs-10"],[1,"text-danger","fs-12","fw-100","m-0"],["matRipple","",1,"d-flex","justify-content-between","align-items-center",3,"matRippleColor","click"],[1,"m-0"],[1,"fs-14",3,"ngClass"],["aria-hidden","true",1,"fa","fa-caret-down"],[1,"m-0","fs-16"],[1,"btn","btn-sm","btn-secondary"],[1,"fw-100","fs-12","text-danger",3,"hidden"],[1,"text-danger","fs-12","fw-100",3,"hidden"]],template:function(i,e){1&i&&(o.Rb(0,"div",0),o.Ec(1,S,18,9,"div",1),o.Ec(2,R,18,9,"div",1),o.Ec(3,w,14,8,"div",1),o.Ec(4,y,13,3,"div",1),o.Ec(5,P,15,4,"div",1),o.Qb()),2&i&&(o.zb(1),o.lc("ngIf",e.opciones.showDirreccionA),o.zb(1),o.lc("ngIf",e.opciones.showDirreccionB),o.zb(1),o.lc("ngIf",e.opciones.tiempoEntrega),o.zb(1),o.lc("ngIf",e.opciones.metodoPago),o.zb(1),o.lc("ngIf",e.opciones.telefono))},directives:[u.t,f.n,u.q],pipes:[u.F],styles:["p[_ngcontent-%COMP%]{margin:0}.div-content[_ngcontent-%COMP%]{width:100%;max-width:500px;margin:0 auto}.div-enviado[_ngcontent-%COMP%]{text-align:center;height:80vh;width:100%;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.div-listo[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:5px}"]}),i})()},HWNa:function(i,e,t){"use strict";t.d(e,"a",(function(){return c}));var o=t("JOr0"),n=t("Q1FS"),s=t("VhxH"),a=t("fXoL");let c=(()=>{class i{constructor(i){this.estableciminetoService=i,this.directionsService=new google.maps.DirectionsService,this.origin={},this.destination={}}calculateRouteNoApi(i,e,t=!0){let o=0;o=e.c_minimo,e.latitude="string"==typeof e.latitude?parseFloat(e.latitude):e.latitude,e.longitude="string"==typeof e.longitude?parseFloat(e.longitude):e.longitude,i.latitude="string"==typeof i.latitude?parseFloat(i.latitude):i.latitude,i.longitude="string"==typeof i.longitude?parseFloat(i.longitude):i.longitude;let n=0;const a=Object(s.distanceTo)({lat:e.latitude,lon:e.longitude},{lat:i.latitude,lon:i.longitude}),c=a/1e3;return e.distancia_mt=a.toString(),e.distancia_km=c.toFixed(2),n=Math.ceil(c),o=this.calCostoDistancia(e,c),e.c_servicio=o,o}calculateRoute(i,e,t=!0){let o=0;if(o=e.c_minimo,e.latitude="string"==typeof e.latitude?parseFloat(e.latitude):e.latitude,e.longitude="string"==typeof e.longitude?parseFloat(e.longitude):e.longitude,i.latitude="string"==typeof i.latitude?parseFloat(i.latitude):i.latitude,i.longitude="string"==typeof i.longitude?parseFloat(i.longitude):i.longitude,t){const t=this.estableciminetoService.getFindDirClienteCacheEstableciemto(i,e);if(t&&(e.distancia_km=t.distancia_km,e.c_servicio=this.calCostoDistancia(e,t.distancia_km),e.c_servicio<=15))return e.c_servicio}this.origin={lat:i.latitude,lng:i.longitude},this.destination={lat:e.latitude,lng:e.longitude};const n={origin:this.origin,destination:this.destination,travelMode:google.maps.TravelMode.DRIVING};let s=0;return this.directionsService.route(n,(t,n)=>{if("OK"===n){s=t.routes[0].legs[0].distance.value;const n=s/1e3;e.distancia_mt=s.toString(),e.distancia_km=n.toFixed(2),e.isCalcApiGoogle=!0,o=this.calCostoDistancia(e,n),e.c_servicio=o;const a=[];a.push(e),this.estableciminetoService.setEstableciminetosCache({idcliente_pwa_direccion:i.idcliente_pwa_direccion,listEstablecimientos:a})}}),setTimeout(()=>(e.c_servicio=o,o),500),e.c_servicio=o,o}calculateRouteObserver(i,e,t=!0){return new n.Observable(o=>{let n=0;if(n=e.c_minimo,e.latitude="string"==typeof e.latitude?parseFloat(e.latitude):e.latitude,e.longitude="string"==typeof e.longitude?parseFloat(e.longitude):e.longitude,i.latitude="string"==typeof i.latitude?parseFloat(i.latitude):i.latitude,i.longitude="string"==typeof i.longitude?parseFloat(i.longitude):i.longitude,t){const t=this.estableciminetoService.getFindDirClienteCacheEstableciemto(i,e);if(t)return e.distancia_km=t.distancia_km,e.c_servicio=this.calCostoDistancia(e,t.distancia_km),void o.next(e)}this.origin={lat:i.latitude,lng:i.longitude},this.destination={lat:e.latitude,lng:e.longitude};const s={origin:this.origin,destination:this.destination,travelMode:google.maps.TravelMode.DRIVING};let a=0;this.directionsService.route(s,(t,s)=>{if("OK"===s){a=t.routes[0].legs[0].distance.value;const s=a/1e3;e.distancia_mt=a.toString(),e.distancia_km=s.toFixed(2),e.isCalcApiGoogle=!0,n=this.calCostoDistancia(e,s),e.c_servicio=n;const c=[];c.push(e),this.estableciminetoService.setEstableciminetosCache({idcliente_pwa_direccion:i.idcliente_pwa_direccion,listEstablecimientos:c}),o.next(e)}})})}calCostoDistancia(i,e){const t=Math.ceil(e),o=parseFloat(i.c_km.toString());let n=parseFloat(i.c_minimo.toString()),s=0;return s=t>2?2:s,s=t>4?0:s,t>2&&(n=(t-s)*o+n,i.c_servicio=n),n}calcDistancia(i,e){const t={lat:e.latitude,lon:e.longitude};return Object(s.insideCircle)({lat:i.latitude,lon:i.longitude},t,75)}calcCostoEntregaApiGoogleRain(i,e){if(!i)return;const t=this.estableciminetoService.getFindDirClienteCacheEstableciemto(i,e);t&&(t.isCalcApiGoogle?this.calculateRoute(i,e,!1):(t.isCalcApiGoogle=!0,this.calculateRoute(i,t,!1)))}}return i.\u0275fac=function(e){return new(e||i)(a.Vb(o.a))},i.\u0275prov=a.Hb({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()},"Ln/Y":function(i,e,t){"use strict";t.d(e,"a",(function(){return v}));var o=t("0IaG"),n=t("zOUh"),s=t("JOr0"),a=t("fXoL"),c=t("ofXK"),r=t("bTqV"),l=t("FKr1"),d=t("kmnG"),p=t("3Pt+"),h=t("qFsG");const b=function(i){return{"item-option-pago-selected":i}};function g(i,e){if(1&i){const i=a.Sb();a.Rb(0,"div",9),a.Zb("click",(function(){a.xc(i);const t=e.$implicit;return a.dc().selectedItemOptionPago(t)})),a.Mb(1,"img",10),a.Rb(2,"p"),a.Gc(3),a.Qb(),a.Qb()}if(2&i){const i=e.$implicit;a.lc("ngClass",a.qc(4,b,i.checked)),a.zb(1),a.nc("src","../assets/images/icon-app/",i.img,"",a.yc),a.mc("alt",i.img),a.zb(2),a.Hc(i.descripcion)}}function m(i,e){if(1&i&&(a.Rb(0,"div",11),a.Mb(1,"hr"),a.Rb(2,"p",12),a.Mb(3,"i",13),a.Gc(4),a.Qb(),a.Qb()),2&i){const i=a.dc();a.zb(4),a.Ic(" ",i.itemSelected.info,"")}}function u(i,e){if(1&i){const i=a.Sb();a.Pb(0),a.Mb(1,"hr"),a.Rb(2,"span",14),a.Gc(3,"indique con cuanto pagara:"),a.Qb(),a.Rb(4,"mat-form-field",15),a.Rb(5,"input",16,17),a.Zb("ngModelChange",(function(e){return a.xc(i),a.dc().importeIndicado=e}))("keyup",(function(){a.xc(i);const e=a.uc(6);return a.dc().verificarImporte(e.value)})),a.Qb(),a.Qb(),a.Ob()}if(2&i){const i=a.dc();a.zb(5),a.lc("ngModel",i.importeIndicado)}}function f(i,e){1&i&&(a.Pb(0),a.Rb(1,"span",18),a.Gc(2,"El Comercio no acepta pagos con Tarjeta"),a.Qb(),a.Mb(3,"i",19),a.Mb(4,"hr"),a.Ob())}let v=(()=>{class i{constructor(i,e,t,o){this.dialogRef=i,this.infoTokenService=t,this.establecimientoService=o,this.isMontoVisible=!1,this.formValid=!1,this.isFromNoComercio=!1,this.isHabilitadoYape=!0,this.isHabilitadoTarjeta=!0,this.isComercioSolidaridad=!1,this.importeValid=!1,this.isClientePedido=!1,this.importeTotal=parseFloat(e.importeTotalPagar),this.isFromNoComercio=!e.isFromComercio,this.idExluir=e.excluirId}ngOnInit(){this.isHabilitadoYape=!!this.isFromNoComercio||1===this.establecimientoService.get().pwa_delivery_acepta_yape,this.isHabilitadoTarjeta=1===this.establecimientoService.get().pwa_delivery_acepta_tarjeta,this.isComercioSolidaridad=1===this.establecimientoService.get().pwa_delivery_comercio_solidaridad,this.isClientePedido=this.infoTokenService.infoUsToken.isCliente,this.loadMetodoPago(),this.itemSelected=this.infoTokenService.infoUsToken.metodoPago,this.itemSelected.info=this.itemSelected.info?this.itemSelected.info:"",this.verificarMetodoInit()}loadMetodoPago(){this.listMetodoPago=[],this.listMetodoPago.push({idtipo_pago:2,descripcion:"Tarjeta",checked:!0,visible:this.isHabilitadoTarjeta,importe:"",img:"_tp_tarjeta.png",info:""}),this.listMetodoPago.push({idtipo_pago:3,descripcion:"Yape",checked:!1,visible:this.isHabilitadoYape,importe:"",img:"_tp_yape.png",info:"El Yapeo debe realizarle al repartidor al momento de recibir su pedido."}),this.listMetodoPago.push({idtipo_pago:6,descripcion:"Plin",checked:!1,visible:this.isHabilitadoYape,importe:"",img:"_tp_plin.png",info:"El Plineo debe realizarle al repartidor al momento de recibir su pedido."}),this.listMetodoPago.push({idtipo_pago:1,descripcion:"Efectivo",checked:!1,visible:!0,importe:"",img:"_tp_efectivo.png",info:""}),this.listMetodoPago.push({idtipo_pago:4,descripcion:"POS",checked:!1,visible:!this.isClientePedido,importe:"",img:"_tp_pos.png",info:""}),this.listMetodoPago.push({idtipo_pago:5,descripcion:"Trasferencia",checked:!1,visible:!this.isClientePedido,importe:"",img:"_tp_transferencia.png",info:""}),this.validaCociones()}validaCociones(){this.idExluir&&(this.listMetodoPago=this.listMetodoPago.filter(i=>i.idtipo_pago!==this.idExluir).map(i=>i)),this.listMetodoPago=this.listMetodoPago.filter(i=>i.visible).map(i=>i),this.isComercioSolidaridad&&(this.listMetodoPago=this.listMetodoPago.filter(i=>2===i.idtipo_pago).map(i=>i))}verificarMetodoInit(){1===this.itemSelected.idtipo_pago&&(this.isMontoVisible=!0,this.importeIndicado=this.itemSelected.importe.toString(),this.verificarImporte(this.importeIndicado)),this.listMetodoPago.map(i=>{i.checked=i.idtipo_pago===this.itemSelected.idtipo_pago}),this.verificarValidForm()}chageItem(i){this.listMetodoPago.map(i=>i.checked=!1),this.isMontoVisible=!1,this.importeValid=!1,this.importeIndicado="",i.checked=!0,this.itemSelected=i,1===i.idtipo_pago&&(this.isMontoVisible=!0),this.verificarValidForm()}verificarImporte(i){this.importeValid=parseFloat(i)>=this.importeTotal,this.importeIndicado=i,this.itemSelected.importe=this.importeIndicado,this.verificarValidForm()}verificarValidForm(){this.formValid=1!==this.itemSelected.idtipo_pago||this.importeValid}cerrarDlg(){this.infoTokenService.setMetodoPago(this.itemSelected),this.dialogRef.close(this.itemSelected)}selectedItemOptionPago(i){this.listMetodoPago.map(i=>i.checked=!1),this.isMontoVisible=!1,this.importeValid=!1,this.importeIndicado="",i.checked=!0,this.itemSelected=i,1===i.idtipo_pago&&(this.isMontoVisible=!0),this.verificarValidForm()}}return i.\u0275fac=function(e){return new(e||i)(a.Lb(o.i),a.Lb(o.a),a.Lb(n.a),a.Lb(s.a))},i.\u0275cmp=a.Fb({type:i,selectors:[["app-dialog-metodo-pago"]],decls:15,vars:5,consts:[[1,"p-2"],[1,"fs-18","fw-","m-0"],[1,"fs-11","text-info"],[1,"div-list-icon"],["matRipple","","class","item-option-pago",3,"ngClass","click",4,"ngFor","ngForOf"],["class","animated flash",4,"ngIf"],[4,"ngIf"],[1,"text-center"],["mat-flat-button","","color","primary",3,"disabled","click"],["matRipple","",1,"item-option-pago",3,"ngClass","click"],[3,"src","alt"],[1,"animated","flash"],[1,"fs-12","fw-600"],[1,"fa","fa-info","pr-1","text-warning"],[1,"text-danger","fs-12","fw-100"],[1,"w-100"],["type","number","matInput","","placeholder","Paga con","required","",3,"ngModel","ngModelChange","keyup"],["importe",""],[1,"text-info","fs-11"],["aria-hidden","true",1,"fa","fa-credit-card-alt","pl-1"]],template:function(i,e){1&i&&(a.Rb(0,"div",0),a.Rb(1,"p",1),a.Gc(2,"Metodo de pago"),a.Qb(),a.Rb(3,"p",2),a.Gc(4,"Por favor, en cuanto sea posible seleccione un metodo de pago sin contacto (Tarjeta o Yape)."),a.Qb(),a.Mb(5,"hr"),a.Rb(6,"div",3),a.Ec(7,g,4,6,"div",4),a.Qb(),a.Ec(8,m,5,1,"div",5),a.Ec(9,u,7,1,"ng-container",6),a.Mb(10,"hr"),a.Ec(11,f,5,0,"ng-container",6),a.Rb(12,"div",7),a.Rb(13,"button",8),a.Zb("click",(function(){return e.cerrarDlg()})),a.Gc(14,"Listo"),a.Qb(),a.Qb(),a.Qb()),2&i&&(a.zb(7),a.lc("ngForOf",e.listMetodoPago),a.zb(1),a.lc("ngIf",""!=e.itemSelected.info),a.zb(1),a.lc("ngIf",e.isMontoVisible),a.zb(2),a.lc("ngIf",!e.isHabilitadoTarjeta),a.zb(2),a.lc("disabled",!e.formValid))},directives:[c.s,c.t,r.b,l.n,c.q,d.c,p.v,h.a,p.c,p.A,p.p,p.s],styles:["p[_ngcontent-%COMP%]{margin:0}.div-list-icon[_ngcontent-%COMP%]{display:grid;width:100%;margin:0 auto;grid-gap:10px;grid-template-columns:repeat(auto-fill,65px)}.div-list-icon[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.item-option-pago[_ngcontent-%COMP%]{text-align:center;padding:10px;border:1px solid #9e9e9e;border-radius:5px;font-size:12px;background-color:#fff;margin-left:5px;-webkit-transition:all .3s;transition:all .3s;font-weight:600}.item-option-pago-selected[_ngcontent-%COMP%]{background-color:#708090;color:#fff}"]}),i})()},N6vS:function(i,e,t){"use strict";t.d(e,"a",(function(){return p}));var o=t("0IaG"),n=t("eI2u"),s=t("fXoL"),a=t("lkOP"),c=t("bTqV"),r=t("ofXK"),l=t("Pg/a");function d(i,e){if(1&i){const i=s.Sb();s.Rb(0,"app-agregar-direccion",9),s.Zb("saveDireccionOk",(function(e){return s.xc(i),s.dc().setDireccion(e)})),s.Qb()}if(2&i){const i=s.dc();s.lc("isGuardarDireccion",i.isGuardarDireccion)("idClienteBuscar",i._idClienteBuscar)}}let p=(()=>{class i{constructor(i,e,t){this.dialogRef=i,this.listenService=e,this.isShowAddDireccion=!1,this.isGuardarDireccion=!0,this.isGuardarDireccion=!t||t.isGuardar,this._idClienteBuscar=t?t.idClienteBuscar:null}ngOnInit(){}setDireccion(i){this.direccionSelected=i,this.listenService.setChangeDireccionDelivery(this.direccionSelected),this.cerrarDlg()}showAddDireccion(){this.isShowAddDireccion=!0}cerrarDlg(){this.dialogRef.close(this.direccionSelected)}}return i.\u0275fac=function(e){return new(e||i)(s.Lb(o.i),s.Lb(n.a),s.Lb(o.a))},i.\u0275cmp=s.Fb({type:i,selectors:[["app-dialog-select-direccion"]],decls:16,vars:4,consts:[[3,"hidden"],[1,"fs-14","fw-600","pl-3","pt-3"],[3,"idClienteBuscar","direccionSelected"],[1,"text-center"],["mat-flat-button","","mat-dialog-close","",1,"mr-3"],[1,"fa","fa-arrow-left"],["mat-flat-button","","color","primary",3,"click"],[1,"fa","fa-plus"],[3,"isGuardarDireccion","idClienteBuscar","saveDireccionOk",4,"ngIf"],[3,"isGuardarDireccion","idClienteBuscar","saveDireccionOk"]],template:function(i,e){1&i&&(s.Rb(0,"div",0),s.Rb(1,"p",1),s.Gc(2,"Direccion de entrega:"),s.Qb(),s.Mb(3,"hr"),s.Rb(4,"app-seleccionar-direccion",2),s.Zb("direccionSelected",(function(i){return e.setDireccion(i)})),s.Qb(),s.Mb(5,"br"),s.Rb(6,"div",3),s.Rb(7,"button",4),s.Mb(8,"i",5),s.Gc(9," Atras "),s.Qb(),s.Rb(10,"button",6),s.Zb("click",(function(){return e.showAddDireccion()})),s.Mb(11,"i",7),s.Gc(12," Agregar Direccion "),s.Qb(),s.Qb(),s.Mb(13,"br"),s.Qb(),s.Rb(14,"div",0),s.Ec(15,d,1,2,"app-agregar-direccion",8),s.Qb()),2&i&&(s.lc("hidden",e.isShowAddDireccion),s.zb(4),s.lc("idClienteBuscar",e._idClienteBuscar),s.zb(10),s.lc("hidden",!e.isShowAddDireccion),s.zb(1),s.lc("ngIf",e.isShowAddDireccion))},directives:[a.a,c.b,o.d,r.t,l.a],styles:[""]}),i})()},qmRn:function(i,e,t){"use strict";t.d(e,"a",(function(){return o}));class o{}}}]);